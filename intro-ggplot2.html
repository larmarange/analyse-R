<!DOCTYPE html>

<html lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Introduction à ggplot2, la grammaire des graphiques</title>

<script src="libs/header-attrs-2.16/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnees.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <li><a href="scraping.html">Scraping</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe avec <strong>survey</strong></a></li>
                  <li><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="gtsummary.html">Tableaux statistiques avancés avec <strong>gtsummary</strong></a></li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="modeles.html">Quel type de modèles choisir ?</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Modèles à effets aléatoires (modèles mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de données longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
                  <li><a href="analyse-textuelle.html">Analyse textuelle</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">Étendre <strong>ggplot2</strong></a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="exemples-graphiques-avances.html">Exemples de graphiques avancés</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
                  <li><a href="autres-extensions-graphiques.html">Autres extensions graphiques</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation (dont <strong>purrr</strong>)</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres avec <strong>scales</strong></a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations mathématiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <li><a href="https://larmarange.github.io/guide-R/">guide-R</a></li>
        <li><a href="https://larmarange.github.io/webin-R/">webin-R</a></li>
        <li><a href="https://www.youtube.com/c/webinR"><i class="fa fa-youtube" aria-hidden="true"></i></a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div id="header">



<h1 class="title toc-ignore">Introduction à ggplot2, la grammaire des graphiques</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#les-données-de-lexemple" id="toc-les-données-de-lexemple">Les données de l’exemple<span></span></a>
<ul>
<li><a href="#nettoyage-des-données" id="toc-nettoyage-des-données">Nettoyage des données<span></span></a></li>
<li><a href="#recodage-dune-variable" id="toc-recodage-dune-variable">Recodage d’une variable<span></span></a></li>
</ul></li>
<li><a href="#visualisation-des-données" id="toc-visualisation-des-données">Visualisation des données<span></span></a>
<ul>
<li><a href="#visualisation-par-petits-multiples" id="toc-visualisation-par-petits-multiples">Visualisation par <q>petits multiples</q><span></span></a></li>
<li><a href="#visualisation-en-séries-temporelles" id="toc-visualisation-en-séries-temporelles">Visualisation en séries temporelles<span></span></a></li>
<li><a href="#combinaisons-déléments-graphiques" id="toc-combinaisons-déléments-graphiques">Combinaisons d’éléments graphiques<span></span></a></li>
</ul></li>
<li><a href="#composition-graphique-avec-ggplot2" id="toc-composition-graphique-avec-ggplot2">Composition graphique avec ggplot2<span></span></a>
<ul>
<li><a href="#couleurs-et-échelles" id="toc-couleurs-et-échelles">Couleurs et échelles<span></span></a></li>
<li><a href="#utilisation-des-thèmes" id="toc-utilisation-des-thèmes">Utilisation des thèmes<span></span></a></li>
<li><a href="#export-des-graphiques" id="toc-export-des-graphiques">Export des graphiques<span></span></a></li>
</ul></li>
<li><a href="#pour-aller-plus-loin" id="toc-pour-aller-plus-loin">Pour aller plus loin<span></span></a>
<ul>
<li><a href="#ressources-essentielles" id="toc-ressources-essentielles">Ressources essentielles<span></span></a></li>
<li><a href="#extensions-de-ggplot2" id="toc-extensions-de-ggplot2">Extensions de ggplot2<span></span></a></li>
</ul></li>
</ul>
</div>

<div class="note">
<p>Ce chapitre est tiré d’une <a href="https://github.com/briatte/aad/tree/master/reinhart-rogoff">séance de cours</a> de François Briatte et destinée à des étudiants de L2 sans aucune connaissance de <strong>R</strong>. Cette séance de cours est elle-même inspirée d’un <a href="http://www.stat.cmu.edu/~cshalizi/uADA/13/hw/11/">exercice</a> tiré d’un cours de <a href="http://www.stat.cmu.edu/~cshalizi/">Cosma Shalizi</a>.</p>
</div>
<div class="webin-R">
<p>Ce chapitre est évoqué dans le webin-R #08 (ggplot2 et la grammaires des graphiques) sur <a href="https://youtu.be/msnwENny_cg">YouTube</a>.</p>
</div>
<p><strong>R</strong> possède un puissant moteur graphique interne, qui permet de <q>dessiner</q> dans un graphique en y rajoutant des segments, des points, du texte, ou toutes sortes d’autres symboles. Toutefois, pour produire un graphique complet avec les fonctions basiques de <strong>R</strong>, il faut un peu bricoler : d’abord, ouvrir une fenêtre ; puis rajouter des points ; puis rajouter des lignes ; tout en configurant les couleurs au fur-et-à-mesure ; puis finir par fermer la fenêtre graphique.</p>
<p>L’extension <code class="pkg">ggplot2</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, développée par Hadley Wickham et mettant en œuvre la <q>grammaire graphique</q> <a href="https://books.google.fr/books/about/The_Grammar_of_Graphics.html">théorisée par Leland Wilkinson</a>, devient vite indispensable lorsque l’on souhaite réaliser des graphiques plus complexes<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. On renvoit le lecteur intéressé à l’ouvrage de Winston Chang, <em>R Graphics Cookbook</em>, disponible gratuitement dans sa deuxième édition à l’adresse suivante : <a href="https://r-graphics.org" class="uri">https://r-graphics.org</a>.</p>
<p>Ce chapitre, articulé autour d’une étude de cas, présente <code class="pkg">ggplot2</code> à partir d’un exemple simple de visualisation de séries temporelles, puis rentre dans le détail de sa syntaxe. Pour une présentation plus formelle, on pourra se référer au <a href="ggplot2-la-grammaire-des-graphiques.html">chapitre dédié</a> de la section <em>Approfondir</em>.</p>
<div id="les-données-de-lexemple" class="section level2 hasAnchor">
<h2 class="hasAnchor">Les données de l’exemple<a href="#les-données-de-lexemple" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il y a quelques années, les chercheurs Carmen M. Reinhart et Kenneth S. Rogoff publiaient un article intitulé <cite><a href="http://scholar.harvard.edu/files/rogoff/files/growth_in_time_debt_aer.pdf">Growth in a Time of Debt</a></cite>, dans lequel ils faisaient la démonstration qu’un niveau élevé de dette publique nuisait à la croissance économique. Plus exactement, les deux chercheurs y défendaient l’idée que, lorsque la dette publique dépasse 90 % du produit intérieur brut, ce produit cesse de croître.</p>
<p>Cette conclusion, proche du discours porté par des institutions comme le Fonds Monétaire International, a <a href="http://www.economist.com/news/finance-and-economics/21576362-seminal-analysis-relationship-between-debt-and-growth-comes-under">alimenté plusieurs argumentaires politiques</a>. Des parlementaires américains s’en ainsi sont servi pour exiger une diminution du budget fédéral, et surtout, la Commission européenne s’est appuyée sur cet argumentaire pour exiger que des pays comme la Grèce, durement frappés par la crise financière globale de 2008, adoptent des plans d’austérité drastiques.</p>
<p>Or, en tentant de reproduire les résultats de Reinhart et Rogoff, les chercheurs Thomas Herndon, Michael Ash et Robert Pollin y ont trouvé <a href="http://www.peri.umass.edu/236/hash/31e2ff374b6377b2ddec04deaa6388b1/publication/566/">de nombreuses erreurs</a>, ainsi qu’une <a href="http://www.nextnewdeal.net/rortybomb/researchers-finally-replicated-reinhart-rogoff-and-there-are-serious-problems">bête erreur de calcul</a> due à une utilisation peu attentive du logiciel <strong>Microsoft Excel</strong>. La révélation de ces erreurs donna lieu à un débat très vif entre adversaires et partisans des politiques économiques d’austérité, débat toujours autant d’actualité aujourd’hui.</p>
<p>Dans ce chapitre, on va se servir des données (corrigées) de Reinhart et Rogoff pour évaluer, de manière indépendante, la cohérence de leur argument sur le rapport entre endettement et croissance économique. Commençons par récupérer ces données au format CSV sur le site du chercheur américain <a href="http://www.stat.cmu.edu/~cshalizi/">Cosma Shalizi</a>, qui utilise ces données dans <a href="http://www.stat.cmu.edu/~cshalizi/uADA/">l’un de ses exercices de cours</a> :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># charger l&#39;extension lisant le format CSV</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># emplacement souhaité pour le jeu de données</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;data/debt.csv&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># télécharger le jeu de données s&#39;il n&#39;existe pas</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(file))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(<span class="st">&quot;http://www.stat.cmu.edu/~cshalizi/uADA/13/hw/11/debt.csv&quot;</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                file, <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># charger les données dans l&#39;objet &#39;debt&#39;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>debt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file)</span></code></pre></div>
<pre><code>New names:
* `` -&gt; ...1</code></pre>
<pre><code>Rows: 1171 Columns: 5
-- Column specification ------------------------------------
Delimiter: &quot;,&quot;
chr (1): Country
dbl (4): ...1, Year, growth, ratio

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="note">
<p>Le code ci-dessus utilise la fonction <code data-pkg="readr" data-rdoc="read_csv">read_csv</code> de l’extension <code class="pkg">readr</code>, dont on a recommandé l’utilisation dans un <a href="import-de-donnees.html">précédent chapitre</a>. En l’absence de cette extension, on aurait pu utiliser la fonction de base <code data-pkg="utils" data-rdoc="read.csv">read.csv</code>.</p>
</div>
<div id="nettoyage-des-données" class="section level3 hasAnchor">
<h3 class="hasAnchor">Nettoyage des données<a href="#nettoyage-des-données" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les données de Reinhart et Rogoff contiennent, pour un échantillon de 20 pays occidentaux membres de la zone <a href="https://fr.wikipedia.org/wiki/Organisation_de_coop%C3%A9ration_et_de_d%C3%A9veloppement_%C3%A9conomiques">OCDE</a>, la croissance de leur <a href="https://fr.wikipedia.org/wiki/Produit_intérieur_brut">produit intérieur brut</a> (PIB)<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, et le ratio entre leur <a href="https://fr.wikipedia.org/wiki/Dette_publique">dette publique</a> et ce produit, exprimé sous la forme d’un pourcentage <q>Dette / PIB</q>. Les données vont du milieu des années 1940 à la fin des années 2000. La première colonne du jeu de données ne contenant que les numéros des lignes, on va la supprimer d’entrée de jeu :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspection du jeu de données</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(debt)</span></code></pre></div>
<pre><code>spec_tbl_df [1,171 x 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ ...1   : num [1:1171] 147 148 149 150 151 152 153 154 155 156 ...
 $ Country: chr [1:1171] &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; ...
 $ Year   : num [1:1171] 1946 1947 1948 1949 1950 ...
 $ growth : num [1:1171] -3.56 2.46 6.44 6.61 6.92 ...
 $ ratio  : num [1:1171] 190 177 149 126 110 ...
 - attr(*, &quot;spec&quot;)=
  .. cols(
  ..   ...1 = col_double(),
  ..   Country = col_character(),
  ..   Year = col_double(),
  ..   growth = col_double(),
  ..   ratio = col_double()
  .. )
 - attr(*, &quot;problems&quot;)=&lt;externalptr&gt; </code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># suppression de la première colonne</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>debt <span class="ot">&lt;-</span> debt[, <span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Il faut aussi noter d’emblée que certaines mesures sont manquantes : pour certains pays, on ne dispose pas d’une mesure fiable du PIB et/ou de la dette publique. En conséquence, le nombre d’observations par pays est différent, et va de 40 observations <q>pays-année</q> pour la Grèce à 64 observations <q>pays-année</q> pour plusieurs pays comme l’Australie ou les États-Unis :</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(debt<span class="sc">$</span>Country)</span></code></pre></div>
<pre><code>
  Australia     Austria     Belgium      Canada     Denmark 
         64          59          63          64          56 
    Finland      France     Germany      Greece     Ireland 
         64          54          59          40          63 
      Italy       Japan Netherlands New Zealand      Norway 
         59          54          53          64          64 
   Portugal       Spain      Sweden          UK          US 
         58          42          64          63          64 </code></pre>
</div>
<div id="recodage-dune-variable" class="section level3 hasAnchor">
<h3 class="hasAnchor">Recodage d’une variable<a href="#recodage-dune-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dernière manipulation préalable avant l’analyse : on va calculer la décennie de chaque observation, en divisant l’année de mesure par 10, et en multipliant la partie entière de ce résultat par 10. Cette manipulation très simple donne <q>1940</q> pour les mesures des années 1940 à 1949, <q>1950</q> pour les années 1950-1959, et ainsi de suite.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>debt<span class="sc">$</span>Decade <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">10</span> <span class="sc">*</span> debt<span class="sc">$</span>Year <span class="sc">%/%</span> <span class="dv">10</span>)</span></code></pre></div>
<p>Voici, pour terminer, les premières lignes du jeu de données sur lequel on travaille :</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(debt)</span></code></pre></div>
<pre><code># A tibble: 6 x 5
  Country    Year growth ratio Decade
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; 
1 Australia  1946  -3.56 190.  1940  
2 Australia  1947   2.46 177.  1940  
3 Australia  1948   6.44 149.  1940  
4 Australia  1949   6.61 126.  1940  
5 Australia  1950   6.92 110.  1950  
6 Australia  1951   4.27  87.1 1950  </code></pre>
</div>
</div>
<div id="visualisation-des-données" class="section level2 hasAnchor">
<h2 class="hasAnchor">Visualisation des données<a href="#visualisation-des-données" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chargeons à présent l’extension graphique <code class="pkg">ggplot2</code> :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Procédons désormais à quelques visualisations très simples de ces données. On dispose de trois variables continues : l’année, le taux de croissance du PIB, et le ratio <q>Dette publique / PIB</q>. Si l’on souhaite visualiser la croissance du PIB au cours du temps, la solution basique dans <strong>R</strong> s’écrit de la manière suivante :</p>
<figure>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(debt, <span class="fu">plot</span>(Year, growth))</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-7-1.png" width="1050" />
</figure>
<p>Le code de la visualisation est très simple et se lit : <q>avec l’objet <code>debt</code>, construire le graphique montrant l’année d’observation <var>Year</var> en abcisse et le taux de croissance du PIB <var>growth</var> en ordonnée</q>. Le code est compris de cette manière par <strong>R</strong> car la fonction <code data-pkg="graphics">plot</code> comprend le premier argument comme étant la variable à représenter sur l’axe horizontal <code>x</code>, et le second comme la variable à représenter sur l’axe vertical <code>y</code>.</p>
<p>Le même graphique s’écrit de la manière suivante avec l’extension <code class="pkg">ggplot2</code> :</p>
<figure>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(debt, <span class="fu">qplot</span>(Year, growth))</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-8-1.png" width="1050" />
</figure>
<p>Comme on peut le voir, le code est très proche du code utilisé dans <q><strong>R</strong> base</q>, la syntaxe signifiant toujours : <q>avec le jeu de données <code>debt</code>, visualiser les variables <var>Year</var> sur l’axe <code>x</code> et <var>growth</var> sur l’axe <code>y</code></q>. Le résultat est similaire, bien que plusieurs paramètres graphiques aient changé : le fond gris clair, en particulier, est caractéristique du thème graphique par défaut de <code class="pkg">ggplot2</code>, que l’on apprendra à modifier plus loin.</p>
<p>Par ailleurs, dans les deux exemples précédents, on a écrit <code>with(debt, ...)</code> pour indiquer que l’on travaillait avec l’objet <code>debt</code>. Lorsque l’on travaille avec l’extension <code class="pkg">ggplot2</code>, il est toutefois plus commun d’utiliser l’argument <code>data</code> dans l’appel de <code data-pkg="ggplot2">qplot</code> pour indiquer ce choix :</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(Year, growth, <span class="at">data =</span> debt)</span></code></pre></div>
<div id="visualisation-par-petits-multiples" class="section level3 hasAnchor">
<h3 class="hasAnchor">Visualisation par <q>petits multiples</q><a href="#visualisation-par-petits-multiples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cherchons désormais à mieux comprendre les variations du taux de croissance du PIB au fil des années.</p>
<p>Dans les graphiques précédents, on voit clairement que ce taux est très variable dans l’immédiat après-guerre, puis qu’il oscille entre environ -5 % et +15 %, puis qu’il semble chuter dramatiquement à la fin des années 2000, marquées par la crise financière globale. Mais comment visualiser ces variations pour chacun des vingt pays de l’échantillon ?</p>
<p>On va ici utiliser le principe de la visualisation par <q><a href="http://www.juiceanalytics.com/writing/better-know-visualization-small-multiples/">petits multiples</a></q>, c’est-à-dire que l’on va reproduire le même graphique pour chacun des pays, et visualiser l’ensemble de ces graphiques dans une même fenêtre. Concrètement, il va donc s’agir de montrer la croissance annuelle du PIB en faisant apparaître chaque pays dans une facette différente du graphique.</p>
<p><code class="pkg">ggplot2</code> permet d’effectuer cette opération en rajoutant au graphique précédent, au moyen de l’opérateur <code>+</code>, l’élément <code>facet_wrap(~ Country)</code> au graphique et qui signifie <q>construire le graphique pour chaque valeur différente de la variable <var>Country</var></q>. On notera que la fonction <code data-pkg="ggplot2">facet_wrap</code> utilise la syntaxe <a href="formules.html">équation</a> de <strong>R</strong>. Par défaut, ces <q>facettes</q> sont classées par ordre alphabétique :</p>
<figure>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(Year, growth, <span class="at">data =</span> debt) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Country)</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-10-1.png" width="1050" />
</figure>
<p>Voilà qui est beaucoup plus clair ! On aperçoit bien, dans ce graphique, les variations très importantes de croissance du PIB dans un pays comme l’Autriche, ruinée après la Seconde guerre mondiale, ou l’Irlande, très durement frappée par la crise financière globale en 2008 et 2009. On aperçoit aussi où se trouvent les données manquantes : voir le graphique de l’Espagne, par exemple.</p>
<p>Il faut noter ici un élément essentiel de la grammaire graphique de <code class="pkg">ggplot2</code>, qui utilise une syntaxe additive, où différents éléments et paramètres graphiques peuvent être combinés en les additionnant, ce qui permet de construire et de modifier des graphiques de manière cumulative, pas à pas. Cette caractéristique permet de tâtonner, et de construire progressivement des graphiques très complets.</p>
</div>
<div id="visualisation-en-séries-temporelles" class="section level3 hasAnchor">
<h3 class="hasAnchor">Visualisation en séries temporelles<a href="#visualisation-en-séries-temporelles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Enfin, pour produire le même graphique que ci-dessus en utilisant des lignes plutôt que des points, il suffit d’utiliser l’argument <code>geom = "line"</code>, ce qui peut être considéré comme une meilleure manière de visualiser des séries temporelles, mais qui tend aussi à rendre plus difficile la détection des périodes pour lesquelles il manque des données (voir, à nouveau, le graphique pour l’Espagne) :</p>
<figure>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">data =</span> debt, <span class="at">y =</span> growth, <span class="at">x =</span> Year, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Country)</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-11-1.png" width="1050" />
</figure>
<p>Dans ce dernier exemple, on a défini l’axe <code>y</code> avant de définir l’axe <code>x</code>, en écrivant ces arguments de manière explicite ; de même, on a commencé par spécifier l’argument <code>data</code>, et l’on a terminé par l’argument <code>geom</code>. Cet ordre d’écriture permet de conserver une forme de cohérence dans l’écriture des fonctions graphiques.</p>
</div>
<div id="combinaisons-déléments-graphiques" class="section level3 hasAnchor">
<h3 class="hasAnchor">Combinaisons d’éléments graphiques<a href="#combinaisons-déléments-graphiques" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On n’a pas encore visualisé le ratio <q>Dette publique / PIB</q>, l’autre variable du raisonnement de Reinhart et Rogoff. C’est l’occasion de voir comment rajouter des titres aux axes des graphiques, et d’utiliser les lignes en même temps que des points, toujours grâce à l’argument <code>geom</code>, qui peut prendre plusieurs valeurs (ici, <code>"point"</code> produit les points et <code>"line"</code> produit les lignes) :</p>
<figure>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">data =</span> debt, <span class="at">y =</span> ratio, <span class="at">x =</span> Year, <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;point&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Country) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Ratio dette publique / produit intérieur brut (%)&quot;</span>)</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-12-1.png" width="1050" />
</figure>
<p>Dans ce graphique, on a combiné deux <q>objets géométriques</q> (<code>geom</code>) pour afficher à la fois des points et des lignes. On a ensuite défini les titres des axes, en supprimant celui de l’axe <code>x</code>, et en rajoutant un peu d’espace entre le titre de l’axe <code>y</code> et l’axe lui-même grâce à la chaîne de caractères finale <code>\n</code>, qui rajoute une ligne vide entre ces deux éléments<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.</p>
<p>Les différents exemples vus dans cette section montrent qu’il va falloir apprendre un minimum de syntaxe graphique pour parvenir à produire des graphiques avec <code class="pkg">ggplot2</code>. Ce petit investissement permet de savoir très vite produire de très nombreux types de graphiques, assez élégants de surcroît, et très facilement modifiables à l’aide de toutes sortes de paramètres optionnels.</p>
<div class="important">
<p>Aussi élégants que soient vos graphiques, il ne vous dispense évidemment pas de réfléchir à ce que vous êtes en train de visualiser, un graphique très élégant pouvant naturellement être complètement erroné, en particulier si les données de base du graphique ont été mal mesurées… ou endommagées.</p>
</div>
</div>
</div>
<div id="composition-graphique-avec-ggplot2" class="section level2 hasAnchor">
<h2 class="hasAnchor">Composition graphique avec ggplot2<a href="#composition-graphique-avec-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La section précédente a montré comment utiliser la fonction <code data-pkg="ggplot2">qplot</code> (<em>quick plot</em>). La syntaxe complète de l’extension <code class="pkg">ggplot2</code> passe par une autre fonction, <code data-pkg="ggplot2">ggplot</code>, qui permet de mieux comprendre les différents éléments de sa grammaire graphique. Dans cette section, on va détailler cette syntaxe pour en tirer un graphique plus complexe que les précédents.</p>
<p>Commençons par créer un <q>treillis de base</q> au graphique :</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> debt, <span class="fu">aes</span>(<span class="at">y =</span> growth, <span class="at">x =</span> ratio))</span></code></pre></div>
<p>Aucun graphique ne s’affiche ici : en effet, ce que l’on a stocké, dans l’objet <code>p</code>, n’est pas un graphique complet, mais une base de travail. Cette base définit les coordonnées <code>x</code> et <code>y</code> du graphique dans l’argument <code data-pkg="ggplot2">aes</code> (<em>aesthetics</em>). Ici, on a choisi de mettre la variable dépendante de Reinhart et Rogoff, <var>growth</var> (le taux de croissance du PIB), sur l’axe <code>y</code>, et la variable indépendante <var>ratio</var> (le ratio <q>Dette publique / PIB</q>) sur l’axe <code>x</code>.</p>
<p>Rajoutons désormais un objet géométrique, <code data-pkg="ggplot2">geom_point</code>, qui va projeter, sur le graphique, des points aux coordonnées précédemment définies, et divisons le graphique par un <q>petit multiple</q>, en projetant les points de chaque décennie dans une facette différente du graphique. Ce graphique propose une décomposition temporelle de la relation étudiée par Reinhart et Rogoff :</p>
<figure>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Decade)</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-14-1.png" width="1050" />
</figure>
<div class="note">
<p>Le paramètre <code data-pkg="ggplot2">facet_grid</code>, qui utilise aussi la syntaxe <q><a href="formules.html">équation</a></q>, permet de créer des facettes plus compliquées que celles créées par le paramètre <code data-pkg="ggplot2">facet_wrap</code>, même si, dans nos exemples, on aurait pu utiliser aussi bien l’un que l’autre.</p>
</div>
<p>Le graphique ci-dessus présente un problème fréquent : l’axe horizontal du graphique, très important puisque Reinhart et Rogoff évoquent un seuil <q>fatidique</q>, pour la croissance, de 90% du PIB, est illisible. Grâce à l’argument <code data-pkg="ggplot2" data-rdoc="continuous_scale">scale_x_continuous</code>, on va pouvoir clarifier cet axe en n’y faisant figurer que certaines valeurs :</p>
<figure>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Decade) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">100</span>))</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-15-1.png" width="1050" />
</figure>
<p>Ces réglages nous conviennent : on va donc les sauvegarder dans l’objet <code>p</code>, de manière à continuer de construire notre graphique en incluant ces différents éléments.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Decade) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">100</span>))</span></code></pre></div>
<div id="couleurs-et-échelles" class="section level3 hasAnchor">
<h3 class="hasAnchor">Couleurs et échelles<a href="#couleurs-et-échelles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Abordons désormais un élément-clé de <code class="pkg">ggplot2</code> : la manipulation des paramètres esthétiques. Précédemment, on n’a montré que deux de ces paramètres : <code>x</code> et <code>y</code>, les coordonnées du graphique. Mais ces paramètres peuvent aussi influencer la couleur des points de notre graphique comme le montre l’exemple suivant :</p>
<figure>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> ratio <span class="sc">&lt;</span> <span class="dv">90</span>)</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-17-1.png" width="1050" />
</figure>
<p>Qu’a-t-on fait ici ? On a rajouté, au graphique stocké dans <code>p</code>, un paramètre esthétique qui détermine la couleur de ses points en fonction d’une inégalité, <code>ratio &lt; 90</code>, qui est vraie quand le ratio <q>Dette publique / PIB</q> est inférieur au seuil <q>fatidique</q> de Reinhart et Rogoff, et fausse quand ce ratio dépasse ce seuil. Les couleurs des points correspondent aux couleurs par défaut de <code class="pkg">ggplot2</code>, que l’on peut très facilement modifier avec <code data-pkg="ggplot2">scale_colour_brewer</code> :</p>
<figure>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> ratio <span class="sc">&lt;</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-18-1.png" width="1050" />
</figure>
<p>Ici, on a fait appel à la palette de couleur <code>Set1</code> de l’éventail de couleurs <a href="http://colorbrewer2.org/">ColorBrewer</a>, qui est automatiquement disponible dans <code class="pkg">ggplot2</code>, et qui est contenu dans l’extension <code class="pkg">RColorBrewer</code>. La palette de couleurs que l’on a choisie affiche les points situés au-dessus du seuil <q>fatidique</q> de Reinhart et Rogoff en rouge, les autres en bleu.</p>
<p>Que peut-on dire, à ce stade, du seuil <q>fatidique</q> de Reinhart et Rogoff ? On peut observer qu’après la Seconde guerre mondiale, de nombreux pays sont <em>déjà</em> endettés au-delà de ce seuil, et dégagent <em>déjà</em> moins de croissance que les autres. Sur la base de cette trajectoire, de nombreux critiques de Reinhart et Rogoff ont fait remarquer que le raisonnement de Reinhart et Rogoff pose en réalité un sérieux problème d’<a href="http://www.nextnewdeal.net/rortybomb/guest-post-reinhartrogoff-and-growth-time-debt">inversion du rapport causal</a> entre endettement et croissance au cours du temps.</p>
<p>Envisageons une nouvelle modification des paramètres graphiques. La légende du graphique, qui affiche <code>FALSE</code> et <code>TRUE</code> en fonction de l’inégalité <code>ratio &lt; 90</code>, peut être déroutante. Clarifions un peu cette légende en supprimant son titre et en remplaçant les libellés (<em>labels</em>) <code>FALSE</code> et <code>TRUE</code> par leur signification :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> ratio <span class="sc">&lt;</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="st">&quot;&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;ratio &gt; 90&quot;</span>, <span class="st">&quot;ratio &lt; 90&quot;</span>))</span></code></pre></div>
<p>Dans le bloc de code ci-dessus, on a stocké l’ensemble de nos modifications dans l’objet <code>p</code>, sans l’afficher ; en effet, on souhaite encore procéder à une dernière modification, en rajoutant une <a href="https://fr.wikipedia.org/wiki/Régression_locale">régression locale</a> à travers les points de chaque facette<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. Après consultation de la documentation de <code class="pkg">ggplot2</code> <a href="http://docs.ggplot2.org/current/geom_smooth.html">ici</a> et <a href="http://docs.ggplot2.org/current/stat_smooth.html">là</a>, on en arrive au code ci-dessous, où <code>p</code> produit le graphique précédent et <code data-pkg="ggplot2" data-rdoc="geom_smooth">geom_smooth</code> produit la régression locale :</p>
<figure>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<img src="graphs/intro-ggplot2/unnamed-chunk-20-1.png" width="1050" />
</figure>
<p>Le graphique permet d’évaluer de manière encore un peu plus précise l’argument de Reinhart et Rogoff, et en particulier la nature pas si <q>fatidique</q> du seuil de 90% du ratio “Dette publique / PIB”, qui sans être une bonne nouvelle pour l’économie, ne détermine pas <q>fatidiquement</q> la direction du taux de croissance : si c’était le cas, toutes les courbes du graphique ressembleraient à celles des années 2000. Autrement dit, l’argumentaire de Reinhart et Rogoff laisse clairement à désirer.</p>
</div>
<div id="utilisation-des-thèmes" class="section level3 hasAnchor">
<h3 class="hasAnchor">Utilisation des thèmes<a href="#utilisation-des-thèmes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Reprenons notre graphique de départ. On va, pour terminer cette démonstration, en construire une version imprimable en noir et blanc, ce qui signifie qu’au lieu d’utiliser des couleurs pour distinguer les points en-deçà et au-delà du seuil <q>fatidique</q> de Reinhart et Rogoff, on va utiliser une ligne verticale, produite par <code data-pkg="ggplot2" data-rdoc="geom_vline">geom_vline</code> et affichée en pointillés par le paramètre <code>lty</code> (<em>linetype</em>) :</p>
<figure>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> debt, <span class="fu">aes</span>(<span class="at">y =</span> growth, <span class="at">x =</span> ratio)) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">90</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Decade) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Taux de croissance du produit intérieur brut</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Ratio dette publique / produit intérieur brut (%)&quot;</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Données Reinhart et Rogoff corrigées, 1946-2009</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>)),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<img src="graphs/intro-ggplot2/unnamed-chunk-21-1.png" width="1050" />
</figure>
<p>Ce graphique utilise tous les éléments présentés dans ce chapitre, ainsi qu’une dernière nouveauté : l’utilisation d’un thème graphique différent du thème par défaut de <code class="pkg">ggplot2</code>. Le thème par défaut, qui s’appelle <code>theme_grey</code>, est ici remplacé par un thème moins chargé, <code>theme_bw</code> (“<em>black and white</em>”), que l’on a modifié en y rajoutant <a href="http://docs.ggplot2.org/current/theme.html">quelques paramètres supplémentaires</a> :</p>
<ul>
<li>le paramètre <code>strip.background</code> détermine la couleur du rectangle contenant les titres des facettes, c’est-à-dire les décennies observées ;</li>
<li>le paramètre <code>strip.text</code> détermine la taille des titres des facettes, qui sont ici affichés dans la même taille de texte que le reste du texte ;</li>
<li>et le paramètre <code>panel.grid</code> supprime ici les guides du graphique grâce à l’élément vide <code>element_blank</code>, de manière à en alléger la lecture.</li>
</ul>
<p>Ces différents réglages peuvent être sauvegardés de manière à créer des thèmes réutilisables, comme <a href="https://github.com/jrnold/ggthemes/blob/master/README.md#examples">ceux de l’extension <code class="pkg">ggthemes</code></a>, ce qui permet par exemple de créer un thème entièrement blanc dans lequel on peut ensuite projeter une carte, ou de produire une série de graphiques homogènes d’un point de vue esthétique.</p>
</div>
<div id="export-des-graphiques" class="section level3 hasAnchor">
<h3 class="hasAnchor">Export des graphiques<a href="#export-des-graphiques" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les graphiques produits par <code class="pkg">ggplot2</code> peuvent être sauvegardés manuellement, comme expliqué dans le chapitre <q><a href="export-de-graphiques.html">Export des graphiques</a></q>, ou programmatiquement. Pour sauvegarder le dernier graphique affiché par <code class="pkg">ggplot2</code> au format PNG, il suffit d’utiliser la fonction <code data-pkg="ggplot2" data-rdoc="ggsave">ggsave</code>, qui permet d’en régler la taille (en pouces) et la résolution (en pixels par pouce ; 72 par défaut) :</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;reinhart-rogoff.png&quot;</span>, <span class="at">width =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code></pre></div>
<p>De la même manière, pour sauvegarder n’importe quel graphique construit avec <code class="pkg">ggplot2</code> et stocké dans un objet, il suffit de préciser le nom de cet objet, comme ci-dessous, où l’on sauvegarde le graphique contenu dans l’objet <code>p</code> au format vectoriel PDF, qui préserve la netteté du texte et des autres éléments du graphique à n’importe quelle résolution d’affichage :</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;reinhart-rogoff.pdf&quot;</span>, <span class="at">plot =</span> p,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code></pre></div>
</div>
</div>
<div id="pour-aller-plus-loin" class="section level2 hasAnchor">
<h2 class="hasAnchor">Pour aller plus loin<a href="#pour-aller-plus-loin" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ce chapitre n’a pu faire la démonstration que d’une infime partie des manières d’utiliser <code class="pkg">ggplot2</code>. En voici une dernière illustration, qui donne une idée des différents types de graphiques que l’extension permet de produire dès que l’on connaît les principaux éléments de sa syntaxe :</p>
<figure>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> debt, <span class="fu">aes</span>(<span class="at">x =</span> ratio <span class="sc">&gt;</span> <span class="dv">90</span>, <span class="at">y =</span> growth)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt; 90&quot;</span>, <span class="st">&quot;90+&quot;</span>)) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Decade) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Taux de croissance du produit intérieur brut</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Ratio dette publique / produit intérieur brut (%)&quot;</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Données Reinhart et Rogoff corrigées, 1946-2009</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>)),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<img src="graphs/intro-ggplot2/unnamed-chunk-24-1.png" width="1050" />
</figure>
<p>Le code ci-dessus est somme toute très proche du code présenté dans le reste du texte, et en même temps, on a basculé de la visualisation sous forme de série temporelles à une visualisation par <em>boxplots</em>. Ces basculements sont très faciles à envisager dès que l’on maîtrise les principaux éléments de <code class="pkg">ggplot2</code>, <code>geom</code>, <code>scale</code> et <code>facet</code>, et les paramètres <code>labs</code> et <code>theme</code> pour effectuer les finitions.</p>
<div id="ressources-essentielles" class="section level3 hasAnchor">
<h3 class="hasAnchor">Ressources essentielles<a href="#ressources-essentielles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour tout ce qui concerne l’utilisation de <code class="pkg">ggplot2</code>, <a href="http://ggplot2.org/book/">l’ouvrage de Wickham</a>, <a href="https://github.com/hadley/ggplot2-book">en cours d’actualisation</a>, est la ressource essentielle à consulter. <a href="https://books.google.fr/books?id=ob0VAAAAQBAJ">L’ouvrage de Winston Chang</a>, qui contient des <a href="http://www.cookbook-r.com/Graphs/">dizaines d’exemples</a>, le complète utilement, de même que la <a href="http://docs.ggplot2.org/current/">documentation en ligne</a> de l’extension. Enfin, le site <a href="https://stackoverflow.com/questions/tagged/ggplot2">StackOverflow</a> contient de très nombreuses questions/réponses sur les subtilités de sa syntaxe.</p>
<p>On trouve aussi très facilement, ailleurs sur Internet, des dizaines de <em>tutorials</em> et autres <em>cheatsheets</em> pour <code class="pkg">ggplot2</code>, <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/">ici</a> ou <a href="http://www.rstudio.com/wp-content/uploads/2015/04/ggplot2-cheatsheet.pdf">là</a> par exemple.</p>
<p>A noter également une gallerie de graphiques sous <strong>R</strong> avec de très nombreux exemples de graphique <code class="pkg">ggplot2</code> : <a href="http://www.r-graph-gallery.com/portfolio/ggplot2-package/" class="uri">http://www.r-graph-gallery.com/portfolio/ggplot2-package/</a></p>
</div>
<div id="extensions-de-ggplot2" class="section level3 hasAnchor">
<h3 class="hasAnchor">Extensions de ggplot2<a href="#extensions-de-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il faut signaler, pour terminer, quelques-unes des différentes extensions inspirées de <code class="pkg">ggplot2</code>, dont la plupart sont encore en cours de développement, mais qui permettent d’ores et déjà de produire des centaines de types de graphiques différents, à partir d’une syntaxe graphique proche de celle présentée dans ce chapitre :</p>
<ul>
<li>l’extension <code class="pkg">ggfortify</code> permet de <a href="https://github.com/sinhrks/ggfortify/blob/master/README.rst#examples">visualiser les résultats de différentes fonctions de modélisation</a> avec <code class="pkg">ggplot2</code> ;</li>
<li>l’extension <code class="pkg">ggmap</code> permet de visualiser des fonds de carte et d’y superposer des éléments graphiques rédigés avec <code class="pkg">ggplot2</code> ;</li>
<li>l’extension <code class="pkg">GGally</code> rajoute quelques types de graphiques à ceux que <code class="pkg">ggplot2</code> peut produire par défaut ;</li>
<li>et des extensions comme <code class="pkg">ggvis</code> permettent de <a href="http://ggvis.rstudio.com/">produire des graphiques interactifs</a> en utilisant la syntaxe de base de <code class="pkg">ggplot2</code>.</li>
</ul>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Voir l’excellente <a href="http://ggplot2.org/">documentation de l’extension</a> et les autres ressources citées en fin de chapitre.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Bien que l’on ait fait le choix de présenter l’extension <code class="pkg">ggplot2</code> plutôt que l’extension <code class="pkg">lattice</code>, celle-ci reste un excellent choix pour la visualisation, notamment, de <a href="http://www.magesblog.com/2013/09/using-planelgroups-in-lattice.html">panels</a> et de <a href="http://www.fromthebottomoftheheap.net/2013/10/23/time-series-plots-with-lattice-and-ggplot/">séries temporelles</a>. On trouve de <a href="https://procomun.wordpress.com/2015/04/14/mapping-flows-in-r-with-data-table-and-lattice/">très beaux exemples</a> d’utilisation de <code class="pkg">lattice</code> en ligne, mais un peu moins de documentation, et beaucoup moins d’extensions, que pour <code class="pkg">ggplot2</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Ce produit est mesuré en <a href="https://fr.wikipedia.org/wiki/Produit_intérieur_brut_réel">termes réels</a>, de manière à ce que le calcul de sa croissance ne soit pas affecté par l’inflation.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Plus précisément, cela introduit un retour à la ligne dans le titre de l’axe.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>La régression locale est une variante du calcul de la <a href="https://fr.wikipedia.org/wiki/Moyenne_glissante">moyenne glissante</a> (ou <q>moyenne mobile</q>) d’une courbe.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copié !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
-->

<!-- Giscus comments -->
<script src="https://giscus.app/client.js"
        data-repo="larmarange/analyse-R"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzNDk4NjY2Ng=="
        data-category-id="DIC_kwDOAhXaqs4B_iH_"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="light"
        data-lang="fr"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->



</body>
</html>
