<!DOCTYPE html>

<html lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Classification ascendante hi√©rarchique (CAH)</title>

<script src="libs/header-attrs-2.19/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Pr√©sentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des donn√©es</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise √† jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnees.html">Listes et Tableaux de donn√©es</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellis√©s</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de donn√©es</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">O√π trouver de l'aide¬†?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de donn√©es</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses donn√©es</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les donn√©es avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avanc√©es avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions √† fen√™tre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">R√©organiser ses donn√©es avec <strong>tidyr</strong></a></li>
                  <!--<li><a href="scraping.html">Scraping</a></li>-->
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de donn√©es</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univari√©e</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivari√©e</a></li>
                  <li><a href="intro-ggplot2.html">Introduction √† <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univari√©s et bivari√©s avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Donn√©es pond√©r√©es</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques interm√©diaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">D√©finir un plan d'√©chantillonnage complexe avec <strong>survey</strong></a></li>
                  <li><a href="regression-lineaire.html">R√©gression lin√©aire</a></li>
                  <li><a href="regression-logistique.html">R√©gression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hi√©rarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avanc√©es</li>
                  <li><a href="gtsummary.html">Tableaux statistiques avanc√©s avec <strong>gtsummary</strong></a></li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un mod√®le</a></li>
                  <li><a href="multicolinearite.html">Multicolin√©arit√© dans la r√©gression</a></li>
                  <li><a href="modeles.html">Quel type de mod√®les choisir¬†?</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de s√©quences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Mod√®les √† effets al√©atoires (mod√®les mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de donn√©es longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de r√©seaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
                  <li><a href="analyse-textuelle.html">Analyse textuelle</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">√âtendre <strong>ggplot2</strong></a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="exemples-graphiques-avances.html">Exemples de graphiques avanc√©s</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong>¬†: graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
                  <li><a href="autres-extensions-graphiques.html">Autres extensions graphiques</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation (dont <strong>purrr</strong>)</a></li>
                  <li><a href="expressions-regulieres.html">Expressions r√©guli√®res</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">√âcrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong>¬†: les rapports automatis√©s</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres avec <strong>scales</strong></a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations math√©matiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un √¢ge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <li><a href="https://larmarange.github.io/guide-R/">guide-R</a></li>
        <li><a href="https://larmarange.github.io/webin-R/">webin-R</a></li>
        <li><a href="https://www.youtube.com/c/webinR"><i class="fa fa-youtube" aria-hidden="true"></i></a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div id="header">



<h1 class="title toc-ignore">Classification ascendante hi√©rarchique (CAH)</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#calculer-une-matrice-des-distances" id="toc-calculer-une-matrice-des-distances">Calculer une matrice des distances</a>
<ul>
<li><a href="#distance-de-gower" id="toc-distance-de-gower">Distance de Gower</a></li>
<li><a href="#distance-du-œÜ¬≤" id="toc-distance-du-œÜ¬≤">Distance du Œ¶¬≤</a></li>
<li><a href="#exemple" id="toc-exemple">Exemple</a></li>
</ul></li>
<li><a href="#calcul-du-dendrogramme" id="toc-calcul-du-dendrogramme">Calcul du dendrogramme</a></li>
<li><a href="#d√©couper-le-dendrogramme" id="toc-d√©couper-le-dendrogramme">D√©couper le dendrogramme</a></li>
<li><a href="#caract√©riser-la-typologie" id="toc-caract√©riser-la-typologie">Caract√©riser la typologie</a></li>
<li><a href="#factominer" id="toc-factominer">CAH avec l‚Äôextension FactoMineR</a></li>
</ul>
</div>

<div class="webin-R">
<p>Ce chapitre est √©voqu√© dans le webin-R #12 (Classification ascendante hi√©rarchique sur <a href="https://youtu.be/Q8adb64NzUI">YouTube</a>.</p>
</div>
<div class="note">
<p>Pour une introduction didactique et en fran√ßais √† la classification, voir ce <a href="https://quanti.hypotheses.org/2186">billet de Philippe Cibois sur Hypothses.org</a>.</p>
</div>
<p>Il existe de nombreuses techniques statistiques visant √† partinionner une population en diff√©rentes classes ou sous-groupes. La <dfn>classification ascendante hi√©rarchique</dfn> (<dfn>CAH</dfn>) est l‚Äôune d‚Äôentre elles. On cherche √† ce que les individus regroup√©s au sein d‚Äôune m√™me classe (homog√©n√©it√© intra-classe) soient le plus semblables possibles tandis que les classes soient le plus dissemblables (h√©t√©rog√©n√©it√© inter-classe).</p>
<p>Le principe de la CAH est de rassembler des individus selon un crit√®re de ressemblance d√©fini au pr√©alable qui s‚Äôexprimera sous la forme d‚Äôune <dfn>matrice de distances</dfn>, exprimant la distance existant entre chaque individu pris deux √† deux. Deux observations identiques auront une distance nulle. Plus les deux observations seront dissemblables, plus la distance sera importante. La CAH va ensuite rassembler les individus de mani√®re it√©rative afin de produire un <dfn>dendrogramme</dfn> ou <dfn>arbre de classification</dfn><dfn data-index="classification, arbre"></dfn>. La classification est <em>ascendante</em> car elle part des observations individuelles¬†; elle est <em>hi√©rarchique</em> car elle produit des classes ou groupes de plus en plus vastes, incluant des sous-groupes en leur sein. En d√©coupant cet arbre √† une certaine hauteur choisie, on produira la <dfn>partition</dfn> d√©sir√©e.</p>
<div class="note">
<p>On trouvera √©galement de nombreux supports de cours en fran√ßais sur la CAH sur le site de Fran√ßois Gilles Carpentier¬†: <a href="http://pagesperso.univ-brest.fr/~carpenti/" class="uri">http://pagesperso.univ-brest.fr/~carpenti/</a>.</p>
</div>
<div id="calculer-une-matrice-des-distances" class="section level2 hasAnchor">
<h2 class="hasAnchor">Calculer une matrice des distances<a href="#calculer-une-matrice-des-distances" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La notion de <dfn>ressemblance</dfn> entre observations est √©valu√©e par une <dfn>distance</dfn> entre individus. Plusieurs type de ditances existent selon les donn√©es utilis√©es.</p>
<p>Il existe de nombreuses distances math√©matiques pour les variables quantitatives (euclidiennes, Manhattan‚Ä¶) que nous n‚Äôaborderons pas ici<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. La plupart peuvent √™tre calcul√©es avec la fonction <code data-pkg="stats">dist</code>.</p>
<p>Usuellement, pour un ensemble de variables qualitatives, on aura recours √† la <dfn data-index="distance du Phi¬≤">distance du Œ¶¬≤</dfn><dfn data-index="Phi¬≤, distance"></dfn> qui est celle utilis√©e pour l‚Äôanalyse des correspondances multiples (voir le <a href="">chapitre d√©di√©</a>). Avec l‚Äôextension <code class="pkg">ade4</code>, la distance du Œ¶¬≤ s‚Äôobtient avec la fonction <code data-pkg="ade4">dist.dudi</code><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. Le cas particulier de la CAH avec l‚Äôextension <code class="pkg">FactoMineR</code> sera abord√©e dans une section sp√©cifique ci-apr√®s. Nous √©voquerons √©galement la <dfn>distance de Gower</dfn><dfn data-index="Gower, distance"></dfn> qui peut s‚Äôappliquer √† un ensemble de variables √† la fois qualitatives et quantitatives et qui se calcule avec la fonction <code data-pkg="cluster">daisy</code> de l‚Äôextension <code class="pkg">cluster</code>. Enfin, dans le chapitre sur l‚Äô<a href="analyse-de-sequences.html">analyse de
s√©quences</a>, nous verrons √©galement la fonction <code data-pkg="TraMineR">seqdist</code> (extension <code class="pkg">TraMineR</code>) permettant de calculer une distance entre s√©quences.</p>
<div id="distance-de-gower" class="section level3 hasAnchor">
<h3 class="hasAnchor">Distance de Gower<a href="#distance-de-gower" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En 1971, Gower a propos√© un <dfn>indice de similarit√©</dfn><dfn data-index="similarit√©, indice"></dfn> qui porte son nom<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. L‚Äôobjectif de cet indice consiste √† mesurer dans quelle mesure deux individus sont semblables. L‚Äôindice de Gower varie entre 0 et 1. Si l‚Äôindice vaut 1, les deux individus sont identiques. √Ä l‚Äôoppos√©, s‚Äôil vaut 0, les deux individus consid√©r√©s n‚Äôont pas de point commun. Si l‚Äôon note <em>S<sub>g</sub></em> l‚Äô<dfn>indice de similarit√© de Gower</dfn><dfn data-index="Gower, indice de similarit√©"></dfn>, la distance de Gower <em>D<sub>g</sub></em> s‚Äôobtient simplement de la mani√®re suivante¬†: <em>D<sub>g</sub></em>¬†=¬†1¬†-¬†<em>S<sub>g</sub></em>. Ainsi, la distance sera nulle entre deux individus identiques et elle sera √©gale √† 1 entre deux individus totalement diff√©rents. Cette distance s‚Äôobtient sous <strong>R</strong> avec la fonction <code data-pkg="cluster">daisy</code> du package <code
class="pkg">cluster</code>.</p>
<p>L‚Äôindice de similarit√© de Gower entre deux individus <em>x<sub>1</sub></em> et <em>x<sub>2</sub></em> se calcule de la mani√®re suivante¬†:</p>
<!-- 
$$ S_{g}(x_{1},x_{2})=\frac{1}{p}\sum_{j=1}^{p}s_{12j} $$
converted on http://www2.ph.ed.ac.uk/snuggletex/MathInputDemo
-->
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"> <semantics> <mrow> <msub> <mi>S</mi> <mi>g</mi> </msub> <mfenced close=")" open="("> <msub> <mi>x</mi> <mn>1</mn> </msub> <msub> <mi>x</mi> <mn>2</mn> </msub> </mfenced> <mo>=</mo> <mfrac> <mn>1</mn> <mi>p</mi> </mfrac> <munderover> <mo>‚àë</mo> <mrow> <mi>j</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>p</mi> </munderover> <msub> <mi>s</mi> <mrow> <mn>12</mn> <mi>j</mi> </mrow> </msub> </mrow> </semantics> </math></p>
<p><em>p</em> repr√©sente le nombre total de caract√®res (ou de variables) descriptifs utilis√©s pour comparer les deux individus<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. <em>s</em><sub>12<em>j</em></sub> repr√©sente la similarit√© partielle entre les individus 1 et 2 concernant le descripteur <em>j</em>. Cette similarit√© partielle se calcule diff√©remment s‚Äôil s‚Äôagit d‚Äôune <dfn>variable qualitative</dfn><dfn data-index="qualitative, variable"></dfn> ou <dfn data-index="variable quantitative">quantitative</dfn><dfn data-index="quantitative, variable"></dfn>¬†:</p>
<ul>
<li><strong>variable qualitative¬†:</strong> <em>s</em><sub>12<em>j</em></sub> vaut 1 si la variable <em>j</em> prend la m√™me valeur pour les individus 1 et 2, et vaut 0 sinon. Par exemple, si 1 et 2 sont tous les deux ¬´¬†grand¬†¬ª, alors <em>s</em><sub>12<em>j</em></sub> vaudra 1. Si 1 est ¬´¬†grand¬†¬ª et 2 ¬´¬†petit¬†¬ª, <em>s</em><sub>12<em>j</em></sub> vaudra 0.</li>
<li><strong>variable quantitative¬†:</strong> la diff√©rence absolue entre les valeurs des deux variables est tout d‚Äôabord calcul√©e, soit |<em>y</em><sub>1<em>j</em></sub>¬†‚àí¬†<em>y</em><sub>2<em>j</em></sub>|. Puis l‚Äô√©cart maximum observ√© sur l‚Äôensemble du fichier est d√©termin√© et not√© <em>R</em><sub><em>j</em></sub>. D√®s lors, la similarit√© partielle vaut <em>S</em><sub>12<em>j</em></sub>¬†=¬†1¬†-¬†|<em>y</em><sub>1<em>j</em></sub>¬†‚àí¬†<em>y</em><sub>2<em>j</em></sub>|¬†/¬†<em>R</em><sub><em>j</em></sub>.</li>
</ul>
<p>Dans le cas o√π l‚Äôon n‚Äôa que des variables qualitatives, la valeur de l‚Äôindice de Gower correspond √† la proportion de caract√®res en commun. Supposons des individus 1 et 2 d√©cris ainsi¬†:</p>
<ol style="list-style-type: decimal">
<li>homme / grand / blond / √©tudiant / urbain</li>
<li>femme / grande / brune / √©tudiante / rurale</li>
</ol>
<p>Sur les 5 variables utilis√©es pour les d√©crire, 1 et 2 ont deux caract√©ristiques communes¬†: ils sont grand(e)s et √©tudiant(e)s. D√®s lors, l‚Äôindice de similarit√© de Gower entre 1 et 2 vaut 2/5¬†=¬†0,4 (soit une distance de 1¬†‚àí¬†0,4¬†=¬†0,6).</p>
<p>Plusieurs approches peuvent √™tre retenues pour traiter les valeurs manquantes¬†:</p>
<ul>
<li>supprimer tout individu n‚Äô√©tant pas renseign√© pour toutes les variables de l‚Äôanalyse¬†;</li>
<li>consid√©rer les valeurs manquantes comme une modalit√© en tant que telle¬†;</li>
<li>garder les valeurs manquantes en tant que valeurs manquantes.</li>
</ul>
<p>Le choix retenu modifiera les distances de Gower calcul√©es. Supposons que l‚Äôon ait¬†:</p>
<ol style="list-style-type: decimal">
<li>homme / grand / blond / √©tudiant / urbain</li>
<li>femme / grande / brune / √©tudiante / manquant</li>
</ol>
<p>Si l‚Äôon supprime les individus ayant des <dfn data-index="valeur manquante">valeurs manquantes</dfn><dfn data-index="manquante, valeur"></dfn>, 2 est retir√©e du fichier d‚Äôobservations et aucune distance n‚Äôest calcul√©e.</p>
<p>Si l‚Äôon traite les valeurs manquantes comme une modalit√© particuli√®re, 1 et 2 partagent alors 2 caract√®res sur les 5 analys√©s, la distance de Gower entre eux est alors de 1¬†‚àí¬†2/5¬†=1¬†‚àí¬†0,4¬†=¬†0,6.</p>
<p>Si on garde les valeurs manquantes, l‚Äôindice de Gower est d√®s lors calcul√© sur les seuls descripteurs renseign√©s √† la fois pour 1 et 2. La distance de Gower sera calcul√©e dans le cas pr√©sent uniquement sur les 4 caract√®res renseign√©s et vaudra 1¬†‚àí¬†2/4¬†=¬†0,5.</p>
</div>
<div id="distance-du-œÜ¬≤" class="section level3 hasAnchor">
<h3 class="hasAnchor">Distance du Œ¶¬≤<a href="#distance-du-œÜ¬≤" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il s‚Äôagit de la distance utilis√©e dans les analyses de correspondance multiples (ACM). C‚Äôest une variante de la <dfn data-index="distance du Chi¬≤">distance du œá¬≤</dfn><dfn data-index="Chi¬≤, distance"></dfn>. Nous consid√©rons ici que nous avons <em>Q</em> questions (soit <em>Q</em> variables initiales de type facteur). √Ä chaque individu est associ√© un <dfn>patron</dfn> c‚Äôest-√†-dire une certaine combinaison de r√©ponses aux <em>Q</em> questions. La distance entre deux individus correspond √† la distance entre leurs deux patrons. Si les deux individus pr√©sentent le m√™me patron, leur distance sera nulle. La distance du Œ¶¬≤ peut s‚Äôexprimer ainsi¬†:</p>
<!-- 
$$ d_{\Phi^2}^2(L_i,L_j)=\frac{1}{Q}\sum_{k}\frac{(\delta_{ik}-\delta_{jk})^2}{f_k} $$ 
converted on http://www2.ph.ed.ac.uk/snuggletex/MathInputDemo
-->
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"> <semantics> <mrow> <msubsup> <mi>d</mi> <msup> <mi>Œ¶</mi> <mn>2</mn> </msup> <mn>2</mn> </msubsup> <mfenced close=")" open="("> <msub> <mi>L</mi> <mi>i</mi> </msub> <msub> <mi>L</mi> <mi>j</mi> </msub> </mfenced> <mo>=</mo> <mfrac> <mn>1</mn> <mi>Q</mi> </mfrac> <munder> <mo>‚àë</mo> <mi>k</mi> </munder> <mfrac> <msup> <mfenced close=")" open="("> <mrow> <msub> <mi>Œ¥</mi> <mrow> <mi>i</mi> <mi>k</mi> </mrow> </msub> <mo>-</mo> <msub> <mi>Œ¥</mi> <mrow> <mi>j</mi> <mi>k</mi> </mrow> </msub> </mrow> </mfenced> <mn>2</mn> </msup> <msub> <mi>f</mi> <mi>k</mi> </msub> </mfrac> </mrow> </semantics> </math></p>
<p>o√π <em>L<sub>i</sub></em> et <em>L<sub>j</sub></em> sont deux patrons, <em>Q</em> le nombre total de questions. <em>Œ¥<sub>ik</sub></em> vaut 1 si la modalit√© <em>k</em> est pr√©sente dans le patron <em>L<sub>i</sub></em>, 0 sinon. <em>f<sub>k</sub></em> est la fr√©quence de la modalit√© <em>k</em> dans l‚Äôensemble de la population.</p>
<p>Exprim√© plus simplement, on fait la somme de l‚Äôinverse des modalit√©s non communes aux deux patrons, puis on divise par le nombre total de question. Si nous reprenons notre exemple pr√©c√©dent¬†:</p>
<ol style="list-style-type: decimal">
<li>homme / grand / blond / √©tudiant / urbain</li>
<li>femme / grande / brune / √©tudiante / rurale</li>
</ol>
<p>Pour calculer la distance entre 1 et 2, il nous faut conna√Ætre la proportion des diff√©rentes modalit√©s dans l‚Äôensemble de la population √©tudi√©e. En l‚Äôoccurrence¬†:</p>
<ul>
<li>hommes¬†: 52¬†% / femmes¬†: 48¬†%</li>
<li>grand¬†: 30¬†% / moyen¬†: 45¬†% / petit¬†: 25¬†%</li>
<li>blond¬†: 15¬†% / ch√¢tain¬†: 45¬†% / brun¬†: 30¬†% / blanc¬†: 10¬†%</li>
<li>√©tudiant¬†: 20 % / salari√©s¬†: 65¬†% / retrait√©s¬†: 15¬†%</li>
<li>urbain¬†: 80 % / rural¬†: 20¬†%</li>
</ul>
<p>Les modalit√©s non communes entre les profils de 1 et 2 sont¬†: homme, femme, blond, brun, urbain et rural. La distance du Œ¶¬≤ entre 1 et 2 est donc la suivante¬†:</p>
<!-- 
$$ d_{\Phi^2}^2(L_1,L_2)=\frac{1}{5}(\frac{1}{0,52}+\frac{1}{0,48}+\frac{1}{0,15}+\frac{1}{0,30}+\frac{1}{0,80}+\frac{1}{0,20})=4,05 $$
converted on http://www2.ph.ed.ac.uk/snuggletex/MathInputDemo
-->
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"> <semantics> <mrow> <msubsup> <mi>d</mi> <msup> <mi>Œ¶</mi> <mn>2</mn> </msup> <mn>2</mn> </msubsup> <mfenced close=")" open="("> <msub> <mi>L</mi> <mn>1</mn> </msub> <msub> <mi>L</mi> <mn>2</mn> </msub> </mfenced> <mo>=</mo> <mfrac> <mn>1</mn> <mn>5</mn> </mfrac> <mfenced close=")" open="("> <mrow> <mfrac> <mn>1</mn> <mrow> <mn>0</mn> <mo>,</mo> <mn>52</mn> </mrow> </mfrac> <mo>+</mo> <mfrac> <mn>1</mn> <mrow> <mn>0</mn> <mo>,</mo> <mn>48</mn> </mrow> </mfrac> <mo>+</mo> <mfrac> <mn>1</mn> <mrow> <mn>0</mn> <mo>,</mo> <mn>15</mn> </mrow> </mfrac> <mo>+</mo> <mfrac> <mn>1</mn> <mrow> <mn>0</mn> <mo>,</mo> <mn>30</mn> </mrow> </mfrac> <mo>+</mo> <mfrac> <mn>1</mn> <mrow> <mn>0</mn> <mo>,</mo> <mn>80</mn> </mrow> </mfrac> <mo>+</mo> <mfrac> <mn>1</mn> <mrow> <mn>0</mn> <mo>,</mo> <mn>20</mn> </mrow> </mfrac> </mrow> </mfenced> <mo>=</mo> <mn>4</mn> <mo>,</mo> <mn>05</mn> </mrow> </semantics> </math></p>
<p>Cette distance, bien que moins intuitive que la distance de Gower √©voqu√©e pr√©c√©demment, est la plus employ√©e pour l‚Äôanalyse d‚Äôenqu√™tes en sciences sociales. Il faut retenir que la distance entre deux profils est d√©pendante de la distribution globale de chaque modalit√© dans la population √©tudi√©e. Ainsi, si l‚Äôon recalcule les distances entre individus √† partir d‚Äôun sous-√©chantillon, le r√©sultat obtenu sera diff√©rent. De mani√®re g√©n√©rale, les individus pr√©sentant des caract√©ristiques rares dans la population vont se retrouver √©loign√©s des individus pr√©sentant des caract√©ristiques fortement repr√©sent√©es.</p>
</div>
<div id="exemple" class="section level3 hasAnchor">
<h3 class="hasAnchor">Exemple<a href="#exemple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nous allons reprendre l‚ÄôACM calcul√©e avec <code data-pkg="ade4">dudi.acm</code> (<code class="pkg">ade4</code>) dans le <a href="">chapitre consacr√© √† l‚ÄôACM</a>¬†:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hdv2003)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> hdv2003</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>grpage <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">65</span>, <span class="dv">93</span>), <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>etud <span class="ot">&lt;-</span> d<span class="sc">$</span>nivetud</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(d<span class="sc">$</span>etud) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Primaire&quot;</span>, <span class="st">&quot;Primaire&quot;</span>, <span class="st">&quot;Primaire&quot;</span>, <span class="st">&quot;Secondaire&quot;</span>, <span class="st">&quot;Secondaire&quot;</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;Technique/Professionnel&quot;</span>, <span class="st">&quot;Technique/Professionnel&quot;</span>, <span class="st">&quot;Sup√©rieur&quot;</span> )</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[, <span class="fu">c</span>(<span class="st">&quot;grpage&quot;</span>, <span class="st">&quot;sexe&quot;</span>, <span class="st">&quot;etud&quot;</span>, <span class="st">&quot;peche.chasse&quot;</span>, <span class="st">&quot;cinema&quot;</span>, <span class="st">&quot;cuisine&quot;</span>, <span class="st">&quot;bricol&quot;</span>, <span class="st">&quot;sport&quot;</span>, <span class="st">&quot;lecture.bd&quot;</span>)]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>acm <span class="ot">&lt;-</span> <span class="fu">dudi.acm</span>(d2, <span class="at">scannf =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>La matrice des distances s‚Äôobtient d√®s lors avec la fonction <code data-pkg="ade4">dist.dudi</code>¬†:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>md <span class="ot">&lt;-</span> <span class="fu">dist.dudi</span>(acm)</span></code></pre></div>
<p>Pour une matrice de distances bas√©e sur la distance de Gower, nous aurions eu plut√¥t recours √† la fonction <code data-pkg="cluster">daisy</code> de l‚Äôextension <code class="pkg">cluster</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>md_gower <span class="ot">&lt;-</span> <span class="fu">daisy</span>(d2, <span class="at">metric =</span> <span class="st">&quot;gower&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="calcul-du-dendrogramme" class="section level2 hasAnchor">
<h2 class="hasAnchor">Calcul du dendrogramme<a href="#calcul-du-dendrogramme" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il faut ensuite choisir une m√©thode d‚Äô<dfn>agr√©gation</dfn> pour construire le dendrogramme. De nombreuses solutions existent (saut minimum, distance maximum, moyenne, Ward‚Ä¶). Chacune d‚Äôelle produira un dendrogramme diff√©rent. Nous ne d√©taillerons pas ici ces diff√©rentes techniques<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. Cependant, √† l‚Äôusage, on privil√©giera le plus souvent la <dfn>m√©thode de Ward</dfn><dfn data-index="Ward, m√©thode"></dfn><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>. De mani√®re simplifi√©e, cette m√©thode cherche √† minimiser l‚Äôinertie intra-classe et √† maximiser l‚Äôinertie inter-classe afin d‚Äôobtenir des classes les plus homog√®nes possibles. Cette m√©thode est souvent incorrectement pr√©sent√©e comme une <q>m√©thode de minimisation de la variance</q> alors qu‚Äôau sens strict Ward vise <q>l‚Äôaugmentation mininum de la somme des carr√©s</q> (‚Äúminimum increase of sum-of-squares (of errors)‚Äù)<a href="#fn7" class="footnote-ref"
id="fnref7"><sup>7</sup></a>.</p>
<p>En raison de la vari√©t√© des distances possibles et de la vari√©t√© des techniques d‚Äôagr√©gation, on pourra √™tre amen√© √† r√©aliser plusieurs dendrogrammes diff√©rents sur un m√™me jeu de donn√©es jusqu‚Äô√† obtenir une classification qui fait ¬´¬†sens¬†¬ª.</p>
<p>La fonction de base pour le calcul d‚Äôun dendrogramme est <code data-pkg="stats">hclust</code> en pr√©cisant le crit√®re d‚Äôagr√©gation avec <code>method</code>. Dans notre cas, nous allons opter pour la m√©thode de Ward appliqu√©e au carr√© des distances (ce qu‚Äôon indique avec <code>method = "ward.D2"</code><a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>)¬†:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>arbre <span class="ot">&lt;-</span> <span class="fu">hclust</span>(md, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span></code></pre></div>
<div class="note">
<p>Le temps de calcul d‚Äôun dendrogramme peut √™tre particuli√®rement important sur un gros fichier de donn√©es. L‚Äôextension <code class="pkg">fastcluster</code> permet de r√©duire significativement le temps de calcul. Il suffit d‚Äôinstaller puis d‚Äôappeler cette extension. La fonction <code data-pkg="fastcluster">hclust</code> sera automatiquement remplac√©e par cette version optimis√©e. Elle prends les m√™mes param√®tres¬†:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fastcluster)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>arbre <span class="ot">&lt;-</span> <span class="fu">hclust</span>(md, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span></code></pre></div>
</div>
<p>Le dendrogramme obtenu peut √™tre affich√© simplement avec <code data-pkg="stats" data-rdoc="hclust">plot</code>. Lorsque le nombre d‚Äôindividus est important, il peut √™tre utile de ne pas afficher les √©tiquettes des individus avec <code>labels=FALSE</code>.</p>
<figure>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(arbre, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Dendrogramme&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-6-1.png" width="672" />
<figcaption>
Dendrogramme obtenu avec hclust
</figcaption>
</figure>
<p>Pour afficher un dendrogramme via <code class="pkg">ggplot2</code>, on pourra avoir recours √† la fonction <code data-pkg="ggdendro">ggdendrogram</code> de l‚Äôextension <code class="pkg">ggdendro</code>.</p>
<figure>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdendro)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdendrogram</span>(arbre, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-7-1.png" width="672" />
<figcaption>
Dendrogramme obtenu avec ggdendrogram
</figcaption>
</figure>
<p>La fonction <code data-pkg="cluster">agnes</code> de l‚Äôextension <code class="pkg">cluster</code> peut √©galement √™tre utilis√©e pour calculer le dendrogramme. Cependant, √† l‚Äôusage, elle semble √™tre un peu plus lente que <code data-pkg="stats">hclust</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>arbre2 <span class="ot">&lt;-</span> <span class="fu">agnes</span>(md, <span class="at">method =</span> <span class="st">&quot;ward&quot;</span>)</span></code></pre></div>
<p>ATTENTION¬†: la m√©thode impl√©ment√©e dans la fonction <code data-pkg="cluster">agnes</code> correspond √† l‚Äôoption <code>method = "ward.D2"</code> de <code data-pkg="stats">hclust</code>.</p>
<p>Le r√©sultat obtenu n‚Äôest pas au m√™me format que celui de <code data-pkg="stats">hclust</code>. Il est possible de transformer un objet <code data-pkg="cluster" data-rdoc="agnes.object">agnes</code> au format <code data-pkg="stats">hclust</code> avec <code data-pkg="cluster" data-rdoc="agnes.object">as.hclust</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.hclust</span>(arbre2)</span></code></pre></div>
</div>
<div id="d√©couper-le-dendrogramme" class="section level2 hasAnchor">
<h2 class="hasAnchor">D√©couper le dendrogramme<a href="#d√©couper-le-dendrogramme" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pour obtenir une <dfn>partition</dfn> de la population, il suffit de d√©couper le dendrogramme obtenu √† une certaine hauteur. En premier lieu, une analyse de la forme du dendrogramme pourra nous donner une indication sur le nombre de classes √† retenir. Dans notre exemple, deux branches bien distinctes apparaissent sur l‚Äôarbre.</p>
<p>Pour nous aider, nous pouvons repr√©senter les <dfn data-index="saut d'inertie">sauts d‚Äôinertie</dfn><dfn data-index="inertie, saut"></dfn> du dendrogramme selon le nombre de classes retenues.</p>
<figure>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>inertie <span class="ot">&lt;-</span> <span class="fu">sort</span>(arbre<span class="sc">$</span>height, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inertie[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Inertie&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-10-1.png" width="672" />
<figcaption>
Inertie du dendrogramme
</figcaption>
</figure>
<p>On voit trois sauts assez nets √† 2, 5 et 8 classes, que nous avons repr√©sent√©s ci-dessous respectivement en vert, en rouge et en bleu.</p>
<figure>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inertie[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Inertie&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>), inertie[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>)], <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;green3&quot;</span>, <span class="st">&quot;red3&quot;</span>, <span class="st">&quot;blue3&quot;</span>), <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-11-1.png" width="672" />
<figcaption>
Sauts d‚Äôinertie du dendrogramme
</figcaption>
</figure>
<p>La fonction <code data-pkg="stats">rect.hclust</code> permet de visualiser les diff√©rentes partitions directement sur le dendrogramme.</p>
<figure>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(arbre, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Partition en 2, 5 ou 8 classes&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">sub =</span> <span class="st">&quot;&quot;</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(arbre, <span class="dv">2</span>, <span class="at">border =</span> <span class="st">&quot;green3&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(arbre, <span class="dv">5</span>, <span class="at">border =</span> <span class="st">&quot;red3&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(arbre, <span class="dv">8</span>, <span class="at">border =</span> <span class="st">&quot;blue3&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-12-1.png" width="672" />
<figcaption>
Diff√©rentes partitions du dendrogramme
</figcaption>
</figure>
<p>On peut √©galement avoir recours √† l‚Äôextension <code class="pkg">dendextend</code> et sa fonction <code data-pkg="dendextend">color_branches</code>. √Ä noter que <code class="pkg">dendextend</code> fournit une m√©thode permettant de passer un dendrogramme √† <code data-pkg="ggplot2">ggplot</code>.</p>
<figure>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span></code></pre></div>
<pre><code>Registered S3 method overwritten by &#39;dendextend&#39;:
  method     from 
  rev.hclust vegan</code></pre>
<pre><code>
---------------------
Welcome to dendextend version 1.16.0
Type citation(&#39;dendextend&#39;) for how to cite the package.

Type browseVignettes(package = &#39;dendextend&#39;) for the package vignette.
The github page is: https://github.com/talgalili/dendextend/

Suggestions and bug-reports can be submitted at: https://github.com/talgalili/dendextend/issues
You may ask questions at stackoverflow, use the r and dendextend tags: 
     https://stackoverflow.com/questions/tagged/dendextend

    To suppress this message use:  suppressPackageStartupMessages(library(dendextend))
---------------------</code></pre>
<pre><code>
Attachement du package : &#39;dendextend&#39;</code></pre>
<pre><code>L&#39;objet suivant est masqu√© depuis &#39;package:ggdendro&#39;:

    theme_dendro</code></pre>
<pre><code>L&#39;objet suivant est masqu√© depuis &#39;package:ggpubr&#39;:

    rotate</code></pre>
<pre><code>L&#39;objet suivant est masqu√© depuis &#39;package:data.table&#39;:

    set</code></pre>
<pre><code>L&#39;objet suivant est masqu√© depuis &#39;package:stats&#39;:

    cutree</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">color_branches</span>(arbre, <span class="at">k =</span> <span class="dv">5</span>), <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-13-1.png" width="672" />
<figcaption>
Un dendrogramme color√© avec dendextend
</figcaption>
</figure>
<p>On peut aussi avoir recours √† la fonction <code data-pkg="factoextra">fviz_dend</code> de l‚Äôextension <code>factoextra</code>.</p>
<figure>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(arbre, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">show_labels =</span> <span class="cn">FALSE</span>, <span class="at">rect =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use
&quot;none&quot; instead as of ggplot2 3.3.4.
‚Ñπ The deprecated feature was likely used in the factoextra
  package.
  Please report the issue at
  &lt;]8;;https://github.com/kassambara/factoextra/issueshttps://github.com/kassambara/factoextra/issues]8;;&gt;.</code></pre>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-14-1.png" width="672" />
<figcaption>
Un dendrogramme color√© avec factoextra
</figcaption>
</figure>
<p>L‚Äôextension <code class="pkg">FactoMineR</code> (que nous aborderons <a href="#factominer">dans une section d√©di√©e ci-apr√®s</a>) sugg√®re d‚Äôutiliser la partition ayant la plus grande <dfn>perte relative d‚Äôinertie</dfn><dfn data-index="indertie, perte relative"></dfn>.</p>
<p>L‚Äôextension <code class="pkg">JLutils</code> (disponible sur <a href="https://github.com/larmarange/JLutils">GitHub</a>) propose une fonction <code data-pkg="JLutils">best.cutree</code> qui permet de calculer cette indicateur √† partir de n‚Äôimporte quel dendrogramme calcul√© avec <code data-pkg="stats">hclust</code> ou <code data-pkg="cluster">agnes</code>.</p>
<p>Pour installer <code class="pkg">JLutils</code>, on aura recours au package <code class="pkg">devtools</code> et √† sa fonction <code data-pkg="devtools">install_github</code>¬†:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;larmarange/JLutils&quot;</span>)</span></code></pre></div>
<p>Pour installer <code class="pkg">JLutils</code> sur un PC sous <strong>Windows</strong>, vous aurez √©galement besoin de <strong>Rtools</strong>, t√©l√©chargeable sur <a href="https://cran.r-project.org/bin/windows/Rtools/" class="uri">https://cran.r-project.org/bin/windows/Rtools/</a>. Une fois install√©e, pensez √† charger l‚Äôextension.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(JLutils)</span></code></pre></div>
<p>Si vous rencontrez des difficult√©s avec l‚Äôinstallation de <code class="pkg">JLutils</code> et si vous avez seulement besoin de <code data-pkg="JLutils">best.cutree</code>, vous pouvez avoir recours √† la commande suivante.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">url</span>(<span class="st">&quot;https://raw.githubusercontent.com/larmarange/JLutils/master/R/clustering.R&quot;</span>))</span></code></pre></div>
<p>Par d√©faut, <code data-pkg="JLutils">best.cutree</code> regarde quelle serait la meilleure partition entre 3 et 20 classes.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">best.cutree</span>(arbre)</span></code></pre></div>
<pre><code>[1] 5</code></pre>
<p>En l‚Äôoccurence il s‚Äôagirait d‚Äôune partition en 5 classes. Il est possible de modifier le minimum et le maximum des partitions recherch√©es avec <code>min</code> et <code>max</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">best.cutree</span>(arbre, <span class="at">min =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1] 2</code></pre>
<p>On peut √©galement repr√©senter le graphique des pertes relatives d‚Äôinertie avec <code>graph=TRUE</code>. La meilleure partition selon ce crit√®re est repr√©sent√©e par un point noir et la seconde par un point gris.</p>
<figure>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">best.cutree</span>(arbre, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">graph =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">&quot;Nombre de classes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Inertie relative&quot;</span>)</span></code></pre></div>
<p><img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre><code>[1] 2</code></pre>
<figcaption>
Perte relative d‚Äôinertie selon le nombre de classes
</figcaption>
</figure>
<p>Un d√©coupage en deux classes minimise ce crit√®re. Cependant, si l‚Äôon souhaite r√©aliser une analyse un peu plus fine, un nombre de classes plus √©lev√© serait pertinent. Nous allons donc retenir un d√©coupage en cinq classes. Le d√©coupage s‚Äôeffectue avec la fonction <code data-pkg="stats">cutree</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>typo <span class="ot">&lt;-</span> <span class="fu">cutree</span>(arbre, <span class="dv">5</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(typo)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1031","2":"51.5","3":"51.5","_rn_":"1"},{"1":"164","2":"8.2","3":"8.2","_rn_":"2"},{"1":"553","2":"27.7","3":"27.7","_rn_":"3"},{"1":"205","2":"10.2","3":"10.2","_rn_":"4"},{"1":"47","2":"2.4","3":"2.4","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="important">
<p>Je peux ajouter directement ma typologie √† mon objet <code>d2</code> ou m√™me <code>d</code> dans la mesure o√π je n‚Äôai pas modifi√© depuis le d√©but du script l‚Äôordre de mes observations. D√®s lors, l‚Äôordre du r√©sultat renvoy√© par <code data-pkg="stats">cutree</code> correspond √† l‚Äôordre de ma matrice de distance qui elle-m√™me est ordonn√©e selon les observations de l‚ÄôACM qui est ordonn√©e selon l‚Äôordre des observations du tableau de donn√©es initial.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>typo <span class="ot">&lt;-</span> <span class="fu">cutree</span>(arbre, <span class="dv">5</span>)</span></code></pre></div>
</div>
<div class="note">
<p>Il existe de multiples autres indicateurs statistiques cherchant √† mesurer la <q>qualit√©</q> de chaque partition. Pour cela, on pourra par exemple avoir recours √† la fonction <code data-pkg="WeightedCluster">as.clustrange</code> de l‚Äôextension <code class="pkg">WeightedCluster</code>.</p>
<p>Pour plus d‚Äôinformations, voir le <a href="https://cran.r-project.org/web/packages/WeightedCluster/vignettes/WeightedClusterFR.pdf"><em>manuel de la librairie WeightedCluster</em></a>, chapitre 7.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WeightedCluster)</span></code></pre></div>
<pre><code>This is WeightedCluster stable version 1.6-0 (Built: 2023-01-10)</code></pre>
<pre><code>
To get the manuals, please run:</code></pre>
<pre><code>   vignette(&quot;WeightedCluster&quot;) ## Complete manual in English</code></pre>
<pre><code>   vignette(&quot;WeightedClusterFR&quot;) ## Complete manual in French</code></pre>
<pre><code>   vignette(&quot;WeightedClusterPreview&quot;) ## Short preview in English</code></pre>
<pre><code>
To cite WeightedCluster in publications please use:</code></pre>
<pre><code>Studer, Matthias (2013). WeightedCluster Library</code></pre>
<pre><code>   Manual: A practical guide to creating typologies</code></pre>
<pre><code>   of trajectories in the social sciences with R.</code></pre>
<pre><code>   LIVES Working Papers, 24. doi:</code></pre>
<pre><code>   10.12682/lives.2296-1658.2013.24</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.clustrange</span>(arbre, md))</span></code></pre></div>
<p><img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<p>La typologie obtenue peut √™tre repr√©sent√©e dans le plan factoriel avec <code data-pkg="ade4">s.class</code>.</p>
<figure>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">s.class</span>(acm<span class="sc">$</span>li, <span class="fu">as.factor</span>(typo), <span class="at">col =</span> <span class="fu">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Set1&quot;</span>), <span class="at">sub =</span> <span class="st">&quot;Axes 1 et 2&quot;</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">s.class</span>(acm<span class="sc">$</span>li, <span class="fu">as.factor</span>(typo), <span class="dv">3</span>, <span class="dv">4</span>, <span class="at">col =</span> <span class="fu">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Set1&quot;</span>), <span class="at">sub =</span> <span class="st">&quot;Axes 3 et 4&quot;</span>)</span></code></pre></div>
<p><img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<figcaption>
Projection de la typologie obtenue par CAH selon les 4 premiers axes
</figcaption>
</figure>
<div class="note">
<p>De nombreuses possibilit√©s graphiques sont possibles avec les dendrogrammes. Des exemples document√©s sont disponibles √† cette adresse¬†: <a href="http://rpubs.com/gaston/dendrograms" class="uri">http://rpubs.com/gaston/dendrograms</a>.</p>
<p>Romain Fran√ßois a developp√© une fonction <code data-pkg="JLutils">A2Rplot</code> permettant de r√©aliser facilement un dendrogramme avec les branches color√©es<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>. Par commodit√©, cette fonction est disponible directement au sein de l‚Äôextension <code class="pkg">JLutils</code>.</p>
<p>Si vous rencontrez des difficult√©s √† installer <code class="pkg">JLutils</code>, vous pouvez √©galement charger seulement <code data-pkg="JLutils">A2Rplot</code>source() avec la commande :</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">url</span>(<span class="st">&quot;https://raw.githubusercontent.com/larmarange/JLutils/master/R/A2Rplot.R&quot;</span>))</span></code></pre></div>
<p>Pour r√©aliser le graphique, on indiquera le nombre de classes et les couleurs √† utiliser pour chaque branche de l‚Äôarbre¬†:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">A2Rplot</span>(arbre, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">boxes =</span> <span class="cn">FALSE</span>, <span class="at">col.up =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">col.down =</span> <span class="fu">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Dark2&quot;</span>), <span class="at">show.labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div class="note">
<p>Pour plus d‚Äôoptions graphiques concernant les dendrogrammes en g√©n√©ral, on pourra se r√©f√©rer √† l‚Äôextension <code class="pkg">dendextend</code> : <a href="https://talgalili.github.io/dendextend/" class="uri">https://talgalili.github.io/dendextend/</a>.</p>
</div>
</div>
<div id="caract√©riser-la-typologie" class="section level2 hasAnchor">
<h2 class="hasAnchor">Caract√©riser la typologie<a href="#caract√©riser-la-typologie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Reste le travail le plus important (et parfois le plus difficile) qui consiste √† cat√©goriser la typologie obtenue et le cas √©ch√©ant √† nommer les classes.</p>
<p>En premier lieu, on peut croiser la typologie obtenue avec les diff√©rentes variables inclues dans l‚ÄôACM. Le plus simple est d‚Äôavoir recours √† <code data-pkg="gtsummary">tbl_summary</code> de <code class="pkg">gtsummary</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by =</span> typo)</span></code></pre></div>
<div id="jwfpsyznlw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jwfpsyznlw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jwfpsyznlw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jwfpsyznlw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jwfpsyznlw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jwfpsyznlw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jwfpsyznlw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jwfpsyznlw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jwfpsyznlw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jwfpsyznlw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jwfpsyznlw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jwfpsyznlw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jwfpsyznlw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jwfpsyznlw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jwfpsyznlw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jwfpsyznlw .gt_from_md > :first-child {
  margin-top: 0;
}

#jwfpsyznlw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jwfpsyznlw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jwfpsyznlw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jwfpsyznlw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jwfpsyznlw .gt_row_group_first td {
  border-top-width: 2px;
}

#jwfpsyznlw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwfpsyznlw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jwfpsyznlw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jwfpsyznlw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jwfpsyznlw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwfpsyznlw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jwfpsyznlw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jwfpsyznlw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jwfpsyznlw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jwfpsyznlw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwfpsyznlw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jwfpsyznlw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwfpsyznlw .gt_left {
  text-align: left;
}

#jwfpsyznlw .gt_center {
  text-align: center;
}

#jwfpsyznlw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jwfpsyznlw .gt_font_normal {
  font-weight: normal;
}

#jwfpsyznlw .gt_font_bold {
  font-weight: bold;
}

#jwfpsyznlw .gt_font_italic {
  font-style: italic;
}

#jwfpsyznlw .gt_super {
  font-size: 65%;
}

#jwfpsyznlw .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jwfpsyznlw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jwfpsyznlw .gt_indent_1 {
  text-indent: 5px;
}

#jwfpsyznlw .gt_indent_2 {
  text-indent: 10px;
}

#jwfpsyznlw .gt_indent_3 {
  text-indent: 15px;
}

#jwfpsyznlw .gt_indent_4 {
  text-indent: 20px;
}

#jwfpsyznlw .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;1&lt;/strong&gt;, N = 1,031&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;"><strong>1</strong>, N = 1,031<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;2&lt;/strong&gt;, N = 164&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;"><strong>2</strong>, N = 164<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;3&lt;/strong&gt;, N = 553&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;"><strong>3</strong>, N = 553<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;4&lt;/strong&gt;, N = 205&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;"><strong>4</strong>, N = 205<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;5&lt;/strong&gt;, N = 47&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;"><strong>5</strong>, N = 47<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">grpage</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†[16,25)</td>
<td headers="stat_1" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_2" class="gt_row gt_center">164 (100%)</td>
<td headers="stat_3" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_4" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_5" class="gt_row gt_center">5 (11%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†[25,45)</td>
<td headers="stat_1" class="gt_row gt_center">590 (57%)</td>
<td headers="stat_2" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_3" class="gt_row gt_center">20 (3.6%)</td>
<td headers="stat_4" class="gt_row gt_center">80 (39%)</td>
<td headers="stat_5" class="gt_row gt_center">16 (34%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†[45,65)</td>
<td headers="stat_1" class="gt_row gt_center">441 (43%)</td>
<td headers="stat_2" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_3" class="gt_row gt_center">185 (34%)</td>
<td headers="stat_4" class="gt_row gt_center">97 (47%)</td>
<td headers="stat_5" class="gt_row gt_center">22 (47%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†[65,93]</td>
<td headers="stat_1" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_2" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_3" class="gt_row gt_center">346 (63%)</td>
<td headers="stat_4" class="gt_row gt_center">28 (14%)</td>
<td headers="stat_5" class="gt_row gt_center">4 (8.5%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Unknown</td>
<td headers="stat_1" class="gt_row gt_center">0</td>
<td headers="stat_2" class="gt_row gt_center">0</td>
<td headers="stat_3" class="gt_row gt_center">2</td>
<td headers="stat_4" class="gt_row gt_center">0</td>
<td headers="stat_5" class="gt_row gt_center">0</td></tr>
    <tr><td headers="label" class="gt_row gt_left">sexe</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Homme</td>
<td headers="stat_1" class="gt_row gt_center">429 (42%)</td>
<td headers="stat_2" class="gt_row gt_center">74 (45%)</td>
<td headers="stat_3" class="gt_row gt_center">220 (40%)</td>
<td headers="stat_4" class="gt_row gt_center">161 (79%)</td>
<td headers="stat_5" class="gt_row gt_center">15 (32%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Femme</td>
<td headers="stat_1" class="gt_row gt_center">602 (58%)</td>
<td headers="stat_2" class="gt_row gt_center">90 (55%)</td>
<td headers="stat_3" class="gt_row gt_center">333 (60%)</td>
<td headers="stat_4" class="gt_row gt_center">44 (21%)</td>
<td headers="stat_5" class="gt_row gt_center">32 (68%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">etud</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Primaire</td>
<td headers="stat_1" class="gt_row gt_center">7 (0.7%)</td>
<td headers="stat_2" class="gt_row gt_center">1 (1.3%)</td>
<td headers="stat_3" class="gt_row gt_center">402 (73%)</td>
<td headers="stat_4" class="gt_row gt_center">50 (25%)</td>
<td headers="stat_5" class="gt_row gt_center">6 (14%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Secondaire</td>
<td headers="stat_1" class="gt_row gt_center">267 (26%)</td>
<td headers="stat_2" class="gt_row gt_center">15 (19%)</td>
<td headers="stat_3" class="gt_row gt_center">65 (12%)</td>
<td headers="stat_4" class="gt_row gt_center">35 (17%)</td>
<td headers="stat_5" class="gt_row gt_center">5 (12%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Technique/Professionnel</td>
<td headers="stat_1" class="gt_row gt_center">406 (40%)</td>
<td headers="stat_2" class="gt_row gt_center">48 (62%)</td>
<td headers="stat_3" class="gt_row gt_center">48 (8.7%)</td>
<td headers="stat_4" class="gt_row gt_center">87 (43%)</td>
<td headers="stat_5" class="gt_row gt_center">5 (12%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Sup√©rieur</td>
<td headers="stat_1" class="gt_row gt_center">334 (33%)</td>
<td headers="stat_2" class="gt_row gt_center">14 (18%)</td>
<td headers="stat_3" class="gt_row gt_center">36 (6.5%)</td>
<td headers="stat_4" class="gt_row gt_center">30 (15%)</td>
<td headers="stat_5" class="gt_row gt_center">27 (63%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Unknown</td>
<td headers="stat_1" class="gt_row gt_center">17</td>
<td headers="stat_2" class="gt_row gt_center">86</td>
<td headers="stat_3" class="gt_row gt_center">2</td>
<td headers="stat_4" class="gt_row gt_center">3</td>
<td headers="stat_5" class="gt_row gt_center">4</td></tr>
    <tr><td headers="label" class="gt_row gt_left">peche.chasse</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Non</td>
<td headers="stat_1" class="gt_row gt_center">1,030 (100%)</td>
<td headers="stat_2" class="gt_row gt_center">151 (92%)</td>
<td headers="stat_3" class="gt_row gt_center">553 (100%)</td>
<td headers="stat_4" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_5" class="gt_row gt_center">42 (89%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Oui</td>
<td headers="stat_1" class="gt_row gt_center">1 (&lt;0.1%)</td>
<td headers="stat_2" class="gt_row gt_center">13 (7.9%)</td>
<td headers="stat_3" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_4" class="gt_row gt_center">205 (100%)</td>
<td headers="stat_5" class="gt_row gt_center">5 (11%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">cinema</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Non</td>
<td headers="stat_1" class="gt_row gt_center">497 (48%)</td>
<td headers="stat_2" class="gt_row gt_center">32 (20%)</td>
<td headers="stat_3" class="gt_row gt_center">486 (88%)</td>
<td headers="stat_4" class="gt_row gt_center">141 (69%)</td>
<td headers="stat_5" class="gt_row gt_center">18 (38%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Oui</td>
<td headers="stat_1" class="gt_row gt_center">534 (52%)</td>
<td headers="stat_2" class="gt_row gt_center">132 (80%)</td>
<td headers="stat_3" class="gt_row gt_center">67 (12%)</td>
<td headers="stat_4" class="gt_row gt_center">64 (31%)</td>
<td headers="stat_5" class="gt_row gt_center">29 (62%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">cuisine</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Non</td>
<td headers="stat_1" class="gt_row gt_center">539 (52%)</td>
<td headers="stat_2" class="gt_row gt_center">85 (52%)</td>
<td headers="stat_3" class="gt_row gt_center">361 (65%)</td>
<td headers="stat_4" class="gt_row gt_center">111 (54%)</td>
<td headers="stat_5" class="gt_row gt_center">23 (49%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Oui</td>
<td headers="stat_1" class="gt_row gt_center">492 (48%)</td>
<td headers="stat_2" class="gt_row gt_center">79 (48%)</td>
<td headers="stat_3" class="gt_row gt_center">192 (35%)</td>
<td headers="stat_4" class="gt_row gt_center">94 (46%)</td>
<td headers="stat_5" class="gt_row gt_center">24 (51%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">bricol</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Non</td>
<td headers="stat_1" class="gt_row gt_center">537 (52%)</td>
<td headers="stat_2" class="gt_row gt_center">103 (63%)</td>
<td headers="stat_3" class="gt_row gt_center">397 (72%)</td>
<td headers="stat_4" class="gt_row gt_center">89 (43%)</td>
<td headers="stat_5" class="gt_row gt_center">21 (45%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Oui</td>
<td headers="stat_1" class="gt_row gt_center">494 (48%)</td>
<td headers="stat_2" class="gt_row gt_center">61 (37%)</td>
<td headers="stat_3" class="gt_row gt_center">156 (28%)</td>
<td headers="stat_4" class="gt_row gt_center">116 (57%)</td>
<td headers="stat_5" class="gt_row gt_center">26 (55%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">sport</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Non</td>
<td headers="stat_1" class="gt_row gt_center">588 (57%)</td>
<td headers="stat_2" class="gt_row gt_center">57 (35%)</td>
<td headers="stat_3" class="gt_row gt_center">479 (87%)</td>
<td headers="stat_4" class="gt_row gt_center">130 (63%)</td>
<td headers="stat_5" class="gt_row gt_center">23 (49%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Oui</td>
<td headers="stat_1" class="gt_row gt_center">443 (43%)</td>
<td headers="stat_2" class="gt_row gt_center">107 (65%)</td>
<td headers="stat_3" class="gt_row gt_center">74 (13%)</td>
<td headers="stat_4" class="gt_row gt_center">75 (37%)</td>
<td headers="stat_5" class="gt_row gt_center">24 (51%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">lecture.bd</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_3" class="gt_row gt_center"></td>
<td headers="stat_4" class="gt_row gt_center"></td>
<td headers="stat_5" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Non</td>
<td headers="stat_1" class="gt_row gt_center">1,031 (100%)</td>
<td headers="stat_2" class="gt_row gt_center">164 (100%)</td>
<td headers="stat_3" class="gt_row gt_center">553 (100%)</td>
<td headers="stat_4" class="gt_row gt_center">205 (100%)</td>
<td headers="stat_5" class="gt_row gt_center">0 (0%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">¬†¬†¬†¬†Oui</td>
<td headers="stat_1" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_2" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_3" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_4" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_5" class="gt_row gt_center">47 (100%)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><sup class="gt_footnote_marks">1</sup> n (%)</td>
    </tr>
  </tfoot>
</table>
</div>
<p>On peut √©galement avoir recours √† <code data-pkg="GGally">ggtable</code> de <code class="pkg">GGally</code> pour repr√©senter les r√©sidus du Chi¬≤ et mieux rep√©rer les diff√©rences.</p>
<figure>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>typo <span class="ot">&lt;-</span> <span class="fu">factor</span>(d2<span class="sc">$</span>typo)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtable</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  d2, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnsX =</span> <span class="st">&quot;typo&quot;</span>, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnsY =</span> <span class="fu">names</span>(d2)[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>],</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cells =</span> <span class="st">&quot;col.prop&quot;</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">&quot;std.resid&quot;</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;R√©sidus standardiz√©s du Chi¬≤&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<pre><code>Warning in chisq.test(xtabs(weight ~ y + x, data = data)):
L‚Äôapproximation du Chi-2 est peut-√™tre incorrecte

Warning in chisq.test(xtabs(weight ~ y + x, data = data)):
L‚Äôapproximation du Chi-2 est peut-√™tre incorrecte

Warning in chisq.test(xtabs(weight ~ y + x, data = data)):
L‚Äôapproximation du Chi-2 est peut-√™tre incorrecte

Warning in chisq.test(xtabs(weight ~ y + x, data = data)):
L‚Äôapproximation du Chi-2 est peut-√™tre incorrecte

Warning in chisq.test(xtabs(weight ~ y + x, data = data)):
L‚Äôapproximation du Chi-2 est peut-√™tre incorrecte

Warning in chisq.test(xtabs(weight ~ y + x, data = data)):
L‚Äôapproximation du Chi-2 est peut-√™tre incorrecte</code></pre>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-28-1.png" width="768" />
<figcaption>
R√©sidus du Chi¬≤
</figcaption>
</figure>
</div>
<div id="factominer" class="section level2 hasAnchor">
<h2 class="hasAnchor">CAH avec l‚Äôextension FactoMineR<a href="#factominer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L‚Äôextension <code class="pkg">FactoMineR</code> fournit une fonction <code data-pkg="FactoMineR">HCPC</code> permettant de r√©aliser une classification hi√©rarchique √† partir du r√©sultats d‚Äôune analyse factorielle r√©alis√©e avec la m√™me extension (voir la <a href="#factominer">section d√©di√©e du chapitre sur l‚ÄôACM</a>).</p>
<p><code data-pkg="FactoMineR">HCPC</code> r√©alise √† la fois le calcul de la matrice des distances, du dendrogramme et le partitionnement de la population en classes. Par d√©faut, <code data-pkg="FactoMineR">HCPC</code> calcule le dendrogramme √† partir du carr√© des distances du Œ¶¬≤ et avec la m√©thode de Ward.</p>
<p>Par d√©faut, l‚Äôarbre est affich√© √† l‚Äô√©cran et l‚Äôarbre sera coup√© selon la partition ayant la plus grande perte relative d‚Äôinertie (comme avec <code data-pkg="JLutils">best.cutree</code>). Utilisez <code>graph=FALSE</code> pour ne pas afficher le graphique et l‚Äôargument <code>nb.clust</code> pour indiquer le nombre de classes d√©sir√©es.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>acm2 <span class="ot">&lt;-</span> <span class="fu">MCA</span>(d2[<span class="fu">complete.cases</span>(d2), ], <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>cah <span class="ot">&lt;-</span> <span class="fu">HCPC</span>(acm2, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>On pourra repr√©senter le dendrogramme avec <code data-pkg="FactoMineR" data-rdoc="plot.HCPC">plot</code> et l‚Äôargument <code>choice="tree"</code>.</p>
<figure>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cah, <span class="at">choice =</span> <span class="st">&quot;tree&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-30-1.png" width="672" />
<figcaption>
Dendrogramme obtenu avec HCPC (5 axes)
</figcaption>
</figure>
<p>Il apparait que le dendrogramme obtenu avec <code data-pacakge="FactoMineR">HCPC</code> diff√®re de celui que nous avons calcul√© pr√©c√©demment en utilisant la matrice des distances fournies par <code data-pkg="ade4">dist.dudi</code>. Cela est d√ª au fait que <code data-pkg="FactoMineR">HCPC</code> proc√®de diff√©rement pour calculer la matrice des distances en ne prenant en compte que les axes retenus dans le cadre de l‚ÄôACM. Pour rappel, nous avions retenu que 5 axes dans le cadre de notre ACM¬†:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>acm2 <span class="ot">&lt;-</span> <span class="fu">MCA</span>(d2[<span class="fu">complete.cases</span>(d2), ], <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><code data-pkg="FactoMineR">HCPC</code> n‚Äôa donc pris en compte que ces 5 premiers axes pour calculer les distances entre les individus, consid√©rant que les autres axes n‚Äôapportent que du ¬´¬†bruit¬†¬ª rendant la classification instable. Cependant, comme le montre <code>summary(acm2)</code>, nos cinq premiers axes n‚Äôexpliquent que 54¬†% de la variance. Il usuellement pr√©f√©rable de garder un plus grande nombre d‚Äôaxes afin de couvrir au moins 80 √† 90¬†% de la variance<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>. De son c√¥t√©, <code data-pkg="ade4">dist.dudi</code> prends en compte l‚Äôensemble des axes pour calculer la matrice des distances. On peut reproduire cela avec <code class="pkg">FactoMineR</code> en indiquant <code>ncp=Inf</code> lors du calcul de l‚ÄôACM.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>acm2 <span class="ot">&lt;-</span> <span class="fu">MCA</span>(d2[<span class="fu">complete.cases</span>(d2), ], <span class="at">ncp =</span> <span class="cn">Inf</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cah <span class="ot">&lt;-</span> <span class="fu">HCPC</span>(acm2, <span class="at">nb.clust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>On obtient bien cette fois-ci le m√™me r√©sultat.</p>
<figure>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cah, <span class="at">choice =</span> <span class="st">&quot;tree&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-33-1.png" width="672" />
<figcaption>
Dendrogramme obtenu avec HCPC (tous les axes)
</figcaption>
</figure>
<p>D‚Äôautres graphiques sont disponibles, en faisant varier la valeur de l‚Äôargument <code>choice</code>¬†:</p>
<figure>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cah, <span class="at">choice =</span> <span class="st">&quot;3D.map&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-34-1.png" width="672" />
<figcaption>
Repr√©sentation en 3 dimensions du dendrogramme
</figcaption>
</figure>
<figure>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cah, <span class="at">choice =</span> <span class="st">&quot;bar&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-35-1.png" width="672" />
<figcaption>
Gains d‚Äôinertie
</figcaption>
</figure>
<figure>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cah, <span class="at">choice =</span> <span class="st">&quot;map&quot;</span>)</span></code></pre></div>
<img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-36-1.png" width="672" />
<figcaption>
Projection des cat√©gories sur le plan factoriel
</figcaption>
</figure>
<p>L‚Äôobjet renvoy√© par <code data-pkg="FactoMineR">HCPC</code> contient de nombreuses informations. La partition peut notamment √™tre r√©cup√©r√©e avec <code>cah$data.clust$clust</code>. Il y a √©galement diverses statistiques pour d√©crire les cat√©gories.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>cah</span></code></pre></div>
<pre><code>**Results for the Hierarchical Clustering on Principal Components**
   name                   
1  &quot;$data.clust&quot;          
2  &quot;$desc.var&quot;            
3  &quot;$desc.var$test.chi2&quot;  
4  &quot;$desc.axes$category&quot;  
5  &quot;$desc.axes&quot;           
6  &quot;$desc.axes$quanti.var&quot;
7  &quot;$desc.axes$quanti&quot;    
8  &quot;$desc.ind&quot;            
9  &quot;$desc.ind$para&quot;       
10 &quot;$desc.ind$dist&quot;       
11 &quot;$call&quot;                
12 &quot;$call$t&quot;              
   description                                              
1  &quot;dataset with the cluster of the individuals&quot;            
2  &quot;description of the clusters by the variables&quot;           
3  &quot;description of the cluster var. by the categorical var.&quot;
4  &quot;description of the clusters by the categories.&quot;         
5  &quot;description of the clusters by the dimensions&quot;          
6  &quot;description of the cluster var. by the axes&quot;            
7  &quot;description of the clusters by the axes&quot;                
8  &quot;description of the clusters by the individuals&quot;         
9  &quot;parangons of each clusters&quot;                             
10 &quot;specific individuals&quot;                                   
11 &quot;summary statistics&quot;                                     
12 &quot;description of the tree&quot;                                </code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(cah<span class="sc">$</span>data.clust<span class="sc">$</span>clust)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"549","2":"29.1","3":"29.1","_rn_":"1"},{"1":"202","2":"10.7","3":"10.7","_rn_":"2"},{"1":"1014","2":"53.8","3":"53.8","_rn_":"3"},{"1":"43","2":"2.3","3":"2.3","_rn_":"4"},{"1":"78","2":"4.1","3":"4.1","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Pour une pr√©sentation de ces diff√©rentes distances, on pourra se r√©f√©rer √† <a href="http://old.biodiversite.wallonie.be/outils/methodo/similarite_distance.htm" class="uri">http://old.biodiversite.wallonie.be/outils/methodo/similarite_distance.htm</a> ou encore √† ce support de cours par D. Chessel, J. Thioulouse et A.B. Dufour disponible √† <a href="http://pbil.univ-lyon1.fr/R/pdf/stage7.pdf" class="uri">http://pbil.univ-lyon1.fr/R/pdf/stage7.pdf</a>.<a href="#fnref1" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p>Cette m√™me fonction peut aussi √™tre utilis√©e pour calculer une distance apr√®s une analyse en composantes principales ou une analyse mixte de Hill et Smith.<a href="#fnref2" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn3"><p>Voir Gower, J. (1971). A General Coefficient of Similarity and Some of Its Properties. <em>Biometrics</em>, 27(4), 857-871. <a href="doi:10.2307/2528823" class="uri">doi:10.2307/2528823</a> (<a href="http://www.jstor.org/stable/2528823" class="uri">http://www.jstor.org/stable/2528823</a>).<a href="#fnref3" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn4"><p>Pour une description math√©matique plus d√©taill√©e de cette fonction, notamment en cas de valeur manquante, se r√©f√©rer √† l‚Äôarticle original de Gower pr√©c√©demment cit√©.<a href="#fnref4" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn5"><p>On pourra consulter le cours de FG Carpentier d√©j√† cit√© ou bien des ouvrages d‚Äôanalyse statistique.<a href="#fnref5" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn6"><p>Ward, J. (1963). Hierarchical Grouping to Optimize an Objective Function. <em>Journal of the American Statistical Association</em>, 58(301), 236-244. <a href="doi:10.2307/2282967" class="uri">doi:10.2307/2282967</a>. (<a href="http://www.jstor.org/stable/2282967" class="uri">http://www.jstor.org/stable/2282967</a>)<a href="#fnref6" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn7"><p>Voir par exemple la discussion, en anglais, sur Wikipedia concernant la page pr√©sentant la m√©thode Ward¬†: <a href="https://en.wikipedia.org/wiki/Talk:Ward%27s_method" class="uri">https://en.wikipedia.org/wiki/Talk:Ward%27s_method</a><a href="#fnref7" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn8"><p>Depuis la version 3.1 de <strong>R</strong>. L‚Äôoption <code>method = "ward.D"</code> correspondant √† la version disponible dans les versions pr√©c√©dentes de <strong>R</strong>. Mais il est √† noter que la m√©thode d√©crite par Ward dans son article de 1963 correspond en r√©alit√© √† <code>method = "ward.D2</code>.<a href="#fnref8" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn9"><p>Voir <a href="http://addicted2or.free.fr/packages/A2R/lastVersion/R/code.R" class="uri">http://addicted2or.free.fr/packages/A2R/lastVersion/R/code.R</a>.<a href="#fnref9" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn10"><p>Voir <a href="http://factominer.free.fr/classical-methods/classification-hierarchique-sur-composantes-principales.html" class="uri">http://factominer.free.fr/classical-methods/classification-hierarchique-sur-composantes-principales.html</a><a href="#fnref10" class="footnote-back">‚Ü©Ô∏é</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // √©largir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package¬†: ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copi√© !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
-->

<!-- Giscus comments -->
<script src="https://giscus.app/client.js"
        data-repo="larmarange/analyse-R"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzNDk4NjY2Ng=="
        data-category-id="DIC_kwDOAhXaqs4B_iH_"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="light"
        data-lang="fr"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires g√©r√©s avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont h√©berg√©s par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d‚Äôutilisation commerciale - Partage dans les m√™mes conditions</a>.<br />
      Propuls√© par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. H√©berg√© par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
