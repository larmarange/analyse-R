<!DOCTYPE html>

<html lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Vectorisation (dont purrr)</title>

<script src="libs/header-attrs-2.16/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnees.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <li><a href="scraping.html">Scraping</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe avec <strong>survey</strong></a></li>
                  <li><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="gtsummary.html">Tableaux statistiques avancés avec <strong>gtsummary</strong></a></li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="modeles.html">Quel type de modèles choisir ?</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Modèles à effets aléatoires (modèles mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de données longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
                  <li><a href="analyse-textuelle.html">Analyse textuelle</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">Étendre <strong>ggplot2</strong></a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="exemples-graphiques-avances.html">Exemples de graphiques avancés</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
                  <li><a href="autres-extensions-graphiques.html">Autres extensions graphiques</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation (dont <strong>purrr</strong>)</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres avec <strong>scales</strong></a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations mathématiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <li><a href="https://github.com/larmarange/guide-R/">guide-R</a></li>
        <li><a href="https://larmarange.github.io/webin-R/">webin-R</a></li>
        <li><a href="https://www.youtube.com/c/webinR"><i class="fa fa-youtube" aria-hidden="true"></i></a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div id="header">



<h1 class="title toc-ignore">Vectorisation (dont purrr)</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#les-fonctions-de-lextension-purrr" id="toc-les-fonctions-de-lextension-purrr">Les fonctions de l’extension purrr<span></span></a></li>
<li><a href="#les-fonctions-de-lextension-plyr" id="toc-les-fonctions-de-lextension-plyr">Les fonctions de l’extension plyr<span></span></a>
<ul>
<li><a href="#array-en-input-aply" id="toc-array-en-input-aply">Array en input : <code>a*ply</code><span></span></a></li>
<li><a href="#data.frame-en-input-dply" id="toc-data.frame-en-input-dply">Data.frame en input : <code>d*ply</code><span></span></a></li>
<li><a href="#list-en-input-lply" id="toc-list-en-input-lply">List en input : <code>l*ply</code><span></span></a></li>
<li><a href="#calcul-parallèle" id="toc-calcul-parallèle">Calcul parallèle<span></span></a></li>
</ul></li>
<li><a href="#les-fonctions-de-la-famille-apply-du-package-base" id="toc-les-fonctions-de-la-famille-apply-du-package-base">Les fonctions de la famille apply du package base<span></span></a>
<ul>
<li><a href="#la-fonction-lapply" id="toc-la-fonction-lapply">La fonction lapply<span></span></a></li>
<li><a href="#la-fonction-sapply" id="toc-la-fonction-sapply">La fonction sapply<span></span></a></li>
<li><a href="#la-fonction-vapply" id="toc-la-fonction-vapply">La fonction vapply<span></span></a></li>
<li><a href="#la-fonction-apply" id="toc-la-fonction-apply">La fonction apply<span></span></a></li>
<li><a href="#la-fonction-tapply" id="toc-la-fonction-tapply">La fonction tapply<span></span></a></li>
<li><a href="#la-fonction-mapply" id="toc-la-fonction-mapply">La fonction mapply<span></span></a></li>
</ul></li>
<li><a href="#la-fonction-vectorize" id="toc-la-fonction-vectorize">La fonction Vectorize<span></span></a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Ewen Gallic dans le cadre de son support de cours d’Ewen Gallic intitulé <a href="http://egallic.fr/Enseignement/R/m1_stat_eco_logiciel_R.pdf">Logiciel R et programmation</a>, chapitre 4 <q>Boucles et calculs vectoriels</q>.</p>
</div>
<p>Les <a href="structures-conditionnelles.html">boucles</a> sont des opérations lentes en <strong>R</strong>. Il est cependant possible, dans de nombreux cas, d’éviter de les employer, en ayant recours à la vectorisation : au lieu d’appliquer une fonction à un scalaire, on l’applique à un vecteur. En fait, nous avons déjà eu recours à maintes reprises aux calculs vectoriels. En effet, lorsque nous avons procédé à des additions, des multiplications, etc. sur des vecteurs, nous avons effectué des calculs vectoriels.</p>
<p>Empruntons un exemple à Burns (2011) : dans des langages comme le <strong>C</strong>, pour effectuer la somme des logarithmes naturels des n premiers entiers, voici une manière de faire :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Somme des logarithmes des 10 premiers entiers</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>somme_log <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="dv">10</span>)){</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  somme_log <span class="ot">&lt;-</span> somme_log <span class="sc">+</span> <span class="fu">log</span>(i)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>somme_log</span></code></pre></div>
<p>Il est possible d’obtenir le même résultat, à la fois d’une manière plus élégante, mais surtout plus efficace en vectorisant le calcul :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">seq_len</span>(<span class="dv">10</span>)))</span></code></pre></div>
<p>Derrière ce code, la fonction <code data-pkg="base">log</code> applique la fonction logarithme sur toutes les valeurs du vecteur donné en paramètre. La fonction <code data-pkg="base">sum</code>, quant à elle, se charge d’additionner tous les éléments du vecteur qui lui est donné en paramètre. Ces deux fonctions utilisent la vectorisation, mais d’une manière différente : la fonction <code data-pkg="base">log</code> applique une opération à chaque élément d’un vecteur, tandis que la fonction <code data-pkg="base">sum</code> produit un résultat basé sur l’ensemble du vecteur. L’avantage d’utiliser des fonctions vectorielles plutôt que d’écrire une boucle pour effectuer le calcul, est que ces premières font appel à des fonctions rédigées en <strong>C</strong> ou <strong>FORTRAN</strong>, qui utilisent aussi des boucles, mais comme ce sont des langages compilés et non pas interprétés, les itérations sont réalisées dans un temps réduit.</p>
<p>Il existe des fonctions, rédigées en <strong>C</strong> qui effectuent des boucles <code>for</code>. On leur donne souvent le nom de “fonctions de la famille apply”. Il ne s’agit pas de la vectorisation, mais ces fonctions sont souvent mentionnées dès que l’on parle de ce sujet. Ce sont des fonctionnelles qui prennent une fonction en input et retournent un vecteur en output (Wickham, 2014). Ces fonctions sont très utilisées, mais elles souffrent d’un manque d’uniformité. En effet, elles ont été rédigées par des personnes différentes, ayant chacune leur convention. L’extension <code class="pkg">plyr</code> remédie à ce problème, et ajoute par la même occasion des fonctions supplémentaires, pour couvrir plus de cas que les “fonctions de la famille apply”.</p>
<p>Nous allons donc présenter dans un premier temps les fonctions du package <code class="pkg">plyr</code>. Les fonctions du même type du package <code class="pkg">base</code> seront tout de même présentées par la suite.</p>
<div id="les-fonctions-de-lextension-purrr" class="section level2 hasAnchor">
<h2 class="hasAnchor">Les fonctions de l’extension purrr<a href="#les-fonctions-de-lextension-purrr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’extension <code class="pkg">purrr</code> du <em>tidyverse</em> a beaucoup évolué ces dernières années et permet d’itérer facilement des opérations sur une liste ou un tableau. Cette extension s’articule également avec les tableaux imbriqués rendus possibles par <code class="pkg">tibble</code> et <code class="pkg">tidyr</code> (voir la fonction <code data-pkg="tidyr">nest</code> et sa vignette dédiée : <a href="https://tidyr.tidyverse.org/articles/nest.html" class="uri">https://tidyr.tidyverse.org/articles/nest.html</a>).</p>
<p>Concernant <code class="pkg">purrr</code>, on pourra consulter le chapitre <a href="https://juba.github.io/tidyverse/18-purrr.html">Itérer avec purrr</a> de l’excellente <em>Introduction à R et au tidyverse</em> de Julien Barnier (<a href="https://juba.github.io/tidyverse" class="uri">https://juba.github.io/tidyverse</a>).</p>
<p>Julien Barnier y aborde notamment la fonction <code data-pkg="purrr">map</code> et ses variantes comme <code data-pkg="purrr">map_dbl</code>, <code data-pkg="purrr">map_chr</code>, <code data-pkg="purrr">map_int</code>, <code data-pkg="purrr">map_dfr</code>, <code data-pkg="purrr">map_dfc</code>, <code data-pkg="purrr">modify</code>, <code data-pkg="purrr">imap</code>, <code data-pkg="purrr">walk</code>…</p>
</div>
<div id="les-fonctions-de-lextension-plyr" class="section level2 hasAnchor">
<h2 class="hasAnchor">Les fonctions de l’extension plyr<a href="#les-fonctions-de-lextension-plyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Les fonctions que nous allons aborder dans cette section possèdent des noms faciles à se remémorer : la première lettre correspond au format d’entrée des données, la seconde au format de sortie souhaité, et la fin du nom se termine par le suffixe <code>ply</code>. Ainsi, la fonction <code data-pkg="plyr">llpply</code> prend en entrée une liste, effectue une opération sur les éléments, et retourne une liste (Anderson, 2012).</p>
<p>Les différentes fonctions que nous allons passer en revue sont consignées dans le tableau ci-après, où les lignes correspondent aux formats d’entrée, et les lignes aux formats de sortie. Pour y avoir accès, il faut charger le package :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code></pre></div>
<p>Il est possible d’avoir plusieurs paramètres en input au lieu d’un seul objet. Les fonctions <code data-pkg="plyr">mlply</code>, <code data-pkg="plyr">mdply</code> et <code data-pkg="plyr">maply</code>. Si à la place du <code>m</code>, la première lettre est un <code>r</code>, il s’agit alors de fonction de réplications. Enfin, si la seconde lettre est un trait de soulignement (<code>_</code>), alors le résultat retourné n’est pas affiché (le code utilise la fonction <code data-pkg="base">invisible</code>.</p>
<p>Tous les paramètres de ces fonctions commencent par un point (<code>.</code>), afin d’éviter des incompatibilités avec la fonction à appliquer.</p>
<div id="array-en-input-aply" class="section level3 hasAnchor">
<h3 class="hasAnchor">Array en input : <code>a*ply</code><a href="#array-en-input-aply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les fonctions <code data-pkg="plyr">aaply</code>, <code data-pkg="plyr">adply</code> et <code data-pkg="plyr">alply</code> appliquent une fonction à chaque portion d’un <em>array</em> et ensuitent joignent le résultat sous forme d’un <em>array</em>, d’un <em>data.frame</em> ou d’une <em>list</em> respectivement.</p>
<div class="note">
<p>Un <code data-pkg="base">array</code> peut être vu comme un vecteur à plusieurs dimensions. Comme pour un vecteur, toutes les valeurs doivent être du même type. Un vecteur n’est finalement qu’un <em>array</em> à une seule dimension. De même, un <em>array</em> à deux dimensions correspond à ce qu’on appelle usuelement une matrice.</p>
</div>
<p>Le paramètre <code>.margins</code> détermine la manière de découper le tableau. Il y en a quatre pour un tableau en deux dimensions :</p>
<ol style="list-style-type: decimal">
<li><code>.margins = 1</code> : par lignes ;</li>
<li><code>.margins = 2</code> : par colonnes ;</li>
<li><code>.margins = c(1,2)</code> : par cellule ;</li>
<li><code>.margins = c()</code> : ne pas faire de découpement.</li>
</ol>
<p>Pour un tableau en trois dimensions, il y a trois découpages possibles en deux dimensions, trois en une dimension et une en zéro dimension (voir (Wickham, 2011)) au besoin.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">array</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ligne =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colonne =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">annee =</span> <span class="dv">2001</span><span class="sc">:</span><span class="dv">2002</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>tableau</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># La moyenne des valeurs pour chaque ligne</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">aaply</span>(tableau, <span class="dv">1</span>, mean) <span class="co"># résultat sous forme de tableau</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">adply</span>(tableau, <span class="dv">1</span>, mean) <span class="co"># résultat sous forme de data.frame</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">alply</span>(tableau, <span class="dv">1</span>, mean) <span class="co"># résultat sous forme de liste</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># La moyenne des valeurs pour chaque colonne</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># en ne simplifiant pas le résultat</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">aaply</span>(tableau, <span class="dv">2</span>, mean, <span class="at">.drop =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Par lignes et colonnes</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">aaply</span>(tableau, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), mean)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">adply</span>(tableau, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), mean)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec une fonction définie par l&#39;utilisateur</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>standardise <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardiser les valeurs par colonne</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="fu">aaply</span>(tableau, <span class="dv">2</span>, standardise)</span></code></pre></div>
</div>
<div id="data.frame-en-input-dply" class="section level3 hasAnchor">
<h3 class="hasAnchor">Data.frame en input : <code>d*ply</code><a href="#data.frame-en-input-dply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans le cas de l’analyse d’enquêtes, on utilise principalement des tableaux de données ou <em>data.frame</em>. Aussi, la connaissance des fonction <code data-pkg="plyr">daply</code>, <code data-pkg="plyr">ddply</code> et <code data-pkg="plyr">dlply</code> peut être utile. En effet, elles sont très utiles pour appliquer des fonctions à des groupes basés sur des combinaisons de variables, même si dans la majorité des cas il est maintenant plus facile de passer par les extensions <code class="pkg">dplyr</code> ou <code class="pkg">data.table</code> avec les opérations groupées (voir la section sur <a href="manipuler-les-donnees-avec-dplyr.html#operations-groupees">groub_by de dplyr</a> ou encore celle sur le <a href="manipulations-avancees-avec-data-table.html#grouper-les-resultats">paramètre by de data.table</a>.</p>
<p>Avec les fonctions <code>d*ply</code>, il est nécessaire d’indiquer quelles variables, ou fonctions de variables on souhaite utiliser, en l’indiquant au paramètre <code>.variables</code>. Elles peuvent être contenue dans le data frame fourni au paramètre <code>.data</code>, ou bien provenir de l’environnement global. <strong>R</strong> cherchera dans un premier temps si la variable est contenue dans le <em>data.frame</em> et, s’il ne trouve pas, ira chercher dans l’environnement global.</p>
<p>Pour indiquer que l’on désire faire le regroupement selon une variable – mettons <code>variable_1</code> – il faudra fournir l’expression <code>.(variable_1)</code> au paramètre <code>.variables</code>. Si on souhaite effectuer les regroupement selon les interactions de plusieurs variables – <code>variable_1</code>, <code>variable_2</code> et <code>variable_3</code>, il faut alors utiliser l’expression suivante : <code>.(variable_1, variable_2, variable_3)</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>chomage <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Bretagne&quot;</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;Corse&quot;</span>, <span class="dv">2</span>)), <span class="dv">2</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">departement =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Cotes-d&#39;Armor&quot;</span>, <span class="st">&quot;Finistere&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Ille-et-Vilaine&quot;</span>, <span class="st">&quot;Morbihan&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Corse-du-Sud&quot;</span>, <span class="st">&quot;Haute-Corse&quot;</span>), <span class="dv">2</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">annee =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2011</span>, <span class="dv">2010</span>), <span class="at">each =</span> <span class="dv">6</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ouvriers =</span> <span class="fu">c</span>(<span class="dv">8738</span>, <span class="dv">12701</span>, <span class="dv">11390</span>, <span class="dv">10228</span>, <span class="dv">975</span>, <span class="dv">1297</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8113</span>, <span class="dv">12258</span>, <span class="dv">10897</span>, <span class="dv">9617</span>, <span class="dv">936</span>, <span class="dv">1220</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ingenieurs =</span> <span class="fu">c</span>(<span class="dv">1420</span>, <span class="dv">2530</span>, <span class="dv">3986</span>, <span class="dv">2025</span>, <span class="dv">259</span>, <span class="dv">254</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1334</span>, <span class="dv">2401</span>, <span class="dv">3776</span>, <span class="dv">1979</span>, <span class="dv">253</span>, <span class="dv">241</span>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>chomage</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Total chomeurs en Bretagne et en Corse pour les années 2010 et 2011</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># sous forme de data.frame</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ddply</span>(chomage, .(annee), summarise, <span class="at">total_chomeurs =</span> <span class="fu">sum</span>(ouvriers <span class="sc">+</span> ingenieurs))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># sous forme de array</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">daply</span>(chomage, .(annee), summarise, <span class="at">total_chomeurs =</span> <span class="fu">sum</span>(ouvriers <span class="sc">+</span> ingenieurs))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># sous forme de list</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dlply</span>(chomage, .(annee), summarise, <span class="at">total_chomeurs =</span> <span class="fu">sum</span>(ouvriers <span class="sc">+</span> ingenieurs))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Total chomeurs pour les années 2010 et 2011, par région du data frame</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ddply</span>(chomage, .(annee, region), summarise,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="at">total_chomeurs =</span> <span class="fu">sum</span>(ouvriers <span class="sc">+</span> ingenieurs))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre d&#39;observations pour chaque groupe</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ddply</span>(chomage, .(annee, region), nrow)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co"># En utilisant une fonction définie par l&#39;utilisateur</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ddply</span>(chomage, .(annee, region), <span class="cf">function</span>(x){</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  moy_ouvriers <span class="ot">&lt;-</span> <span class="fu">mean</span>(x<span class="sc">$</span>ouvriers)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  moy_ingenieurs <span class="ot">&lt;-</span> <span class="fu">mean</span>(x<span class="sc">$</span>ingenieurs)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">moy_ouvriers =</span> moy_ouvriers, <span class="at">moy_ingenieurs =</span> moy_ingenieurs)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="list-en-input-lply" class="section level3 hasAnchor">
<h3 class="hasAnchor">List en input : <code>l*ply</code><a href="#list-en-input-lply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les fonctions du type <code>l*ply</code> prennent une liste en entrée. Il n’y a donc pas de paramétrage à effectuer pour choisir un découpage, il est déjà fait.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>liste <span class="ot">&lt;-</span><span class="fu">list</span>(<span class="at">normale =</span><span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="at">logiques =</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">x =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir la longueur de chaque élément de la liste</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">laply</span>(liste, length)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ldply</span>(liste, length)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">llply</span>(liste, length)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la moyenne pour chaque élément</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">llply</span>(liste, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Appliquer une fonction définie par l&#39;utilisateur</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">llply</span>(liste,<span class="cf">function</span>(x, y) x <span class="sc">/</span><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> y, <span class="at">y =</span> <span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="calcul-parallèle" class="section level3 hasAnchor">
<h3 class="hasAnchor">Calcul parallèle<a href="#calcul-parallèle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En utilisant plusieurs processeurs, on peut effectuer des calculs parallèles, ce qui accélère les calculs dans certains cas. En effet, quand il est possible de fractionner les opérations à effectuer en morceaux, on peut en réaliser une partie sur un processeur, une autre sur un second processeur, et ainsi de suite. Les résultats obtenus sont ensuite rassemblés avant d’être retournés. Le package <code class="pkg">doMC</code> (ou <code class="pkg">doSMP</code> sur <strong>Windows</strong>) peut être chargé pour utiliser la fonction de calcul parallèle proposé par les fonctions <code>**ply</code>. Il suffit de préciser le nombre de coeurs souhaité en faisant appel à la fonction <code data-pkg="doMC">registerDoMC</code>, et de fixer la valeur <code>TRUE</code> au paramètre <code>.parallel</code> de la fonction <code>**ply</code>.</p>
</div>
</div>
<div id="les-fonctions-de-la-famille-apply-du-package-base" class="section level2 hasAnchor">
<h2 class="hasAnchor">Les fonctions de la famille apply du package base<a href="#les-fonctions-de-la-famille-apply-du-package-base" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le tableau ci-après recense les fonctions principales de la famille <code>apply</code> du package <code data-pkg="base">base</code>.</p>
<table>
<thead>
<tr class="header">
<th align="left"><strong>Fonction</strong></th>
<th align="center"><strong>Input</strong></th>
<th align="center"><strong>Output</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code data-pkg="base">apply</code></td>
<td align="center">Matrice ou tableau</td>
<td align="center">Vecteur ou tableau ou liste</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base" data-rdoc="lapply">lapply</code></td>
<td align="center">Liste ou vecteur</td>
<td align="center">Liste</td>
</tr>
<tr class="odd">
<td align="left"><code data-pkg="base" data-rdoc="lapply">sapply</code></td>
<td align="center">Liste ou vecteur</td>
<td align="center">Vecteur ou matrice ou liste</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base" data-rdoc="lapply">vapply</code></td>
<td align="center">Liste ou vecteur</td>
<td align="center">Vecteur ou matrice ou liste</td>
</tr>
<tr class="odd">
<td align="left"><code data-pkg="base">tapply</code></td>
<td align="center">Tableau et facteurs</td>
<td align="center">Tableau ou liste</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base">mapply</code></td>
<td align="center">Listes et/ou vecteurs</td>
<td align="center">Vecteur ou matrice ou liste</td>
</tr>
</tbody>
</table>
<div id="la-fonction-lapply" class="section level3 hasAnchor">
<h3 class="hasAnchor">La fonction lapply<a href="#la-fonction-lapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code data-pkg="base">lapply</code> applique à chaque élément du premier paramètre qui lui est donné une fonction indiquée en second paramètre et retourne le résultat sous forme de liste. La syntaxe est la suivante :</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(X, FUN, ...)</span></code></pre></div>
<p>avec <code>X</code> la liste ou le vecteur donné en paramètre sur lequel on désire appliquer la fonction <code>FUN</code>. La paramètre <code>...</code> permet de fournir des paramètres à une fonction imbriquée, en l’occurance à celle que l’on souhaite appliquer à tous les éléments de <code>X</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>liste <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">normale =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="at">logiques =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir la liste des longueurs de chaque élément</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(liste, length)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la moyenne pour chaque élément</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(liste, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>On peut créer une fonction à l’intérieur de l’appel à <code data-pkg="&quot;base">lapply</code>. Le premier paramètre est nécessairement un élément du vecteur auquel on souhaite appliquer la fonction.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(liste, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Si la fonction doit posséder plusieurs paramètres</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(liste, <span class="cf">function</span>(x, y) x <span class="sc">/</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> y, <span class="at">y =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>On peut appliquer la <code data-pkg="base">lapply</code> sur des tableaux de données, dans la mesure où ces derniers sont des listes. Cela s’avère pratique pour réaliser des opérations pour chaque colonne d’un tableau de données. Afin de prendre moins de place dans l’affichage, l’exemple suivant utilise la fonction <code data-pkg="base">unlist</code> pour <q>aplatir</q> la liste obtenue.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cars)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le type de chaque colonne de la data frame &quot;cars&quot;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(cars, class))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la moyenne pour chaque colonne</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(cars, mean))</span></code></pre></div>
<div class="note">
<p>Attention, ce qui suit relève plus d’un tour de passe-passe que de la programmation élégante.</p>
<p>Si la fonction que l’on souhaite appliquer aux éléments de notre vecteur retourne un vecteur ligne de même longueur pour chaque élément, la fonction <code data-pkg="base">do.call</code> peut devenir un outil très pratique pour créer une data frame. Voyons-le à travers un exemple.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="cf">function</span>(x) <span class="fu">cbind</span>(<span class="at">valeur =</span> x, <span class="at">lettre =</span> LETTERS[x]))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>l</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, l))</span></code></pre></div>
<p>L’appel de <code>do.call("rbind", x)</code> revient à faire <code>rbind(x[[1]], x[[2]], ..., x[[n]])</code> avec <code>x</code> une liste de taille <code>n</code>.</p>
</div>
<div id="la-fonction-sapply" class="section level3 hasAnchor">
<h3 class="hasAnchor">La fonction sapply<a href="#la-fonction-sapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code data-pkg="base" data-rdoc="lapply">sapply</code> applique une fonction aux éléments d’un vecteur ou d’une liste et peut retourner un vecteur, une liste ou une matrice. Elle possède la syntaxe suivante :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(X, FUN, simplify, USE.NAMES)</span></code></pre></div>
<p>où <code>X</code> est le vecteur ou la liste auquel on souhaite appliquer la fonction <code>FUN</code>. Lorsque <code>simplify</code> vaut <code>FALSE</code>, le résultat est retourné sous forme de liste, exactement comme <code data-pkg="base">lapply</code> (la fonction <code data-pkg="base" data-rdoc="lapply">sapply</code> s’appuie sur la fonction <code data-pkg="base">lapply</code>). Lorsque <code>simplify</code> vaut <code>TRUE</code> (par défaut), le résultat est retourné dans une forme simplifiée, si cela est possible. Si tous les éléments retournés par la fonction <code>FUN</code> sont des scalaires, alors <code data-pkg="base" data-rdoc="lapply">sapply</code> retourne un vecteur ; sinon, si les éléments retournés ont la même taille, <code data-pkg="base" data-rdoc="lapply">sapply</code> retourne une matrice avec une colonne pour chaque élément de <code>X</code> auquel la fonction <code>FUN</code> est appliquée. Le paramètre <code>USE.NAMES</code>, quand il vaut
<code>TRUE</code> (par défaut), et si <code>X</code> est de type character, utilise <code>X</code> comme nom pour le résultat, à moins que le résultat possède déjà des noms.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">beta =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">logic =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>)))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Application de la fonction quantile() à chaque élément</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pour obtenir la médiane et les quartiles</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec lapply()</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, quantile)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec sapply</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, quantile)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemple avec USE.NAMES</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], nchar)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], nchar, <span class="at">USE.NAMES =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="la-fonction-vapply" class="section level3 hasAnchor">
<h3 class="hasAnchor">La fonction vapply<a href="#la-fonction-vapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code data-pkg="base" data-rdoc="lapply">vapply</code> est similaire à <code data-pkg="base" data-rdoc="lapply">sapply</code>, mais elle possède un type de valeurs spécifié, ce qui peut rendre l’utilisation plus sûre (et parfois plus rapide). Lorsqu’on lui fournit un <em>data.frame</em>, <code data-pkg="base" data-rdoc="lapply">vapply</code> retourne le même résultat que <code data-pkg="base" data-rdoc="lapply">sapply</code>. Cependant, quand on lui fournit une liste vide, <code data-pkg="base" data-rdoc="lapply">vapply</code> retourne un vecteur logique de longueur nulle (ce qui est plus sensé que la liste vide que returne <code data-pkg="base" data-rdoc="lapply">sapply</code>).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(X, FUN, FUN.VALUE, ..., USE.NAMES)</span></code></pre></div>
<p>avec <code>X</code>, <code>FUN</code>, <code>...</code> et <code>USE.NAMES</code> les mêmes paramètres que pour <code data-pkg="base" data-rdoc="lapply">sapply</code>. Le paramètre <code>FUN.VALUE</code> doit être un vecteur, un masque pour la valeur retournée par la fonction de <code>FUN</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retourner le vecteur</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(cars, is.numeric)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(cars, is.numeric, <span class="at">FUN.VALUE =</span> <span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la liste vide</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">list</span>(), is.numeric)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(<span class="fu">list</span>(), is.numeric, <span class="at">FUN.VALUE =</span> <span class="fu">logical</span>(<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="la-fonction-apply" class="section level3 hasAnchor">
<h3 class="hasAnchor">La fonction apply<a href="#la-fonction-apply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code data-pkg="base">apply</code> possède la syntaxe suivante :</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(X, MARGIN, FUN, ...)</span></code></pre></div>
<p>avec <code>X</code> une matrice ou un tableau, <code>MARGIN</code> indiquant si on souhaite appliquer la fonction <code>FUN</code> aux lignes <code>(MARGIN = 1)</code> ou aux colonnes <code>(MARGIN = 2)</code>, et <code>...</code> des paramètres supplémentaires éventuels à passer à la fonction <code>FUN</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Somme par ligne</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(X, <span class="at">MARGIN =</span> <span class="dv">1</span>, sum)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Somme par colonne</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(X, <span class="at">MARGIN =</span> <span class="dv">2</span>, sum)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction définie par l&#39;utilisateur</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(X, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x) <span class="sc">/</span> <span class="fu">sum</span>(X))</span></code></pre></div>
</div>
<div id="la-fonction-tapply" class="section level3 hasAnchor">
<h3 class="hasAnchor">La fonction tapply<a href="#la-fonction-tapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code data-pkg="base">tapply</code> s’applique à chaque cellule d’un tableau, sur des regroupements définis par les variables catégorielles fournies. La syntaxe est la suivante :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(X,INDEX, FUN, ..., simplify)</span></code></pre></div>
<p>avec <code>X</code> le tableau de données, <code>INDEX</code> une liste d’un ou plusieurs facteurs, chacun de même taille que <code>X</code>. Le paramètre <code>FUN</code> renseigne la fonction que l’on souhaite appliquer. Si <code>simplify</code> vaut <code>FALSE</code>, le résultat est un tableau de mode <em>list</em>. Sinon (par défaut), le résultat est un tableau de scalaires.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de la longueur des sépales par espèce</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, mean)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour retourner le résultat sous forme de liste</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, mean, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="la-fonction-mapply" class="section level3 hasAnchor">
<h3 class="hasAnchor">La fonction mapply<a href="#la-fonction-mapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code data-pkg="base">mapply</code> applique une fonction à plusieurs listes ou vecteurs. La syntaxe est la suivante :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapply</span>(FUN, ..., MoreArgs, SIMPLIFY, USE.NAMES)</span></code></pre></div>
<p>avec <code>FUN</code> la fonction à appliquer aux vecteurs ou listes fournies (grâce à <code>...</code>), <code>MoreArgs</code> une liste de paramètres supplémentaires à fournir à la fonction à appliquer. Les paramètres <code>SIMPLIFY</code> et <code>USE.NAMES</code> ont le même usage que pour la fonction <code data-pkg="base" data-rdoc="lapply">sapply</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(l1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>(l2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">c =</span> <span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>), <span class="at">d =</span> <span class="fu">c</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">20</span>)))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># La somme des éléments correspondants de l1 et l2</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mapply</span>(sum, l1<span class="sc">$</span>a, l1<span class="sc">$</span>b, l2<span class="sc">$</span>c, l2<span class="sc">$</span>d)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention au recyclage silencieux !</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>(l1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">20</span>)))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mapply</span>(sum, l1<span class="sc">$</span>a, l1<span class="sc">$</span>b, l2<span class="sc">$</span>c, l2<span class="sc">$</span>d)</span></code></pre></div>
</div>
</div>
<div id="la-fonction-vectorize" class="section level2 hasAnchor">
<h2 class="hasAnchor">La fonction Vectorize<a href="#la-fonction-vectorize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La fonction <code data-pkg="base">Vectorize</code> permet de convertir une fonction scalaire en une fonction vectorielle. Attention, cela ne permet pas d’améliorer la rapidité d’exécution du code. Par contre, son utilisation assez intuitive permet de gagner du temps. Il s’agit donc de faire l’arbitrage entre le temps passé à trouver un moyen élégant et efficace pour effectuer une opération en passant par de réels calculs vectoriels et le gain d’exécution que ce calcul vectoriel apporte vis-à-vis d’une boucle. La syntaxe de la <code data-pkg="base">Vectorize</code> est la suivante :</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Vectorize</span>(FUN, vectorize.args, SIMPLIFY, USE.NAMES)</span></code></pre></div>
<p>avec <code>FUN</code> une fonction à appliquer, <code>vectorize.args</code> un vecteur de paramètres (de type caractère) qui devraient être vectorisés (par défaut, tous les paramètre de <code>FUN</code>). Les paramètres <code>SIMPLIFY</code> et <code>USE.NAMES</code> on le même emploi que dans la fonction <code data-pkg="base" data-rdoc="lapply">sapply</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, y) <span class="fu">c</span>(x, y)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On &quot;vectorise&quot; la fonction f</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>vf <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(f, <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vf</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectorise seulement y, pas x</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vf</span>(<span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copié !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
-->

<!-- Giscus comments -->
<script src="https://giscus.app/client.js"
        data-repo="larmarange/analyse-R"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzNDk4NjY2Ng=="
        data-category-id="DIC_kwDOAhXaqs4B_iH_"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="light"
        data-lang="fr"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->



</body>
</html>
