<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Vectorisation</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnes.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <li><a href="scraping.html">Scraping</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe</a></li>
                  <li><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Modèles à effets aléatoires (modèles mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de données longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">Étendre ggplot2</a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres</a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations mathématiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="./images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Vectorisation</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#les-fonctions-de-lextension-plyr">Les fonctions de l’extension plyr</a><ul>
<li><a href="#array-en-input-aply">Array en input : <code>a*ply</code></a></li>
<li><a href="#data.frame-en-input-dply">Data.frame en input : <code>d*ply</code></a></li>
<li><a href="#list-en-input-lply">List en input : <code>l*ply</code></a></li>
<li><a href="#calcul-parallele">Calcul parallèle</a></li>
</ul></li>
<li><a href="#les-fonctions-de-la-famille-apply-du-package-base">Les fonctions de la famille apply du package base</a><ul>
<li><a href="#la-fonction-lapply">La fonction lapply</a></li>
<li><a href="#la-fonction-sapply">La fonction sapply</a></li>
<li><a href="#la-fonction-vapply">La fonction vapply</a></li>
<li><a href="#la-fonction-apply">La fonction apply</a></li>
<li><a href="#la-fonction-tapply">La fonction tapply</a></li>
<li><a href="#la-fonction-mapply">La fonction mapply</a></li>
</ul></li>
<li><a href="#la-fonction-vectorize">La fonction Vectorize</a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Ewen Gallic dans le cadre de son support de cours d’Ewen Gallic intitulé <a href="http://egallic.fr/Enseignement/R/m1_stat_eco_logiciel_R.pdf">Logiciel R et programmation</a>, chapitre 4 <q>Boucles et calculs vectoriels</q>.</p>
</div>
<p>Les <a href="structures-conditionnelles.html">boucles</a> sont des opérations lentes en <strong>R</strong>. Il est cependant possible, dans de nombreux cas, d’éviter de les employer, en ayant recours à la vectorisation : au lieu d’appliquer une fonction à un scalaire, on l’applique à un vecteur. En fait, nous avons déjà eu recours à maintes reprises aux calculs vectoriels. En effet, lorsque nous avons procédé à des additions, des multiplications, etc. sur des vecteurs, nous avons effectué des calculs vectoriels.</p>
<p>Empruntons un exemple à Burns (2011) : dans des langages comme le <strong>C</strong>, pour effectuer la somme des logarithmes naturels des n premiers entiers, voici une manière de faire :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Somme des logarithmes des 10 premiers entiers</span></a>
<a class="sourceLine" id="cb1-2" title="2">somme_log &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="dv">10</span>)) {</a>
<a class="sourceLine" id="cb1-4" title="4">  somme_log &lt;-<span class="st"> </span>somme_log <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(i)</a>
<a class="sourceLine" id="cb1-5" title="5">}</a>
<a class="sourceLine" id="cb1-6" title="6">somme_log</a></code></pre></div>
<pre><code>[1] 15.10441</code></pre>
<p>Il est possible d’obtenir le même résultat, à la fois d’une manière plus élégante, mais surtout plus efficace en vectorisant le calcul :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">seq_len</span>(<span class="dv">10</span>)))</a></code></pre></div>
<pre><code>[1] 15.10441</code></pre>
<p>Derrière ce code, la fonction <code data-pkg="base">log</code> applique la fonction logarithme sur toutes les valeurs du vecteur donné en paramètre. La fonction <code data-pkg="base">sum</code>, quant à elle, se charge d’additionner tous les éléments du vecteur qui lui est donné en paramètre. Ces deux fonctions utilisent la vectorisation, mais d’une manière différente : la fonction <code data-pkg="base">log</code> applique une opération à chaque élément d’un vecteur, tandis que la fonction <code data-pkg="base">sum</code> produit un résultat basé sur l’ensemble du vecteur. L’avantage d’utiliser des fonctions vectorielles plutôt que d’écrire une boucle pour effectuer le calcul, est que ces premières font appel à des fonctions rédigées en <strong>C</strong> ou <strong>FORTRAN</strong>, qui utilisent aussi des boucles, mais comme ce sont des langages compilés et non pas interprétés, les itérations sont réalisées dans un temps réduit.</p>
<p>Il existe des fonctions, rédigées en <strong>C</strong> qui effectuent des boucles <code>for</code>. On leur donne souvent le nom de “fonctions de la famille apply”. Il ne s’agit pas de la vectorisation, mais ces fonctions sont souvent mentionnées dès que l’on parle de ce sujet. Ce sont des fonctionnelles qui prennent une fonction en input et retournent un vecteur en output (Wickham, 2014). Ces fonctions sont très utilisées, mais elles souffrent d’un manque d’uniformité. En effet, elles ont été rédigées par des personnes différentes, ayant chacune leur convention. L’extension <code class="pkg">plyr</code> remédie à ce problème, et ajoute par la même occasion des fonctions supplémentaires, pour couvrir plus de cas que les “fonctions de la famille apply”.</p>
<p>Nous allons donc présenter dans un premier temps les fonctions du package <code class="pkg">plyr</code>. Les fonctions du même type du package <code class="pkg">base</code> seront tout de même présentées par la suite.</p>
<div id="les-fonctions-de-lextension-plyr" class="section level2">
<h2>Les fonctions de l’extension plyr</h2>
<p>Les fonctions que nous allons aborder dans cette section possèdent des noms faciles à se remémorer : la première lettre correspond au format d’entrée des données, la seconde au format de sortie souhaité, et la fin du nom se termine par le suffixe <code>ply</code>. Ainsi, la fonction <code data-pkg="plyr">llpply</code> prend en entrée une liste, effectue une opération sur les éléments, et retourne une liste (Anderson, 2012).</p>
<p>Les différentes fonctions que nous allons passer en revue sont consignées dans le tableau ci-après, où les lignes correspondent aux formats d’entrée, et les lignes aux formats de sortie. Pour y avoir accès, il faut charger le package :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">library</span>(plyr)</a></code></pre></div>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden" colspan="2">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Format de sortie
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
array
</th>
<th style="text-align:center;">
data.frame
</th>
<th style="text-align:center;">
list
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;vertical-align: middle !important;" rowspan="3">
Format d’entée
</td>
<td style="text-align:left;font-weight: bold;">
array
</td>
<td style="text-align:center;">
<code data-pkg="plyr">aaply</code>
</td>
<td style="text-align:center;">
<code data-pkg="plyr">adply</code>
</td>
<td style="text-align:center;">
<code data-pkg="plyr">alply</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
data.frame
</td>
<td style="text-align:center;">
<code data-pkg="plyr">daply</code>
</td>
<td style="text-align:center;">
<code data-pkg="plyr">ddply</code>
</td>
<td style="text-align:center;">
<code data-pkg="plyr">dlply</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
list
</td>
<td style="text-align:center;">
<code data-pkg="plyr">laply</code>
</td>
<td style="text-align:center;">
<code data-pkg="plyr">ldply</code>
</td>
<td style="text-align:center;">
<code data-pkg="plyr">llply</code>
</td>
</tr>
</tbody>
</table>
<p>Il est possible d’avoir plusieurs paramètres en input au lieu d’un seul objet. Les fonctions <code data-pkg="plyr">mlply</code>, <code data-pkg="plyr">mdply</code> et <code data-pkg="plyr">maply</code>. Si à la place du <code>m</code>, la première lettre est un <code>r</code>, il s’agit alors de fonction de réplications. Enfin, si la seconde lettre est un trait de soulignement (<code>_</code>), alors le résultat retourné n’est pas affiché (le code utilise la fonction <code data-pkg="base">invisible</code>.</p>
<p>Tous les paramètres de ces fonctions commencent par un point (<code>.</code>), afin d’éviter des incompatibilités avec la fonction à appliquer.</p>
<div id="array-en-input-aply" class="section level3">
<h3>Array en input : <code>a*ply</code></h3>
<p>Les fonctions <code data-pkg="plyr">aaply</code>, <code data-pkg="plyr">adply</code> et <code data-pkg="plyr">alply</code> appliquent une fonction à chaque portion d’un <em>array</em> et ensuitent joignent le résultat sous forme d’un <em>array</em>, d’un <em>data.frame</em> ou d’une <em>list</em> respectivement.</p>
<div class="note">
<p>Un <code data-pkg="base">array</code> peut être vu comme un vecteur à plusieurs dimensions. Comme pour un vecteur, toutes les valeurs doivent être du même type. Un vecteur n’est finalement qu’un <em>array</em> à une seule dimension. De même, un <em>array</em> à deux dimensions correspond à ce qu’on appelle usuelement une matrice.</p>
</div>
<p>Le paramètre <code>.margins</code> détermine la manière de découper le tableau. Il y en a quatre pour un tableau en deux dimensions :</p>
<ol style="list-style-type: decimal">
<li><code>.margins = 1</code> : par lignes ;</li>
<li><code>.margins = 2</code> : par colonnes ;</li>
<li><code>.margins = c(1,2)</code> : par cellule ;</li>
<li><code>.margins = c()</code> : ne pas faire de découpement.</li>
</ol>
<p>Pour un tableau en trois dimensions, il y a trois découpages possibles en deux dimensions, trois en une dimension et une en zéro dimension (voir (Wickham, 2011)) au besoin.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">tableau &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="dt">ligne =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], </a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="dt">colonne =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">annee =</span> <span class="dv">2001</span><span class="op">:</span><span class="dv">2002</span>))</a>
<a class="sourceLine" id="cb6-3" title="3">tableau</a></code></pre></div>
<pre><code>, , annee = 2001

     colonne
ligne A B C  D
    a 1 4 7 10
    b 2 5 8 11
    c 3 6 9 12

, , annee = 2002

     colonne
ligne  A  B  C  D
    a 13 16 19 22
    b 14 17 20 23
    c 15 18 21 24</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># La moyenne des valeurs pour chaque ligne</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">aaply</span>(tableau, <span class="dv">1</span>, mean)  <span class="co"># résultat sous forme de tableau</span></a></code></pre></div>
<pre><code>   a    b    c 
11.5 12.5 13.5 </code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">adply</span>(tableau, <span class="dv">1</span>, mean)  <span class="co"># résultat sous forme de data.frame</span></a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ligne"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["V1"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"a","2":"11.5"},{"1":"b","2":"12.5"},{"1":"c","2":"13.5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">alply</span>(tableau, <span class="dv">1</span>, mean)  <span class="co"># résultat sous forme de liste</span></a></code></pre></div>
<pre><code>$`1`
[1] 11.5

$`2`
[1] 12.5

$`3`
[1] 13.5

attr(,&quot;split_type&quot;)
[1] &quot;array&quot;
attr(,&quot;split_labels&quot;)
  ligne
1     a
2     b
3     c</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># La moyenne des valeurs pour chaque colonne en ne</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co"># simplifiant pas le résultat</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">aaply</span>(tableau, <span class="dv">2</span>, mean, <span class="dt">.drop =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>       
colonne  1
      A  8
      B 11
      C 14
      D 17</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Par lignes et colonnes</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">aaply</span>(tableau, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</a></code></pre></div>
<pre><code>     colonne
ligne A  B  C  D
    a 7 10 13 16
    b 8 11 14 17
    c 9 12 15 18</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">adply</span>(tableau, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ligne"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["colonne"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["V1"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"a","2":"A","3":"7"},{"1":"b","2":"A","3":"8"},{"1":"c","2":"A","3":"9"},{"1":"a","2":"B","3":"10"},{"1":"b","2":"B","3":"11"},{"1":"c","2":"B","3":"12"},{"1":"a","2":"C","3":"13"},{"1":"b","2":"C","3":"14"},{"1":"c","2":"C","3":"15"},{"1":"a","2":"D","3":"16"},{"1":"b","2":"D","3":"17"},{"1":"c","2":"D","3":"18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># Avec une fonction définie par l&#39;utilisateur</span></a>
<a class="sourceLine" id="cb18-2" title="2">standardise &lt;-<span class="st"> </span><span class="cf">function</span>(x) (x <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x))<span class="op">/</span>(<span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x))</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co"># Standardiser les valeurs par colonne</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw">aaply</span>(tableau, <span class="dv">2</span>, standardise)</a></code></pre></div>
<pre><code>, , annee = 2001

       ligne
colonne a          b         c
      A 0 0.07142857 0.1428571
      B 0 0.07142857 0.1428571
      C 0 0.07142857 0.1428571
      D 0 0.07142857 0.1428571

, , annee = 2002

       ligne
colonne         a         b c
      A 0.8571429 0.9285714 1
      B 0.8571429 0.9285714 1
      C 0.8571429 0.9285714 1
      D 0.8571429 0.9285714 1</code></pre>
</div>
<div id="data.frame-en-input-dply" class="section level3">
<h3>Data.frame en input : <code>d*ply</code></h3>
<p>Dans le cas de l’analyse d’enquêtes, on utilise principalement des tableaux de données ou <em>data.frame</em>. Aussi, la connaissance des fonction <code data-pkg="plyr">daply</code>, <code data-pkg="plyr">ddply</code> et <code data-pkg="plyr">dlply</code> peut être utile. En effet, elles sont très utiles pour appliquer des fonctions à des groupes basés sur des combinaisons de variables, même si dans la majorité des cas il est maintenant plus facile de passer par les extensions <code class="pkg">dplyr</code> ou <code class="pkg">data.table</code> avec les opérations groupées (voir la section sur <a href="manipuler-les-donnees-avec-dplyr.html#operations-groupees">groub_by de dplyr</a> ou encore celle sur le <a href="manipulations-avancees-avec-data-table.html#grouper-les-resultats">paramètre by de data.table</a>.</p>
<p>Avec les fonctions <code>d*ply</code>, il est nécessaire d’indiquer quelles variables, ou fonctions de variables on souhaite utiliser, en l’indiquant au paramètre <code>.variables</code>. Elles peuvent être contenue dans le data frame fourni au paramètre <code>.data</code>, ou bien provenir de l’environnement global. <strong>R</strong> cherchera dans un premier temps si la variable est contenue dans le <em>data.frame</em> et, s’il ne trouve pas, ira chercher dans l’environnement global.</p>
<p>Pour indiquer que l’on désire faire le regroupement selon une variable – mettons <code>variable_1</code> – il faudra fournir l’expression <code>.(variable_1)</code> au paramètre <code>.variables</code>. Si on souhaite effectuer les regroupement selon les interactions de plusieurs variables – <code>variable_1</code>, <code>variable_2</code> et <code>variable_3</code>, il faut alors utiliser l’expression suivante : <code>.(variable_1, variable_2, variable_3)</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">chomage &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">region =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Bretagne&quot;</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">&quot;Corse&quot;</span>, </a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="dv">2</span>)), <span class="dv">2</span>), <span class="dt">departement =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Cotes-d&#39;Armor&quot;</span>, <span class="st">&quot;Finistere&quot;</span>, </a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="st">&quot;Ille-et-Vilaine&quot;</span>, <span class="st">&quot;Morbihan&quot;</span>, <span class="st">&quot;Corse-du-Sud&quot;</span>, <span class="st">&quot;Haute-Corse&quot;</span>), </a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="dv">2</span>), <span class="dt">annee =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">2011</span>, <span class="dv">2010</span>), <span class="dt">each =</span> <span class="dv">6</span>), <span class="dt">ouvriers =</span> <span class="kw">c</span>(<span class="dv">8738</span>, </a>
<a class="sourceLine" id="cb20-5" title="5">  <span class="dv">12701</span>, <span class="dv">11390</span>, <span class="dv">10228</span>, <span class="dv">975</span>, <span class="dv">1297</span>, <span class="dv">8113</span>, <span class="dv">12258</span>, <span class="dv">10897</span>, <span class="dv">9617</span>, </a>
<a class="sourceLine" id="cb20-6" title="6">  <span class="dv">936</span>, <span class="dv">1220</span>), <span class="dt">ingenieurs =</span> <span class="kw">c</span>(<span class="dv">1420</span>, <span class="dv">2530</span>, <span class="dv">3986</span>, <span class="dv">2025</span>, <span class="dv">259</span>, <span class="dv">254</span>, </a>
<a class="sourceLine" id="cb20-7" title="7">  <span class="dv">1334</span>, <span class="dv">2401</span>, <span class="dv">3776</span>, <span class="dv">1979</span>, <span class="dv">253</span>, <span class="dv">241</span>))</a>
<a class="sourceLine" id="cb20-8" title="8">chomage</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["region"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["departement"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["annee"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ouvriers"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ingenieurs"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Bretagne","2":"Cotes-d'Armor","3":"2011","4":"8738","5":"1420"},{"1":"Bretagne","2":"Finistere","3":"2011","4":"12701","5":"2530"},{"1":"Bretagne","2":"Ille-et-Vilaine","3":"2011","4":"11390","5":"3986"},{"1":"Bretagne","2":"Morbihan","3":"2011","4":"10228","5":"2025"},{"1":"Corse","2":"Corse-du-Sud","3":"2011","4":"975","5":"259"},{"1":"Corse","2":"Haute-Corse","3":"2011","4":"1297","5":"254"},{"1":"Bretagne","2":"Cotes-d'Armor","3":"2010","4":"8113","5":"1334"},{"1":"Bretagne","2":"Finistere","3":"2010","4":"12258","5":"2401"},{"1":"Bretagne","2":"Ille-et-Vilaine","3":"2010","4":"10897","5":"3776"},{"1":"Bretagne","2":"Morbihan","3":"2010","4":"9617","5":"1979"},{"1":"Corse","2":"Corse-du-Sud","3":"2010","4":"936","5":"253"},{"1":"Corse","2":"Haute-Corse","3":"2010","4":"1220","5":"241"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># Total chomeurs en Bretagne et en Corse pour les années 2010</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co"># et 2011 sous forme de data.frame</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">ddply</span>(chomage, .(annee), summarise, <span class="dt">total_chomeurs =</span> <span class="kw">sum</span>(ouvriers <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span>ingenieurs))</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["annee"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["total_chomeurs"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2010","2":"53025"},{"1":"2011","2":"55803"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># sous forme de array</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">daply</span>(chomage, .(annee), summarise, <span class="dt">total_chomeurs =</span> <span class="kw">sum</span>(ouvriers <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="st">  </span>ingenieurs))</a></code></pre></div>
<pre><code>$`2010`
[1] 53025

$`2011`
[1] 55803</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># sous forme de list</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">dlply</span>(chomage, .(annee), summarise, <span class="dt">total_chomeurs =</span> <span class="kw">sum</span>(ouvriers <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">  </span>ingenieurs))</a></code></pre></div>
<pre><code>$`2010`
  total_chomeurs
1          53025

$`2011`
  total_chomeurs
1          55803

attr(,&quot;split_type&quot;)
[1] &quot;data.frame&quot;
attr(,&quot;split_labels&quot;)
  annee
1  2010
2  2011</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># Total chomeurs pour les années 2010 et 2011, par région du</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co"># data frame</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw">ddply</span>(chomage, .(annee, region), summarise, <span class="dt">total_chomeurs =</span> <span class="kw">sum</span>(ouvriers <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">  </span>ingenieurs))</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["annee"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["region"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["total_chomeurs"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2010","2":"Bretagne","3":"50375"},{"1":"2010","2":"Corse","3":"2650"},{"1":"2011","2":"Bretagne","3":"53018"},{"1":"2011","2":"Corse","3":"2785"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># Nombre d&#39;observations pour chaque groupe</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">ddply</span>(chomage, .(annee, region), nrow)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["annee"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["region"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["V1"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"2010","2":"Bretagne","3":"4"},{"1":"2010","2":"Corse","3":"2"},{"1":"2011","2":"Bretagne","3":"4"},{"1":"2011","2":"Corse","3":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># En utilisant une fonction définie par l&#39;utilisateur</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">ddply</span>(chomage, .(annee, region), <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb28-3" title="3">  moy_ouvriers &lt;-<span class="st"> </span><span class="kw">mean</span>(x<span class="op">$</span>ouvriers)</a>
<a class="sourceLine" id="cb28-4" title="4">  moy_ingenieurs &lt;-<span class="st"> </span><span class="kw">mean</span>(x<span class="op">$</span>ingenieurs)</a>
<a class="sourceLine" id="cb28-5" title="5">  <span class="kw">data.frame</span>(<span class="dt">moy_ouvriers =</span> moy_ouvriers, <span class="dt">moy_ingenieurs =</span> moy_ingenieurs)</a>
<a class="sourceLine" id="cb28-6" title="6">})</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["annee"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["region"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["moy_ouvriers"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["moy_ingenieurs"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2010","2":"Bretagne","3":"10221.25","4":"2372.50"},{"1":"2010","2":"Corse","3":"1078.00","4":"247.00"},{"1":"2011","2":"Bretagne","3":"10764.25","4":"2490.25"},{"1":"2011","2":"Corse","3":"1136.00","4":"256.50"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="list-en-input-lply" class="section level3">
<h3>List en input : <code>l*ply</code></h3>
<p>Les fonctions du type <code>l*ply</code> prennent une liste en entrée. Il n’y a donc pas de paramétrage à effectuer pour choisir un découpage, il est déjà fait.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-2" title="2">liste &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">normale =</span> <span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dt">logiques =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>), </a>
<a class="sourceLine" id="cb29-3" title="3">  <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="ot">NA</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co"># Obtenir la longueur de chaque élément de la liste</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="kw">laply</span>(liste, length)</a></code></pre></div>
<pre><code>[1] 10  3  3</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">ldply</span>(liste, length)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[".id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["V1"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"normale","2":"10"},{"1":"logiques","2":"3"},{"1":"x","2":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">llply</span>(liste, length)</a></code></pre></div>
<pre><code>$normale
[1] 10

$logiques
[1] 3

$x
[1] 3</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># Calculer la moyenne pour chaque élément</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">unlist</span>(<span class="kw">llply</span>(liste, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>  normale  logiques         x 
0.1322028 0.6666667 1.5000000 </code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># Appliquer une fonction définie par l&#39;utilisateur</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="kw">llply</span>(liste, <span class="cf">function</span>(x, y) x<span class="op">/</span><span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>y, <span class="dt">y =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>$normale
 [1] -2.7385827  3.3891033 -4.3208096 14.0669232  4.4924421
 [6] -4.2061356  5.6869803  7.5847895  6.3552892 -0.3099997

$logiques
[1] 3.5 3.5 2.0

$x
[1]  2 NA  4</code></pre>
</div>
<div id="calcul-parallele" class="section level3">
<h3>Calcul parallèle</h3>
<p>En utilisant plusieurs processeurs, on peut effectuer des calculs parallèles, ce qui accélère les calculs dans certains cas. En effet, quand il est possible de fractionner les opérations à effectuer en morceaux, on peut en réaliser une partie sur un processeur, une autre sur un second processeur, et ainsi de suite. Les résultats obtenus sont ensuite rassemblés avant d’être retournés. Le package <code class="pkg">doMC</code> (ou <code class="pkg">doSMP</code> sur <strong>Windows</strong>) peut être chargé pour utiliser la fonction de calcul parallèle proposé par les fonctions <code>**ply</code>. Il suffit de préciser le nombre de coeurs souhaité en faisant appel à la fonction <code data-pkg="doMC">registerDoMC</code>, et de fixer la valeur <code>TRUE</code> au paramètre <code>.parallel</code> de la fonction <code>**ply</code>.</p>
</div>
</div>
<div id="les-fonctions-de-la-famille-apply-du-package-base" class="section level2">
<h2>Les fonctions de la famille apply du package base</h2>
<p>Le tableau ci-après recense les fonctions principales de la famille <code>apply</code> du package <code data-pkg="base">base</code>.</p>
<table>
<thead>
<tr class="header">
<th align="left"><strong>Fonction</strong></th>
<th align="center"><strong>Input</strong></th>
<th align="center"><strong>Output</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code data-pkg="base">apply</code></td>
<td align="center">Matrice ou tableau</td>
<td align="center">Vecteur ou tableau ou liste</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base" data-rdoc="lapply">lapply</code></td>
<td align="center">Liste ou vecteur</td>
<td align="center">Liste</td>
</tr>
<tr class="odd">
<td align="left"><code data-pkg="base" data-rdoc="lapply">sapply</code></td>
<td align="center">Liste ou vecteur</td>
<td align="center">Vecteur ou matrice ou liste</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base" data-rdoc="lapply">vapply</code></td>
<td align="center">Liste ou vecteur</td>
<td align="center">Vecteur ou matrice ou liste</td>
</tr>
<tr class="odd">
<td align="left"><code data-pkg="base">tapply</code></td>
<td align="center">Tableau et facteurs</td>
<td align="center">Tableau ou liste</td>
</tr>
<tr class="even">
<td align="left"><code data-pkg="base">mapply</code></td>
<td align="center">Listes et/ou vecteurs</td>
<td align="center">Vecteur ou matrice ou liste</td>
</tr>
</tbody>
</table>
<div id="la-fonction-lapply" class="section level3">
<h3>La fonction lapply</h3>
<p>La fonction <code data-pkg="base">lapply</code> applique à chaque élément du premier paramètre qui lui est donné une fonction indiquée en second paramètre et retourne le résultat sous forme de liste. La syntaxe est la suivante :</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">lapply</span>(X, FUN, ...)</a></code></pre></div>
<p>avec <code>X</code> la liste ou le vecteur donné en paramètre sur lequel on désire appliquer la fonction <code>FUN</code>. La paramètre <code>...</code> permet de fournir des paramètres à une fonction imbriquée, en l’occurance à celle que l’on souhaite appliquer à tous les éléments de <code>X</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">liste &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">normale =</span> <span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dt">logiques =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>), </a>
<a class="sourceLine" id="cb39-2" title="2">  <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="ot">NA</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co"># Obtenir la liste des longueurs de chaque élément</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="kw">lapply</span>(liste, length)</a></code></pre></div>
<pre><code>$normale
[1] 10

$logiques
[1] 3

$x
[1] 3</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co"># Calculer la moyenne pour chaque élément</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">lapply</span>(liste, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>$normale
[1] 0.248845

$logiques
[1] 0.6666667

$x
[1] 1.5</code></pre>
<p>On peut créer une fonction à l’intérieur de l’appel à <code data-pkg="&quot;base">lapply</code>. Le premier paramètre est nécessairement un élément du vecteur auquel on souhaite appliquer la fonction.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">lapply</span>(liste, <span class="cf">function</span>(x) x<span class="op">/</span><span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>$normale
 [1]  6.07519277  1.56661087 -2.49649643 -8.89991820
 [5]  4.52060941 -0.18056868 -0.06506164  3.79286833
 [9]  3.30013177  2.38663180

$logiques
[1] 1.5 1.5 0.0

$x
[1]  0 NA  2</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># Si la fonction doit posséder plusieurs paramètres</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">lapply</span>(liste, <span class="cf">function</span>(x, y) x<span class="op">/</span><span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>y, <span class="dt">y =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>$normale
 [1]  8.0751928  3.5666109 -0.4964964 -6.8999182  6.5206094
 [6]  1.8194313  1.9349384  5.7928683  5.3001318  4.3866318

$logiques
[1] 3.5 3.5 2.0

$x
[1]  2 NA  4</code></pre>
<p>On peut appliquer la <code data-pkg="base">lapply</code> sur des tableaux de données, dans la mesure où ces derniers sont des listes. Cela s’avère pratique pour réaliser des opérations pour chaque colonne d’un tableau de données. Afin de prendre moins de place dans l’affichage, l’exemple suivant utilise la fonction <code data-pkg="base">unlist</code> pour <q>aplatir</q> la liste obtenue.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">data</span>(cars)</a>
<a class="sourceLine" id="cb47-2" title="2"></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="co"># Afficher le type de chaque colonne de la data frame &#39;cars&#39;</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="kw">unlist</span>(<span class="kw">lapply</span>(cars, class))</a></code></pre></div>
<pre><code>    speed      dist 
&quot;numeric&quot; &quot;numeric&quot; </code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># Calculer la moyenne pour chaque colonne</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="kw">unlist</span>(<span class="kw">lapply</span>(cars, mean))</a></code></pre></div>
<pre><code>speed  dist 
15.40 42.98 </code></pre>
<div class="note">
<p>Attention, ce qui suit relève plus d’un tour de passe-passe que de la programmation élégante.</p>
<p>Si la fonction que l’on souhaite appliquer aux éléments de notre vecteur retourne un vecteur ligne de même longueur pour chaque élément, la fonction <code data-pkg="base">do.call</code> peut devenir un outil très pratique pour créer une data frame. Voyons-le à travers un exemple.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">l &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="cf">function</span>(x) <span class="kw">cbind</span>(<span class="dt">valeur =</span> x, <span class="dt">lettre =</span> LETTERS[x]))</a>
<a class="sourceLine" id="cb51-2" title="2">l</a></code></pre></div>
<pre><code>[[1]]
     valeur lettre
[1,] &quot;1&quot;    &quot;A&quot;   

[[2]]
     valeur lettre
[1,] &quot;2&quot;    &quot;B&quot;   

[[3]]
     valeur lettre
[1,] &quot;3&quot;    &quot;C&quot;   </code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">data.frame</span>(<span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, l))</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["valeur"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["lettre"],"name":[2],"type":["fctr"],"align":["left"]}],"data":[{"1":"1","2":"A"},{"1":"2","2":"B"},{"1":"3","2":"C"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>L’appel de <code>do.call("rbind", x)</code> revient à faire <code>rbind(x[[1]], x[[2]], ..., x[[n]])</code> avec <code>x</code> une liste de taille <code>n</code>.</p>
</div>
<div id="la-fonction-sapply" class="section level3">
<h3>La fonction sapply</h3>
<p>La fonction <code data-pkg="base" data-rdoc="lapply">sapply</code> applique une fonction aux éléments d’un vecteur ou d’une liste et peut retourner un vecteur, une liste ou une matrice. Elle possède la syntaxe suivante :</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">sapply</span>(X, FUN, simplify, USE.NAMES)</a></code></pre></div>
<p>où <code>X</code> est le vecteur ou la liste auquel on souhaite appliquer la fonction <code>FUN</code>. Lorsque <code>simplify</code> vaut <code>FALSE</code>, le résultat est retourné sous forme de liste, exactement comme <code data-pkg="base">lapply</code> (la fonction <code data-pkg="base" data-rdoc="lapply">sapply</code> s’appuie sur la fonction <code data-pkg="base">lapply</code>). Lorsque <code>simplify</code> vaut <code>TRUE</code> (par défaut), le résultat est retourné dans une forme simplifiée, si cela est possible. Si tous les éléments retournés par la fonction <code>FUN</code> sont des scalaires, alors <code data-pkg="base" data-rdoc="lapply">sapply</code> retourne un vecteur ; sinon, si les éléments retournés ont la même taille, <code data-pkg="base" data-rdoc="lapply">sapply</code> retourne une matrice avec une colonne pour chaque élément de <code>X</code> auquel la fonction <code>FUN</code> est appliquée. Le paramètre <code>USE.NAMES</code>, quand il vaut <code>TRUE</code> (par défaut), et si <code>X</code> est de type character, utilise <code>X</code> comme nom pour le résultat, à moins que le résultat possède déjà des noms.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">(x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">beta =</span> <span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">logic =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb55-2" title="2">  <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)))</a></code></pre></div>
<pre><code>$a
 [1]  1  2  3  4  5  6  7  8  9 10

$beta
[1]  0.04978707  0.13533528  0.36787944  1.00000000
[5]  2.71828183  7.38905610 20.08553692

$logic
[1]  TRUE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># Application de la fonction quantile() à chaque élément pour</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="co"># obtenir la médiane et les quartiles Avec lapply()</span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="kw">lapply</span>(x, quantile)</a></code></pre></div>
<pre><code>$a
   0%   25%   50%   75%  100% 
 1.00  3.25  5.50  7.75 10.00 

$beta
         0%         25%         50%         75%        100% 
 0.04978707  0.25160736  1.00000000  5.05366896 20.08553692 

$logic
  0%  25%  50%  75% 100% 
 0.0  0.0  0.5  1.0  1.0 </code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># Avec sapply</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">sapply</span>(x, quantile)</a></code></pre></div>
<pre><code>         a        beta logic
0%    1.00  0.04978707   0.0
25%   3.25  0.25160736   0.0
50%   5.50  1.00000000   0.5
75%   7.75  5.05366896   1.0
100% 10.00 20.08553692   1.0</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># Exemple avec USE.NAMES</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw">sapply</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], nchar)</a></code></pre></div>
<pre><code>A B C 
1 1 1 </code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">sapply</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], nchar, <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>[1] 1 1 1</code></pre>
</div>
<div id="la-fonction-vapply" class="section level3">
<h3>La fonction vapply</h3>
<p>La fonction <code data-pkg="base" data-rdoc="lapply">vapply</code> est similaire à <code data-pkg="base" data-rdoc="lapply">sapply</code>, mais elle possède un type de valeurs spécifié, ce qui peut rendre l’utilisation plus sûre (et parfois plus rapide). Lorsqu’on lui fournit un <em>data.frame</em>, <code data-pkg="base" data-rdoc="lapply">vapply</code> retourne le même résultat que <code data-pkg="base" data-rdoc="lapply">sapply</code>. Cependant, quand on lui fournit une liste vide, <code data-pkg="base" data-rdoc="lapply">vapply</code> retourne un vecteur logique de longueur nulle (ce qui est plus sensé que la liste vide que returne <code data-pkg="base" data-rdoc="lapply">sapply</code>).</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">vapply</span>(X, FUN, FUN.VALUE, ..., USE.NAMES)</a></code></pre></div>
<p>avec <code>X</code>, <code>FUN</code>, <code>...</code> et <code>USE.NAMES</code> les mêmes paramètres que pour <code data-pkg="base" data-rdoc="lapply">sapply</code>. Le paramètre <code>FUN.VALUE</code> doit être un vecteur, un masque pour la valeur retournée par la fonction de <code>FUN</code>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="co"># Retourner le vecteur</span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">sapply</span>(cars, is.numeric)</a></code></pre></div>
<pre><code>speed  dist 
 TRUE  TRUE </code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">vapply</span>(cars, is.numeric, <span class="dt">FUN.VALUE =</span> <span class="kw">logical</span>(<span class="dv">1</span>))</a></code></pre></div>
<pre><code>speed  dist 
 TRUE  TRUE </code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># Avec la liste vide</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="kw">sapply</span>(<span class="kw">list</span>(), is.numeric)</a></code></pre></div>
<pre><code>list()</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">vapply</span>(<span class="kw">list</span>(), is.numeric, <span class="dt">FUN.VALUE =</span> <span class="kw">logical</span>(<span class="dv">1</span>))</a></code></pre></div>
<pre><code>logical(0)</code></pre>
</div>
<div id="la-fonction-apply" class="section level3">
<h3>La fonction apply</h3>
<p>La fonction <code data-pkg="base">apply</code> possède la syntaxe suivante :</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">apply</span>(X, MARGIN, FUN, ...)</a></code></pre></div>
<p>avec <code>X</code> une matrice ou un tableau, <code>MARGIN</code> indiquant si on souhaite appliquer la fonction <code>FUN</code> aux lignes <code>(MARGIN = 1)</code> ou aux colonnes <code>(MARGIN = 2)</code>, et <code>...</code> des paramètres supplémentaires éventuels à passer à la fonction <code>FUN</code>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">(X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">ncol =</span> <span class="dv">3</span>))</a></code></pre></div>
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># Somme par ligne</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">apply</span>(X, <span class="dt">MARGIN =</span> <span class="dv">1</span>, sum)</a></code></pre></div>
<pre><code>[1] 12 15 18</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co"># Somme par colonne</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="kw">apply</span>(X, <span class="dt">MARGIN =</span> <span class="dv">2</span>, sum)</a></code></pre></div>
<pre><code>[1]  6 15 24</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co"># Fonction définie par l&#39;utilisateur</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="kw">apply</span>(X, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">sum</span>(x)<span class="op">/</span><span class="kw">sum</span>(X))</a></code></pre></div>
<pre><code>[1] 0.2666667 0.3333333 0.4000000</code></pre>
</div>
<div id="la-fonction-tapply" class="section level3">
<h3>La fonction tapply</h3>
<p>La fonction <code data-pkg="base">tapply</code> s’applique à chaque cellule d’un tableau, sur des regroupements définis par les variables catégorielles fournies. La syntaxe est la suivante :</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">tapply</span>(X, INDEX, FUN, ..., simplify)</a></code></pre></div>
<p>avec <code>X</code> le tableau de données, <code>INDEX</code> une liste d’un ou plusieurs facteurs, chacun de même taille que <code>X</code>. Le paramètre <code>FUN</code> renseigne la fonction que l’on souhaite appliquer. Si <code>simplify</code> vaut <code>FALSE</code>, le résultat est un tableau de mode <em>list</em>. Sinon (par défaut), le résultat est un tableau de scalaires.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">head</span>(iris)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Petal.Length"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Petal.Width"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Species"],"name":[5],"type":["fctr"],"align":["left"]}],"data":[{"1":"5.1","2":"3.5","3":"1.4","4":"0.2","5":"setosa","_rn_":"1"},{"1":"4.9","2":"3.0","3":"1.4","4":"0.2","5":"setosa","_rn_":"2"},{"1":"4.7","2":"3.2","3":"1.3","4":"0.2","5":"setosa","_rn_":"3"},{"1":"4.6","2":"3.1","3":"1.5","4":"0.2","5":"setosa","_rn_":"4"},{"1":"5.0","2":"3.6","3":"1.4","4":"0.2","5":"setosa","_rn_":"5"},{"1":"5.4","2":"3.9","3":"1.7","4":"0.4","5":"setosa","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># Moyenne de la longueur des sépales par espèce</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">tapply</span>(iris<span class="op">$</span>Sepal.Length, iris<span class="op">$</span>Species, mean)</a></code></pre></div>
<pre><code>    setosa versicolor  virginica 
     5.006      5.936      6.588 </code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># Pour retourner le résultat sous forme de liste</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">tapply</span>(iris<span class="op">$</span>Sepal.Length, iris<span class="op">$</span>Species, mean, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>$setosa
[1] 5.006

$versicolor
[1] 5.936

$virginica
[1] 6.588</code></pre>
</div>
<div id="la-fonction-mapply" class="section level3">
<h3>La fonction mapply</h3>
<p>La fonction <code data-pkg="base">mapply</code> applique une fonction à plusieurs listes ou vecteurs. La syntaxe est la suivante :</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">mapply</span>(FUN, ..., MoreArgs, SIMPLIFY, USE.NAMES)</a></code></pre></div>
<p>avec <code>FUN</code> la fonction à appliquer aux vecteurs ou listes fournies (grâce à <code>...</code>), <code>MoreArgs</code> une liste de paramètres supplémentaires à fournir à la fonction à appliquer. Les paramètres <code>SIMPLIFY</code> et <code>USE.NAMES</code> ont le même usage que pour la fonction <code data-pkg="base" data-rdoc="lapply">sapply</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">(l1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>)))</a></code></pre></div>
<pre><code>$a
[1] 1 2 3 4 5

$b
[1]  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">(l2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">c =</span> <span class="kw">c</span>(<span class="dv">11</span><span class="op">:</span><span class="dv">15</span>), <span class="dt">d =</span> <span class="kw">c</span>(<span class="dv">16</span><span class="op">:</span><span class="dv">20</span>)))</a></code></pre></div>
<pre><code>$c
[1] 11 12 13 14 15

$d
[1] 16 17 18 19 20</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="co"># La somme des éléments correspondants de l1 et l2</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="kw">mapply</span>(sum, l1<span class="op">$</span>a, l1<span class="op">$</span>b, l2<span class="op">$</span>c, l2<span class="op">$</span>d)</a></code></pre></div>
<pre><code>[1] 34 38 42 46 50</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="co"># Attention au recyclage silencieux !</span></a>
<a class="sourceLine" id="cb96-2" title="2">(l1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">20</span>)))</a></code></pre></div>
<pre><code>$a
[1] 1 2 3 4 5

$b
 [1]  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">mapply</span>(sum, l1<span class="op">$</span>a, l1<span class="op">$</span>b, l2<span class="op">$</span>c, l2<span class="op">$</span>d)</a></code></pre></div>
<pre><code> [1] 34 38 42 46 50 39 43 47 51 55 44 48 52 56 60</code></pre>
</div>
</div>
<div id="la-fonction-vectorize" class="section level2">
<h2>La fonction Vectorize</h2>
<p>La fonction <code data-pkg="base">Vectorize</code> permet de convertir une fonction scalaire en une fonction vectorielle. Attention, cela ne permet pas d’améliorer la rapidité d’exécution du code. Par contre, son utilisation assez intuitive permet de gagner du temps. Il s’agit donc de faire l’arbitrage entre le temps passé à trouver un moyen élégant et efficace pour effectuer une opération en passant par de réels calculs vectoriels et le gain d’exécution que ce calcul vectoriel apporte vis-à-vis d’une boucle. La syntaxe de la <code data-pkg="base">Vectorize</code> est la suivante :</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">Vectorize</span>(FUN, vectorize.args, SIMPLIFY, USE.NAMES)</a></code></pre></div>
<p>avec <code>FUN</code> une fonction à appliquer, <code>vectorize.args</code> un vecteur de paramètres (de type caractère) qui devraient être vectorisés (par défaut, tous les paramètre de <code>FUN</code>). Les paramètres <code>SIMPLIFY</code> et <code>USE.NAMES</code> on le même emploi que dans la fonction <code data-pkg="base" data-rdoc="lapply">sapply</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, y) <span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb101-2" title="2"><span class="co"># On &#39;vectorise&#39; la fonction f</span></a>
<a class="sourceLine" id="cb101-3" title="3">vf &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(f, <span class="dt">SIMPLIFY =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb101-4" title="4"><span class="kw">f</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>[1] 1 2 3 1 2 3</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">vf</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>[[1]]
[1] 1 1

[[2]]
[1] 2 2

[[3]]
[1] 3 3</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># Vectorise seulement y, pas x</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="kw">vf</span>(<span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>[[1]]
[1] 1 2 3 1

[[2]]
[1] 1 2 3 2

[[3]]
[1] 1 2 3 3</code></pre>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copié !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments --->
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
