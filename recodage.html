<!DOCTYPE html>

<html lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Recodage de variables</title>

<script src="libs/header-attrs-2.25/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-86STMQ5JPT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-86STMQ5JPT');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnees.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <!--<li><a href="scraping.html.old">Scraping</a></li>-->
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe avec <strong>survey</strong></a></li>
                  <li><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="gtsummary.html">Tableaux statistiques avancés avec <strong>gtsummary</strong></a></li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="modeles.html">Quel type de modèles choisir ?</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Modèles à effets aléatoires (modèles mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de données longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
                  <li><a href="analyse-textuelle.html">Analyse textuelle</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">Étendre <strong>ggplot2</strong></a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="exemples-graphiques-avances.html">Exemples de graphiques avancés</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
                  <li><a href="autres-extensions-graphiques.html">Autres extensions graphiques</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation (dont <strong>purrr</strong>)</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres avec <strong>scales</strong></a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations mathématiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <li><a href="https://larmarange.github.io/guide-R/">guide-R</a></li>
        <li><a href="https://larmarange.github.io/webin-R/">webin-R</a></li>
        <li><a href="https://www.youtube.com/c/webinR"><i class="fa fa-youtube" aria-hidden="true"></i></a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div id="header">



<h1 class="title toc-ignore">Recodage de variables</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#renommer-des-variables" id="toc-renommer-des-variables">Renommer des variables</a></li>
<li><a href="#convertir-une-variable" id="toc-convertir-une-variable">Convertir une variable</a>
<ul>
<li><a href="#variable-numérique-ou-textuelle-en-facteur" id="toc-variable-numérique-ou-textuelle-en-facteur">Variable numérique ou textuelle en facteur</a></li>
<li><a href="#conversion-dun-facteur" id="toc-conversion-dun-facteur">Conversion d’un facteur</a></li>
</ul></li>
<li><a href="#labelled" id="toc-labelled">Conversion d’un vecteur labellisé</a>
<ul>
<li><a href="#quand-convertir-les-vecteurs-labellisés" id="toc-quand-convertir-les-vecteurs-labellisés">Quand convertir les vecteurs labellisés ?</a></li>
<li><a href="#convertir-un-vecteur-labellisé-en-facteur" id="toc-convertir-un-vecteur-labellisé-en-facteur">Convertir un vecteur labellisé en facteur</a></li>
<li><a href="#convertir-un-vecteur-labellisé-en-numérique-ou-en-texte" id="toc-convertir-un-vecteur-labellisé-en-numérique-ou-en-texte">Convertir un vecteur labellisé en numérique ou en texte</a></li>
<li><a href="#conversion-conditionnelle-en-facteurs" id="toc-conversion-conditionnelle-en-facteurs">Conversion conditionnelle en facteurs</a></li>
</ul></li>
<li><a href="#nettoyage" id="toc-nettoyage">Nettoyage</a></li>
<li><a href="#decouper_en_classes" id="toc-decouper_en_classes">Découper une variable numérique en classes</a></li>
<li><a href="#regrouper_modalites" id="toc-regrouper_modalites">Regrouper les modalités d’une variable</a></li>
<li><a href="#variables-calculées" id="toc-variables-calculées">Variables calculées</a></li>
<li><a href="#combiner-plusieurs-variables" id="toc-combiner-plusieurs-variables">Combiner plusieurs variables</a></li>
<li><a href="#variables-scores" id="toc-variables-scores">Variables scores</a></li>
<li><a href="#vérification-des-recodages" id="toc-vérification-des-recodages">Vérification des recodages</a></li>
<li><a href="#facteurs-et-forcats" id="toc-facteurs-et-forcats">Facteurs et forcats</a>
<ul>
<li><a href="#modifier-les-modalités-dune-variable-qualitative" id="toc-modifier-les-modalités-dune-variable-qualitative">Modifier les modalités d’une variable qualitative</a></li>
<li><a href="#ordonner-les-modalités-dune-variable-qualitative" id="toc-ordonner-les-modalités-dune-variable-qualitative">Ordonner les modalités d’une variable qualitative</a></li>
</ul></li>
<li><a href="#combiner-plusieurs-variables-1" id="toc-combiner-plusieurs-variables-1">Combiner plusieurs variables</a>
<ul>
<li><a href="#if_else" id="toc-if_else">if_else</a></li>
<li><a href="#case_when" id="toc-case_when">case_when</a></li>
</ul></li>
<li><a href="#recodage-et-data.table" id="toc-recodage-et-data.table">Recodage et data.table</a></li>
</ul>
</div>

<div class="guide-R">
<p>Une version actualisée de ce chapitre est disponible sur <strong>guide-R</strong> : <a href="https://larmarange.github.io/guide-R/manipulation/facteurs.html">Facteurs et forcats</a> &amp; <a href="https://larmarange.github.io/guide-R/manipulation/combiner-variables.html">Combiner plusieurs variables</a></p>
</div>
<div class="note">
<p>La version originale de ce chapitre a été écrite par Julien Barnier dans le cadre du support de cours <a href="https://github.com/juba/intro-r">Introduction à R</a>.</p>
</div>
<div class="webin-R">
<p>Ce chapitre est évoqué dans le webin-R #05 (recoder des variables) sur <a href="https://youtu.be/CokvTbtWdwc">YouTube</a>.</p>
<p>Ce chapitre est évoqué dans le webin-R #06 (régression logistique partie 1) sur <a href="https://youtu.be/-bdMv2aAqUY">YouTube</a>.</p>
</div>
<p>Le <dfn>recodage de variables</dfn><dfn data-index="variable, recodage"></dfn> est une opération extrêmement fréquente lors du traitement d’enquête. Celui-ci utilise soit l’une des formes d’indexation décrites précédemment, soit des fonctions <em>ad hoc</em> de <strong>R</strong>.</p>
<p>On passe ici en revue différents types de recodage parmi les plus courants. Les exemples s’appuient, comme précédemment, sur l’extrait de l’enquête <em>Histoire de vie</em> :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(hdv2003)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>d <span class="ot">&lt;-</span> hdv2003</span></code></pre></div>
<div id="renommer-des-variables" class="section level2 hasAnchor">
<h2 class="hasAnchor">Renommer des variables<a href="#renommer-des-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Une opération courante lorsqu’on a importé des variables depuis une source de données externe consiste à renommer les variables importées. Sous <strong>R</strong> les noms de variables doivent être à la fois courts et explicites.</p>
<div class="important">
<p>Les noms de variables peuvent contenir des lettres, des chiffres (mais ils ne peuvent pas commencer par un chiffre), les symboles <code>.</code> et <code>_</code> et doivent commencer par une lettre. <strong>R</strong> fait la différence entre les majuscules et les minuscules, ce qui signifie que <var>x</var> et <var>X</var> sont deux noms de variable différents. On évitera également d’utiliser des caractères accentués dans les noms de variable. Comme les espaces ne sont pas autorisés, on pourra les remplacer par un point ou un tiret bas.</p>
</div>
<p>On peut lister les noms des variables d’un tableau de données (<em>data.frame</em>) à l’aide de la fonction <code data-pkg="base">names</code> :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">names</span>(d)</span></code></pre></div>
<pre><code> [1] &quot;id&quot;            &quot;age&quot;           &quot;sexe&quot;         
 [4] &quot;nivetud&quot;       &quot;poids&quot;         &quot;occup&quot;        
 [7] &quot;qualif&quot;        &quot;freres.soeurs&quot; &quot;clso&quot;         
[10] &quot;relig&quot;         &quot;trav.imp&quot;      &quot;trav.satisf&quot;  
[13] &quot;hard.rock&quot;     &quot;lecture.bd&quot;    &quot;peche.chasse&quot; 
[16] &quot;cuisine&quot;       &quot;bricol&quot;        &quot;cinema&quot;       
[19] &quot;sport&quot;         &quot;heures.tv&quot;    </code></pre>
<p>Si l’on utilise <code class="pkg">dplyr</code> (voir <a href="manipuler-les-donnees-avec-dplyr.html">chapitre dédié</a>), on peut facilement renommer une variable avec <code data-pkg="dplyr">rename</code> :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">bricolage =</span> bricol, <span class="at">religion =</span> relig)</span></code></pre></div>
<div class="note">
<p>La fonction <code data-pkg="base">names</code> peut également être utilisée pour renommer l’ensemble des variables. Si par exemple on souhaitait passer les noms de toutes les variables en majuscules, on pourrait faire :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>d.maj <span class="ot">&lt;-</span> d</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">names</span>(d.maj) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;AGE&quot;</span>, <span class="st">&quot;SEXE&quot;</span>, <span class="st">&quot;NIVETUD&quot;</span>, <span class="st">&quot;POIDS&quot;</span>, <span class="st">&quot;OCCUP&quot;</span>, <span class="st">&quot;QUALIF&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="st">&quot;FRERES.SOEURS&quot;</span>, <span class="st">&quot;CLSO&quot;</span>, <span class="st">&quot;RELIG&quot;</span>, <span class="st">&quot;TRAV.IMP&quot;</span>, <span class="st">&quot;TRAV.SATISF&quot;</span>, <span class="st">&quot;HARD.ROCK&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="st">&quot;LECTURE.BD&quot;</span>, <span class="st">&quot;PECHE.CHASSE&quot;</span>, <span class="st">&quot;CUISINE&quot;</span>, <span class="st">&quot;BRICOL&quot;</span>, <span class="st">&quot;CINEMA&quot;</span>, <span class="st">&quot;SPORT&quot;</span>, <span class="st">&quot;HEURES.TV&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">summary</span>(d.maj<span class="sc">$</span>SEXE)</span></code></pre></div>
<pre><code>Homme Femme 
  899  1101 </code></pre>
<p>Ce type de renommage peut être utile lorsqu’on souhaite passer en revue tous les noms de variables d’un fichier importé pour les corriger le cas échéant. Pour faciliter un peu ce travail pas forcément passionnant, on peut utiliser la fonction <code data-pkg="base">dput</code> :</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">dput</span>(<span class="fu">names</span>(d))</span></code></pre></div>
<pre><code>c(&quot;id&quot;, &quot;age&quot;, &quot;sexe&quot;, &quot;nivetud&quot;, &quot;poids&quot;, &quot;occup&quot;, &quot;qualif&quot;, 
&quot;freres.soeurs&quot;, &quot;clso&quot;, &quot;relig&quot;, &quot;trav.imp&quot;, &quot;trav.satisf&quot;, 
&quot;hard.rock&quot;, &quot;lecture.bd&quot;, &quot;peche.chasse&quot;, &quot;cuisine&quot;, &quot;bricol&quot;, 
&quot;cinema&quot;, &quot;sport&quot;, &quot;heures.tv&quot;)</code></pre>
<p>On obtient en résultat la liste des variables sous forme de vecteur déclaré. On n’a plus alors qu’à copier/coller cette chaîne, rajouter <code>names(d) &lt;-</code> devant et modifier un à un les noms des variables.</p>
<p>Si on souhaite seulement modifier le nom d’une variable, on peut utiliser la fonction <code data-pkg="questionr">rename.variable</code> de l’extension <code class="pkg">questionr</code>. Celle-ci prend en argument le tableau de données, le nom actuel de la variable et le nouveau nom. Par exemple, si on veut renommer la variable <var>bricol</var> du tableau de données <code>d</code> en <var>bricolage</var> :</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">rename.variable</span>(d, <span class="st">&quot;bricol&quot;</span>, <span class="st">&quot;bricolage&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>bricolage)</span></code></pre></div>
<pre><code>
 Non  Oui 
1147  853 </code></pre>
</div>
</div>
<div id="convertir-une-variable" class="section level2 hasAnchor">
<h2 class="hasAnchor">Convertir une variable<a href="#convertir-une-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il peut arriver qu’on veuille transformer une variable d’un type dans un autre.</p>
<div id="variable-numérique-ou-textuelle-en-facteur" class="section level3 hasAnchor">
<h3 class="hasAnchor">Variable numérique ou textuelle en facteur<a href="#variable-numérique-ou-textuelle-en-facteur" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Par exemple, on peut considérer que la variable numérique <var>freres.soeurs</var> est une « fausse » variable numérique et qu’une représentation sous forme de facteur serait plus adéquate. Dans ce cas il suffit de faire appel à la fonction <code data-pkg="base">factor</code> :</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>d<span class="sc">$</span>fs.fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>freres.soeurs)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">levels</span>(d<span class="sc">$</span>fs.fac)</span></code></pre></div>
<pre><code> [1] &quot;0&quot;  &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot;
[12] &quot;11&quot; &quot;12&quot; &quot;13&quot; &quot;14&quot; &quot;15&quot; &quot;16&quot; &quot;18&quot; &quot;22&quot;</code></pre>
<p>La conversion d’une variable caractères en facteur se fait de la même manière.</p>
<p>La conversion d’un facteur ou d’une variable numérique en variable caractères peut se faire à l’aide de la fonction <code data-pkg="base" data-rdoc="character">as.character</code> :</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>d<span class="sc">$</span>fs.char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(d<span class="sc">$</span>freres.soeurs)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>d<span class="sc">$</span>qualif.char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(d<span class="sc">$</span>qualif)</span></code></pre></div>
</div>
<div id="conversion-dun-facteur" class="section level3 hasAnchor">
<h3 class="hasAnchor">Conversion d’un facteur<a href="#conversion-dun-facteur" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La conversion d’un facteur en caractères est fréquemment utilisé lors des recodages du fait qu’il est impossible d’ajouter de nouvelles modalités à un facteur de cette manière. Par exemple, la première des commandes suivantes génère un message d’avertissement, tandis que les deux autres fonctionnent :</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>d.temp <span class="ot">&lt;-</span> d</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>d.temp<span class="sc">$</span>qualif[d.temp<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Ouvrier specialise&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span></code></pre></div>
<pre><code>Warning in `[&lt;-.factor`(`*tmp*`, d.temp$qualif == &quot;Ouvrier
specialise&quot;, : niveau de facteur incorrect, NAs générés</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>d<span class="sc">$</span>qualif.char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(d<span class="sc">$</span>qualif)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>d<span class="sc">$</span>qualif.char[d<span class="sc">$</span>qualif.char <span class="sc">==</span> <span class="st">&quot;Ouvrier specialise&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span></code></pre></div>
<p>Dans le premier cas, le message d’avertissement indique que toutes les modalités « Ouvrier specialise » de notre variable <var>qualif</var> ont été remplacées par des valeurs manquantes <code>NA</code>.</p>
<p>Enfin, une variable de type caractères dont les valeurs seraient des nombres peut être convertie en variable numérique avec la fonction <code data-pkg="base" data-rdoc="numeric">as.numeric</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;3.1415&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5.6&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;4&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>v</span></code></pre></div>
<pre><code>[1] &quot;1&quot;      &quot;3.1415&quot; &quot;4&quot;      &quot;5.6&quot;    &quot;1&quot;      &quot;4&quot;     </code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">as.numeric</span>(v)</span></code></pre></div>
<pre><code>[1] 1.000 3.142 4.000 5.600 1.000 4.000</code></pre>
<div class="important">
<p>Lorsque l’on convertit un facteur avec <code data-pkg="base" data-rdoc="numeric">as.numeric</code>, on obtient le numéro de chaque facteur (première modalité, seconde modalité, etc.). Si la valeur numérique qui nous intéresse est en fait contenu dans le nom des modalités, il faut convertir au préalable notre facteur en variable textuelle.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>vf <span class="ot">&lt;-</span> <span class="fu">factor</span>(v)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>vf</span></code></pre></div>
<pre><code>[1] 1      3.1415 4      5.6    1      4     
Levels: 1 3.1415 4 5.6</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">as.numeric</span>(vf)</span></code></pre></div>
<pre><code>[1] 1 2 3 4 1 3</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(vf))</span></code></pre></div>
<pre><code>[1] 1.000 3.142 4.000 5.600 1.000 4.000</code></pre>
<p>ATTENTION : la valeur numérique associée à chaque étiquette d’un facteur change lorsque l’on modifie l’ordre des étiquettes d’un facteur. Dès lors, il est <strong>fortement déconseillé</strong> de convertir un facteur en variable numérique.</p>
</div>
</div>
</div>
<div id="labelled" class="section level2 hasAnchor">
<h2 class="hasAnchor">Conversion d’un vecteur labellisé<a href="#labelled" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nous avons abordé dans un <a href="facteurs-et-vecteurs-labellises.html#labelled">chapitre précédent</a> la gestion de données labellisées à l’aide de l’extension <code class="pkg">labelled</code>. Les vecteurs labellisés sont beaucoup plus souples que les facteurs lors de la préparation des données, puisque la liste des modalités autorisées n’est pas fixée à l’avance. De plus, cela permet également de documenter au-fur-et-à-mesure les nouvelles variables que l’on créé.</p>
<p><strong>Nous verrons dans les chapitres d’analyse, notamment quand il s’agit de calculer des modèles, qu’il est nécessaire de coder les variables catégorielles sous forme de facteurs. Et il est préférable pour les variables continues de leur retirer la classe <code>haven_labelled</code></strong>.</p>
<div id="quand-convertir-les-vecteurs-labellisés" class="section level3 hasAnchor">
<h3 class="hasAnchor">Quand convertir les vecteurs labellisés ?<a href="#quand-convertir-les-vecteurs-labellisés" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La classe <code>haven_labelled</code> permets d’ajouter des métadonnées aux variables sous la forme d’étiquettes de valeurs. Lorsque les données sont importées depuis <strong>SAS</strong>, <strong>SPSS</strong> ou <strong>Stata</strong>, cela permet notamment de conserver le codage original du fichier importé.</p>
<p>Mais il faut noter que ces <em>étiquettes de valeur</em> n’indique pas pour autant de manière systématique le type de variable (catégorielle ou continue). Les vecteurs labellisés n’ont donc pas vocation à être utilisés pour l’analyse, notamment le calcul de modèles statistiques. Ils doivent être convertis en facteurs (pour les variables catégorielles) ou en vecteurs numériques (pour les variables continues).</p>
<p>La question qui peut se poser est donc de choisirà quel moment cette conversion doit avoir lieu dans un processus d’analyse. On peut considérer deux approches principales.</p>
<div class="float">
<img src="images/conversion_labelled.png" style="width:100.0%" alt="Deux approches possibles" />
<div class="figcaption">Deux approches possibles</div>
</div>
<p>Dans l’<strong>approche A</strong>, les vecteurs labellisés sont convertis juste après l’import des données, en utilisant les fonctions <code data-pkg="labelled">unlabelled</code>, <code data-pkg="labelled">to_factor</code> ou <code data-pkg="base">unclass</code> qui sont présentées ci-après. Dès lors, toute la partie de nettoyage et de recodage des données se fera en utilisant les fonctions classiques de <strong>R</strong>.</p>
<p>Dans l’<strong>approche B</strong>, les vecteurs labellisés sont conservés pour l’étape de nettoyage et de recodage des données. Dans ce cas là, on pourra avoir recours aux fonctions de l’extension <code class="pkg">labelled</code> qui facilitent la gestion des données labellisées. Cette approche est particulièrement intéressante quand (i) on veut pouvoir se référer au dictionnaire de codification fourni avec les données sources et donc on veut conserver le codage original et/ou (ii) quand les données devront faire l’objet d’un réexport après transformation. Par contre, comme dans l’approche A, il faudra prévoir une conversion des variables labellisées au moment de l’analyse.</p>
</div>
<div id="convertir-un-vecteur-labellisé-en-facteur" class="section level3 hasAnchor">
<h3 class="hasAnchor">Convertir un vecteur labellisé en facteur<a href="#convertir-un-vecteur-labellisé-en-facteur" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il est très facile de convertir un vecteur labellisé en facteur à l’aide la fonction <code data-pkg="labelled">to_factor</code> de l’extension <code class="pkg">labelled</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">labelled</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="cn">NA</span>), <span class="fu">c</span>(<span class="at">oui =</span> <span class="dv">1</span>, <span class="st">&quot;peut-être&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="at">non =</span> <span class="dv">3</span>, <span class="st">&quot;ne sait pas&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>v</span></code></pre></div>
<pre><code>&lt;labelled&lt;double&gt;[7]&gt;
[1]  1  2  9  3  3  2 NA

Labels:
 value       label
     1         oui
     2   peut-être
     3         non
     9 ne sait pas</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">to_factor</span>(v)</span></code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas non        
[5] non         peut-être   &lt;NA&gt;       
Levels: oui peut-être non ne sait pas</code></pre>
<p>Il possible d’indiquer si l’on souhaite, comme étiquettes du facteur, utiliser les étiquettes de valeur (par défaut), les valeurs elles-mêmes, ou bien les étiquettes de valeurs préfixées par la valeur d’origine indiquée entre crochets.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">to_factor</span>(v, <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas non        
[5] non         peut-être   &lt;NA&gt;       
Levels: oui peut-être non ne sait pas</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">to_factor</span>(v, <span class="st">&quot;v&quot;</span>)</span></code></pre></div>
<pre><code>[1] 1    2    9    3    3    2    &lt;NA&gt;
Levels: 1 2 3 9</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">to_factor</span>(v, <span class="st">&quot;p&quot;</span>)</span></code></pre></div>
<pre><code>[1] [1] oui         [2] peut-être   [9] ne sait pas
[4] [3] non         [3] non         [2] peut-être  
[7] &lt;NA&gt;           
4 Levels: [1] oui [2] peut-être ... [9] ne sait pas</code></pre>
<p>Par défaut, les étiquettes du facteur seront triés selon l’ordre des étiquettes de valeur. Mais cela peut être modifié avec l’argument <code>sort_levels</code> si l’on préfère trier selon les valeurs ou selon l’ordre alphabétique des étiquettes.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">to_factor</span>(v, <span class="at">sort_levels =</span> <span class="st">&quot;v&quot;</span>)</span></code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas non        
[5] non         peut-être   &lt;NA&gt;       
Levels: oui peut-être non ne sait pas</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">to_factor</span>(v, <span class="at">sort_levels =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<pre><code>[1] oui         peut-être   ne sait pas non        
[5] non         peut-être   &lt;NA&gt;       
Levels: ne sait pas non oui peut-être</code></pre>
<p>D’autres options sont disponibles. On se réferra à la documentation complète de la fonction.</p>
</div>
<div id="convertir-un-vecteur-labellisé-en-numérique-ou-en-texte" class="section level3 hasAnchor">
<h3 class="hasAnchor">Convertir un vecteur labellisé en numérique ou en texte<a href="#convertir-un-vecteur-labellisé-en-numérique-ou-en-texte" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour rappel, il existe deux types de vecteurs labellisés : des vecteurs numériques labellisés (<code>x</code> dans l’exemple ci-dessous) et des vecteurs textuels labellisés (<code>x</code> dans l’exemple ci-dessous).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">labelled</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="cn">NA</span>), <span class="fu">c</span>(<span class="at">oui =</span> <span class="dv">1</span>, <span class="st">&quot;peut-être&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="at">non =</span> <span class="dv">3</span>, <span class="st">&quot;ne sait pas&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">labelled</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;f&quot;</span>), <span class="fu">c</span>(<span class="at">femme =</span> <span class="st">&quot;f&quot;</span>, <span class="at">homme =</span> <span class="st">&quot;h&quot;</span>))</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>&lt;labelled&lt;double&gt;[7]&gt;
[1]  1  2  9  3  3  2 NA

Labels:
 value       label
     1         oui
     2   peut-être
     3         non
     9 ne sait pas</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>&lt;labelled&lt;character&gt;[4]&gt;
[1] f f h f

Labels:
 value label
     f femme
     h homme</code></pre>
<p>Pour leur retirer leur caractère labellisé et revenir à leur classe d’origine, on peut utiliser la fonction <code data-pkg="base">unclass</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">unclass</span>(x)</span></code></pre></div>
<pre><code>[1]  1  2  9  3  3  2 NA
attr(,&quot;labels&quot;)
        oui   peut-être         non ne sait pas 
          1           2           3           9 </code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">unclass</span>(y)</span></code></pre></div>
<pre><code>[1] &quot;f&quot; &quot;f&quot; &quot;h&quot; &quot;f&quot;
attr(,&quot;labels&quot;)
femme homme 
  &quot;f&quot;   &quot;h&quot; </code></pre>
<p>À noter que dans ce cas-là, les étiquettes sont conservées comme attributs du vecteur.</p>
<p>Une alternative est d’utiliser <code data-pkg="labelled">remove_labels</code> qui supprimera toutes les étiquettes, y compris les étiquettes de variable. Pour conserver les étiquettes de variables et ne supprimer que les étiquettes de valeurs, on indiquera <code>keep_var_label = TRUE</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">var_label</span>(x) <span class="ot">&lt;-</span> <span class="st">&quot;Etiquette de variable&quot;</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">remove_labels</span>(x)</span></code></pre></div>
<pre><code>[1]  1  2  9  3  3  2 NA</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">remove_labels</span>(x, <span class="at">keep_var_label =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1]  1  2  9  3  3  2 NA
attr(,&quot;label&quot;)
[1] &quot;Etiquette de variable&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">remove_labels</span>(y)</span></code></pre></div>
<pre><code>[1] &quot;f&quot; &quot;f&quot; &quot;h&quot; &quot;f&quot;</code></pre>
<p>Dans le cas d’un vecteur numérique labellisé que l’on souhaiterait convertir en variable textuelle, on pourra utiliser <code data-pkg="labelled">to_character</code> à la place de <code data-pkg="labelled">to_factor</code> qui comme sa soeur utilisera les étiquettes de valeurs.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">to_character</span>(x)</span></code></pre></div>
<pre><code>[1] &quot;oui&quot;         &quot;peut-être&quot;   &quot;ne sait pas&quot; &quot;non&quot;        
[5] &quot;non&quot;         &quot;peut-être&quot;   NA           
attr(,&quot;label&quot;)
[1] &quot;Etiquette de variable&quot;</code></pre>
</div>
<div id="conversion-conditionnelle-en-facteurs" class="section level3 hasAnchor">
<h3 class="hasAnchor">Conversion conditionnelle en facteurs<a href="#conversion-conditionnelle-en-facteurs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il n’est pas toujours possible de déterminer la nature d’une variable (continue ou catégorielle) juste à partir de la présence ou l’absence d’étiquettes de valeur. En effet, on peut utiliser des étiquettes de valeur dans le cadre d’une variable continue pour indiquer certaines valeurs spécifiques.</p>
<p>Une bonne pratique est de vérifier chaque variable inclue dans une analyse, une à une.</p>
<p>Cependant, une règle qui fonctionne dans 90% des cas est de convertir un vecteur labellisé en facteur seulement si toutes les valeurs observées dans le vecteur disposent d’une étiquette de valeur correspondante. C’est ce que propose la fonction <code data-pkg="labelled">unlabelled</code> qui peut même être appliqué à tout un tableau de données. Par défaut, elle fonctionne ainsi :</p>
<ol style="list-style-type: decimal">
<li>les variables non labellisées restent inchangées (variables <em>f</em> et <em>g</em> dans l’exemple ci-dessous);</li>
<li>si toutes les valeurs observées d’une variable labellisées, elles sont converties en facteurs (variables <em>b</em> et <em>c</em>);</li>
<li>sinon, on leur applique <code data-pkg="base">unclass</code> (variables <em>a</em>, <em>d</em> et <em>e</em>).</li>
</ol>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">labelled</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">No =</span> <span class="dv">1</span>, <span class="at">Yes =</span> <span class="dv">2</span>)),</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">labelled</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">No =</span> <span class="dv">1</span>, <span class="at">Yes =</span> <span class="dv">2</span>, <span class="at">DK =</span> <span class="dv">3</span>)),</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">labelled</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">No =</span> <span class="dv">1</span>, <span class="at">Yes =</span> <span class="dv">2</span>, <span class="at">DK =</span> <span class="dv">3</span>)),</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">labelled</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">No =</span> <span class="st">&quot;a&quot;</span>, <span class="at">Yes =</span> <span class="st">&quot;b&quot;</span>)),</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>  <span class="at">e =</span> <span class="fu">labelled_spss</span>(</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">No =</span> <span class="dv">1</span>, <span class="at">Yes =</span> <span class="dv">2</span>),</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>    <span class="at">na_values =</span> <span class="dv">9</span></span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>  ),</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>  <span class="at">f =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>  <span class="at">g =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2020-01-01&quot;</span>, <span class="st">&quot;2020-02-01&quot;</span>, <span class="st">&quot;2020-03-01&quot;</span>, <span class="st">&quot;2020-04-01&quot;</span>))</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>)</span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(df)</span></code></pre></div>
<pre><code>Rows: 4
Columns: 7
$ a &lt;dbl+lbl&gt; 1, 1, 2, 3
$ b &lt;dbl+lbl&gt; 1, 1, 2, 3
$ c &lt;dbl+lbl&gt; 1, 1, 2, 2
$ d &lt;chr+lbl&gt; &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;
$ e &lt;hvn_lbl_&gt; 1, 9, 1, 2
$ f &lt;int&gt; 1, 2, 3, 4
$ g &lt;date&gt; 2020-01-01, 2020-02-01, 2020-03-01, 2020-04-01</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(<span class="fu">unlabelled</span>(df))</span></code></pre></div>
<pre><code>Rows: 4
Columns: 7
$ a &lt;dbl&gt; 1, 1, 2, 3
$ b &lt;fct&gt; No, No, Yes, DK
$ c &lt;fct&gt; No, No, Yes, Yes
$ d &lt;chr&gt; &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;
$ e &lt;fct&gt; No, NA, No, Yes
$ f &lt;int&gt; 1, 2, 3, 4
$ g &lt;date&gt; 2020-01-01, 2020-02-01, 2020-03-01, 2020-04-01</code></pre>
<p>On peut indiquer certaines options, par exemple <code>drop_unused_labels = TRUE</code> pour supprimer des facteurs créés les niveaux non observées dans les données (voir la variable <em>c</em>) ou <code>user_na_to_na = TRUE</code> pour convertir les valeurs manquantes de type SPSS en <code>NA</code> (voir la variable <em>e</em>, notez qu’ici, du fait de cette conversion, toutes les valeurs ont une étiquette et la variable est alors convertie en facteur.)</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(<span class="fu">unlabelled</span>(df, <span class="at">levels =</span> <span class="st">&quot;prefixed&quot;</span>))</span></code></pre></div>
<pre><code>Rows: 4
Columns: 7
$ a &lt;dbl&gt; 1, 1, 2, 3
$ b &lt;fct&gt; [1] No, [1] No, [2] Yes, [3] DK
$ c &lt;fct&gt; [1] No, [1] No, [2] Yes, [2] Yes
$ d &lt;chr&gt; &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;
$ e &lt;fct&gt; [1] No, NA, [1] No, [2] Yes
$ f &lt;int&gt; 1, 2, 3, 4
$ g &lt;date&gt; 2020-01-01, 2020-02-01, 2020-03-01, 2020-04-01</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(<span class="fu">unlabelled</span>(df, <span class="at">user_na_to_na =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>Rows: 4
Columns: 7
$ a &lt;dbl&gt; 1, 1, 2, 3
$ b &lt;fct&gt; No, No, Yes, DK
$ c &lt;fct&gt; No, No, Yes, Yes
$ d &lt;chr&gt; &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;
$ e &lt;fct&gt; No, NA, No, Yes
$ f &lt;int&gt; 1, 2, 3, 4
$ g &lt;date&gt; 2020-01-01, 2020-02-01, 2020-03-01, 2020-04-01</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(<span class="fu">unlabelled</span>(df, <span class="at">drop_unused_labels =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>Rows: 4
Columns: 7
$ a &lt;dbl&gt; 1, 1, 2, 3
$ b &lt;fct&gt; No, No, Yes, DK
$ c &lt;fct&gt; No, No, Yes, Yes
$ d &lt;chr&gt; &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;
$ e &lt;fct&gt; No, NA, No, Yes
$ f &lt;int&gt; 1, 2, 3, 4
$ g &lt;date&gt; 2020-01-01, 2020-02-01, 2020-03-01, 2020-04-01</code></pre>
</div>
</div>
<div id="nettoyage" class="section level2 hasAnchor">
<h2 class="hasAnchor">Nettoyage<a href="#nettoyage" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’extension <code class="pkg">cleaner</code> propose plusieurs fonctions utiles lorsque l’on doit nettoyer une variable mal encodées.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">library</span>(cleaner)</span></code></pre></div>
<pre><code>
Attachement du package : &#39;cleaner&#39;</code></pre>
<pre><code>L&#39;objet suivant est masqué depuis &#39;package:questionr&#39;:

    freq</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co"># Recoder en valeurs logiques</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="fu">clean_logical</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Invalid&quot;</span>, <span class="st">&quot;Unknown&quot;</span>))</span></code></pre></div>
<pre><code>[1]  TRUE FALSE    NA    NA</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">clean_logical</span>(<span class="fu">c</span>(<span class="st">&quot;Oui, c&#39;est ca&quot;</span>, <span class="st">&quot;Non, pas encore&quot;</span>))</span></code></pre></div>
<pre><code>[1]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">clean_logical</span>(<span class="fu">c</span>(<span class="st">&quot;ya :)&quot;</span>, <span class="st">&quot;tidak :(&quot;</span>))</span></code></pre></div>
<pre><code>[1]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">clean_logical</span>(</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Unknown&quot;</span>),</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="at">true =</span> <span class="st">&quot;pos&quot;</span>,</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  <span class="at">false =</span> <span class="st">&quot;neg&quot;</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>[1]  TRUE FALSE    NA    NA</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="co"># Valeurs numériques</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="fu">clean_numeric</span>(<span class="fu">c</span>(</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>  <span class="st">&quot;$ 12,345.67&quot;</span>,</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  <span class="st">&quot;€ 12.345,67&quot;</span>,</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  <span class="st">&quot;12,345.67&quot;</span>,</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>  <span class="st">&quot;12345,67&quot;</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>[1] 12346 12346 12346 12346</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">clean_numeric</span>(<span class="st">&quot;qwerty123456&quot;</span>)</span></code></pre></div>
<pre><code>[1] 123456</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">clean_numeric</span>(<span class="st">&quot;Positive (0.143)&quot;</span>)</span></code></pre></div>
<pre><code>[1] 0.143</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="co"># Facteurs</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>gender_age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;male 0-50&quot;</span>, <span class="st">&quot;male 50+&quot;</span>, <span class="st">&quot;female 0-50&quot;</span>, <span class="st">&quot;female 50+&quot;</span>)</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>gender_age</span></code></pre></div>
<pre><code>[1] &quot;male 0-50&quot;   &quot;male 50+&quot;    &quot;female 0-50&quot; &quot;female 50+&quot; </code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">clean_factor</span>(gender_age, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>))</span></code></pre></div>
<pre><code>[1] M M F F
Levels: M F</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">clean_factor</span>(gender_age, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))</span></code></pre></div>
<pre><code>[1] Male   Male   Female Female
Levels: Male Female</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">clean_factor</span>(gender_age, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;0-50&quot;</span>, <span class="st">&quot;50+&quot;</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1] 0-50 50+  0-50 50+ 
Levels: 0-50 &lt; 50+</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">clean_factor</span>(</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>  gender_age,</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>    <span class="st">&quot;female&quot;</span> <span class="ot">=</span> <span class="st">&quot;Group A&quot;</span>,</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>    <span class="st">&quot;male 50+&quot;</span> <span class="ot">=</span> <span class="st">&quot;Group B&quot;</span>,</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>    <span class="st">&quot;.*&quot;</span> <span class="ot">=</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>  )</span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>[1] Other   Group B Group A Group A
Levels: Group A Group B Other</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co"># Dates</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="fu">clean_Date</span>(<span class="st">&quot;12-06-2012&quot;</span>)</span></code></pre></div>
<pre><code>(assuming format &#39;dd-mm-yyyy&#39;)</code></pre>
<pre><code>[1] &quot;2012-06-12&quot;</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">clean_Date</span>(<span class="dv">38071</span>)</span></code></pre></div>
<pre><code>(assuming Excel format)</code></pre>
<pre><code>[1] &quot;2004-03-25&quot;</code></pre>
<div class="important">
<p>L’extension <code class="pkg">cleaner</code> propose également une fonction <code data-pkg="cleaner">freq</code> qui peut rentrer en conflit avec la fonction <code data-pkg="questionr">freq</code> de <code class="pkg">questionr</code>. Dans ce cas, on pourra soit appeler explicitement la version de <code class="pkg">questionr</code> avec l’écriture <code>questionr::freq()</code>. Une autre possibilité est de <q>décharger</q> (le contraire de charger en mémoire) l’extension <code class="pkg">cleaner</code> une fois que l’on en n’a plus besoin.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:cleaner&quot;</span>, <span class="at">unload =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="decouper_en_classes" class="section level2 hasAnchor">
<h2 class="hasAnchor">Découper une variable numérique en classes<a href="#decouper_en_classes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le premier type de recodage consiste à découper une variable de type numérique en un certain nombre de classes. On utilise pour cela la fonction <code data-pkg="base">cut</code>.</p>
<p>Celle-ci prend, outre la variable à découper, un certain nombre d’arguments :</p>
<ul>
<li><code>breaks</code> indique soit le nombre de classes souhaité, soit, si on lui fournit un vecteur, les limites des classes ;</li>
<li><code>labels</code> permet de modifier les noms de modalités attribués aux classes ;</li>
<li><code>include.lowest</code> et <code>right</code> influent sur la manière dont les valeurs situées à la frontière des classes seront inclues ou exclues ;</li>
<li><code>dig.lab</code> indique le nombre de chiffres après la virgule à conserver dans les noms de modalités.</li>
</ul>
<p>Prenons tout de suite un exemple et tentons de découper notre variable <var>age</var> en cinq classes et de placer le résultat dans une nouvelle variable nommée <var>age5cl</var> :</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>d<span class="sc">$</span>age5cl <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="dv">5</span>)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age5cl)</span></code></pre></div>
<pre><code>
(17.9,33.8] (33.8,49.6] (49.6,65.4] (65.4,81.2] (81.2,97.1] 
        454         628         556         319          43 </code></pre>
<p>Par défaut <strong>R</strong> nous a bien créé cinq classes d’amplitudes égales. La première classe va de 16,9 à 32,2 ans (en fait de 17 à 32), etc.</p>
<p>Les frontières de classe seraient plus présentables si elles utilisaient des nombres ronds. On va donc spécifier manuellement le découpage souhaité, par tranches de 20 ans :</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>d<span class="sc">$</span>age20 <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>))</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age20)</span></code></pre></div>
<pre><code>
  (0,20]  (20,40]  (40,60]  (60,80] (80,100] 
      72      660      780      436       52 </code></pre>
<p>On aurait pu tenir compte des âges extrêmes pour la première et la dernière valeur :</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">range</span>(d<span class="sc">$</span>age)</span></code></pre></div>
<pre><code>[1] 18 97</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>d<span class="sc">$</span>age20 <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>))</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age20)</span></code></pre></div>
<pre><code>
(18,20] (20,40] (40,60] (60,80] (80,97] 
     55     660     780     436      52 </code></pre>
<p>Les symboles dans les noms attribués aux classes ont leur importance : <code>(</code> signifie que la frontière de la classe est exclue, tandis que <code>[</code> signifie qu’elle est incluse. Ainsi, <code>(20,40]</code> signifie « strictement supérieur à 20 et inférieur ou égal à 40 ».</p>
<p>On remarque que du coup, dans notre exemple précédent, la valeur minimale, 18, est exclue de notre première classe, et qu’une observation est donc absente de ce découpage. Pour résoudre ce problème on peut soit faire commencer la première classe à 17, soit utiliser l’option <code>include.lowest=TRUE</code> :</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>d<span class="sc">$</span>age20 <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>))</span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age20)</span></code></pre></div>
<pre><code>
(17,20] (20,40] (40,60] (60,80] (80,97] 
     72     660     780     436      52 </code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>d<span class="sc">$</span>age20 <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age20)</span></code></pre></div>
<pre><code>
[18,20] (20,40] (40,60] (60,80] (80,97] 
     72     660     780     436      52 </code></pre>
<p>On peut également modifier le sens des intervalles avec l’option <code>right=FALSE</code>, et indiquer manuellement les noms des modalités avec <code>labels</code> :</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>d<span class="sc">$</span>age20 <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>), <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age20)</span></code></pre></div>
<pre><code>
[18,20) [20,40) [40,60) [60,80) [80,97] 
     48     643     793     454      62 </code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a>d<span class="sc">$</span>age20 <span class="ot">&lt;-</span> <span class="fu">cut</span>(d<span class="sc">$</span>age, <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">97</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;20ans&quot;</span>, <span class="st">&quot;21-40 ans&quot;</span>, <span class="st">&quot;41-60ans&quot;</span>, <span class="st">&quot;61-80ans&quot;</span>, <span class="st">&quot;&gt;80ans&quot;</span>))</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age20)</span></code></pre></div>
<pre><code>
   &lt;20ans 21-40 ans  41-60ans  61-80ans    &gt;80ans 
       72       660       780       436        52 </code></pre>
<div class="note">
<p>L’extension <code class="pkg">questionr</code> propose une interface interactive à la fonction <code data-pkg="base">cut</code>, nommée <code data-pkg="questionr">icut</code>. Elle s’utilise de la manière suivante :</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">icut</span>(d, age)</span></code></pre></div>
<p><strong>RStudio</strong> devrait ouvrir une fenêtre semblable à l’image ci-dessous.</p>
<div class="float">
<img src="images/capture_icut.png" alt="Capture d’écran d’icut" />
<div class="figcaption">Capture d’écran d’icut</div>
</div>
<p>Vous pouvez alors indiquer les limites de vos classes ainsi que quelques options complémentaires. Ces limites sont représentées graphiquement sur l’histogramme de la variable d’origine.</p>
<p>L’onglet <em>Vérification</em> affiche un tri à plat et un graphique en barres de la nouvelle variable. Une fois le résultat satisfaisant, vous pouvez récupérer le code généré pour l’inclure dans votre script.</p>
<p>L’extension <code class="pkg">questionr</code> propose aussi une fonction <code data-pkg="questionr">quant.cut</code> permettant de découper une variable numérique en un nombre de classes donné ayant des efffectifs semblables. Il suffit de lui passer le nombre de classes en argument :</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>d<span class="sc">$</span>age6cl <span class="ot">&lt;-</span> <span class="fu">quant.cut</span>(d<span class="sc">$</span>age, <span class="dv">6</span>)</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age6cl)</span></code></pre></div>
<pre><code>
    [18,30)     [30,39)     [39,48) [48,55.667) [55.667,66) 
        302         337         350         344         305 
    [66,97] 
        362 </code></pre>
<p><code data-pkg="questionr">quant.cut</code> admet les mêmes autres options que <code data-pkg="base">cut</code> (<code>include.lowest</code>, <code>right</code>, <code>labels</code>… ).</p>
</div>
</div>
<div id="regrouper_modalites" class="section level2 hasAnchor">
<h2 class="hasAnchor">Regrouper les modalités d’une variable<a href="#regrouper_modalites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pour regrouper les modalités d’une variable qualitative (d’un facteur le plus souvent), on peut utiliser directement l’indexation.</p>
<p>Ainsi, si on veut recoder la variable <var>qualif</var> dans une variable <var>qualif.reg</var> plus « compacte », on peut utiliser :</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>qualif)</span></code></pre></div>
<pre><code>
      Ouvrier specialise         Ouvrier qualifie 
                     203                      292 
              Technicien Profession intermediaire 
                      86                      160 
                   Cadre                  Employe 
                     260                      594 
                   Autre 
                      58 </code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Ouvrier specialise&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Ouvrier qualifie&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Employe&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Employe&quot;</span></span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Profession intermediaire&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Intermediaire&quot;</span></span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Technicien&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Intermediaire&quot;</span></span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Cadre&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Cadre&quot;</span></span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Autre&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Autre&quot;</span></span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>qualif.reg)</span></code></pre></div>
<pre><code>
        Autre         Cadre       Employe Intermediaire 
           58           260           594           246 
      Ouvrier 
          495 </code></pre>
<p>On aurait pu représenter ce recodage de manière plus compacte, notamment en commençant par copier le contenu de <var>qualif</var> dans <var>qualif.reg</var>, ce qui permet de ne pas s’occuper de ce qui ne change pas.</p>
<p>Il est cependant nécessaire de ne pas copier <var>qualif</var> sous forme de facteur, sinon on ne pourrait ajouter de nouvelles modalités. On copie donc la version caractères de <var>qualif</var> grâce à la fonction <code data-pkg="base" data-rdoc="character">as.character</code> :</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg <span class="ot">&lt;-</span> <span class="fu">as.character</span>(d<span class="sc">$</span>qualif)</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Ouvrier specialise&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Ouvrier qualifie&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Profession intermediaire&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Intermediaire&quot;</span></span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Technicien&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Intermediaire&quot;</span></span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>qualif.reg)</span></code></pre></div>
<pre><code>
        Autre         Cadre       Employe Intermediaire 
           58           260           594           246 
      Ouvrier 
          495 </code></pre>
<p>On peut faire une version encore plus compacte en utilisant l’opérateur logique <em>ou</em> (<code>|</code>) :</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg <span class="ot">&lt;-</span> <span class="fu">as.character</span>(d<span class="sc">$</span>qualif)</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Ouvrier specialise&quot;</span> <span class="sc">|</span> d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Ouvrier qualifie&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Profession intermediaire&quot;</span> <span class="sc">|</span> d<span class="sc">$</span>qualif <span class="sc">==</span> <span class="st">&quot;Technicien&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Intermediaire&quot;</span></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>qualif.reg)</span></code></pre></div>
<pre><code>
        Autre         Cadre       Employe Intermediaire 
           58           260           594           246 
      Ouvrier 
          495 </code></pre>
<p>Enfin, pour terminer ce petit tour d’horizon, on peut également remplacer l’opérateur <code>|</code> par <code>%in%</code>, qui peut parfois être plus lisible :</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg <span class="ot">&lt;-</span> <span class="fu">as.character</span>(d<span class="sc">$</span>qualif)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Ouvrier specialise&quot;</span>, <span class="st">&quot;Ouvrier qualifie&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Ouvrier&quot;</span></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg[d<span class="sc">$</span>qualif <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Profession intermediaire&quot;</span>, <span class="st">&quot;Technicien&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Intermediaire&quot;</span></span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>qualif.reg)</span></code></pre></div>
<pre><code>
        Autre         Cadre       Employe Intermediaire 
           58           260           594           246 
      Ouvrier 
          495 </code></pre>
<p>Dans tous les cas le résultat obtenu est une variable de type caractère. On pourra la convertir en facteur par un simple :</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>d<span class="sc">$</span>qualif.reg <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>qualif.reg)</span></code></pre></div>
<p>Si on souhaite recoder les valeurs manquantes, il suffit de faire appel à la fonction <code data-pkg="base" data-rdoc="NA">is.na</code> :</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>trav.satisf)</span></code></pre></div>
<pre><code>
  Satisfaction Insatisfaction      Equilibre 
           480            117            451 </code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>d<span class="sc">$</span>trav.satisf.reg <span class="ot">&lt;-</span> <span class="fu">as.character</span>(d<span class="sc">$</span>trav.satisf)</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>d<span class="sc">$</span>trav.satisf.reg[<span class="fu">is.na</span>(d<span class="sc">$</span>trav.satisf)] <span class="ot">&lt;-</span> <span class="st">&quot;Manquant&quot;</span></span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>trav.satisf.reg)</span></code></pre></div>
<pre><code>
     Equilibre Insatisfaction       Manquant   Satisfaction 
           451            117            952            480 </code></pre>
<div class="note">
<p><code class="pkg">questionr</code> propose une interface interactive pour le recodage d’une variable qualitative (renommage et regroupement de modalités). Cette fonction, nommée <code data-pkg="questionr">irec</code>, s’utilise de la manière suivante :</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">irec</span>(d, qualif)</span></code></pre></div>
<p><strong>RStudio</strong> va alors ouvrir une fenêtre semblable à l’image ci-dessous :</p>
<div class="float">
<img src="images/capture_irec.png" alt="Capture de irec" />
<div class="figcaption">Capture de irec</div>
</div>
<p>Vous pouvez alors sélectionner différentes options, et pour chaque ancienne modalité, indiquer la nouvelle valeur correspondante. Pour regrouper des modalités, il suffit de leur assigner des nouvelles valeurs identiques. Dans tous les cas n’hésitez pas à expérimenter, l’interface se contente de générer du code <strong>R</strong> à copier/coller dans votre script mais ne l’exécute pas, et ne modifie donc jamais vos données !</p>
<p>L’onglet <em>Vérification</em> affiche un tri croisé de l’ancienne et de la nouvelle variable pour vérifier que le recodage est correct. Une fois le résultat satisfaisant, vous pouvez récupérer le code généré dans l’onglet <em>Code</em> pour l’inclure dans votre script.</p>
</div>
<div class="note">
<p>Les exemples précédents montrent bien qu’il est parfois malaisé d’utiliser des facteurs lorsque l’on recode des variables. Les vecteurs labellisés sont, quant à eux, plus souples. <strong>Attention :</strong> avec des vecteurs labellisés, on utilisera les valeurs sous-jacentes et non les étiquettes pour écrire des conditions.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">data</span>(fecondite)</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>femmes <span class="sc">%&gt;%</span> <span class="fu">look_for</span>(<span class="st">&quot;educ&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["pos"],"name":[1],"type":["int"],"align":["right"]},{"label":["variable"],"name":[2],"type":["chr"],"align":["left"]},{"label":["label"],"name":[3],"type":["chr"],"align":["left"]},{"label":["col_type"],"name":[4],"type":["chr"],"align":["left"]},{"label":["missing"],"name":[5],"type":["int"],"align":["right"]},{"label":["levels"],"name":[6],"type":["named list"],"align":["right"]},{"label":["value_labels"],"name":[7],"type":["named list"],"align":["right"]}],"data":[{"1":"9","2":"educ","3":"Niveau d'éducation","4":"dbl+lbl","5":"0","6":"<NULL>","7":"<dbl [4]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>femmes<span class="sc">$</span>educ2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>femmes<span class="sc">$</span>educ2[femmes<span class="sc">$</span>educ <span class="sc">&gt;=</span> <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a><span class="fu">var_label</span>(femmes<span class="sc">$</span>educ2) <span class="ot">&lt;-</span> <span class="st">&quot;A atteint un niveau secondaire ou supérieur ?&quot;</span></span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a><span class="fu">val_labels</span>(femmes<span class="sc">$</span>educ2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">non =</span> <span class="dv">0</span>, <span class="at">oui =</span> <span class="dv">1</span>)</span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a>femmes <span class="sc">%&gt;%</span> <span class="fu">look_for</span>(<span class="st">&quot;educ&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["pos"],"name":[1],"type":["int"],"align":["right"]},{"label":["variable"],"name":[2],"type":["chr"],"align":["left"]},{"label":["label"],"name":[3],"type":["chr"],"align":["left"]},{"label":["col_type"],"name":[4],"type":["chr"],"align":["left"]},{"label":["missing"],"name":[5],"type":["int"],"align":["right"]},{"label":["levels"],"name":[6],"type":["named list"],"align":["right"]},{"label":["value_labels"],"name":[7],"type":["named list"],"align":["right"]}],"data":[{"1":"9","2":"educ","3":"Niveau d'éducation","4":"dbl+lbl","5":"0","6":"<NULL>","7":"<dbl [4]>"},{"1":"18","2":"educ2","3":"A atteint un niveau secondaire ou supérieur ?","4":"dbl+lbl","5":"0","6":"<NULL>","7":"<dbl [2]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="variables-calculées" class="section level2 hasAnchor">
<h2 class="hasAnchor">Variables calculées<a href="#variables-calculées" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La création d’une variable numérique à partir de calculs sur une ou plusieurs autres variables numériques se fait très simplement.</p>
<p>Supposons que l’on souhaite calculer une variable indiquant l’écart entre le nombre d’heures passées à regarder la télévision et la moyenne globale de cette variable. On pourrait alors faire :</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">range</span>(d<span class="sc">$</span>heures.tv, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1]  0 12</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">mean</span>(d<span class="sc">$</span>heures.tv, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1] 2.247</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>d<span class="sc">$</span>ecart.heures.tv <span class="ot">&lt;-</span> d<span class="sc">$</span>heures.tv <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>heures.tv, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a><span class="fu">range</span>(d<span class="sc">$</span>ecart.heures.tv, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1] -2.247  9.753</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="fu">mean</span>(d<span class="sc">$</span>ecart.heures.tv, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1] 4.715e-17</code></pre>
<p>Autre exemple tiré du jeu de données <code>rp99</code> : si on souhaite calculer le pourcentage d’actifs dans chaque commune, on peut diviser la population active <var>pop.act</var> par la population totale <var>pop.tot</var>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">&quot;https://github.com/larmarange/analyse-R/raw/gh-pages/data/rp99.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>rp99<span class="sc">$</span>part.actifs <span class="ot">&lt;-</span> rp99<span class="sc">$</span>pop.act <span class="sc">/</span> rp99<span class="sc">$</span>pop.tot <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
</div>
<div id="combiner-plusieurs-variables" class="section level2 hasAnchor">
<h2 class="hasAnchor">Combiner plusieurs variables<a href="#combiner-plusieurs-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La combinaison de plusieurs variables se fait à l’aide des techniques d’indexation déjà décrites précédemment. Le plus compliqué est d’arriver à formuler des conditions parfois complexes de manière rigoureuse.</p>
<p>On peut ainsi vouloir combiner plusieurs variables qualitatives en une seule :</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Cuisine et Bricolage&quot;</span></span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Cuisine seulement&quot;</span></span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Bricolage seulement&quot;</span></span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ni cuisine ni bricolage&quot;</span></span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>act.manuelles)</span></code></pre></div>
<pre><code>
    Bricolage seulement    Cuisine et Bricolage 
                    437                     416 
      Cuisine seulement Ni cuisine ni bricolage 
                    465                     682 </code></pre>
<p>On peut également combiner variables qualitatives et variables quantitatives :</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a>d<span class="sc">$</span>age.sexe <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a>d<span class="sc">$</span>age.sexe[d<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">40</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Homme moins de 40 ans&quot;</span></span>
<span id="cb150-3"><a href="#cb150-3" tabindex="-1"></a>d<span class="sc">$</span>age.sexe[d<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">40</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Homme plus de 40 ans&quot;</span></span>
<span id="cb150-4"><a href="#cb150-4" tabindex="-1"></a>d<span class="sc">$</span>age.sexe[d<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Femme&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">40</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Femme moins de 40 ans&quot;</span></span>
<span id="cb150-5"><a href="#cb150-5" tabindex="-1"></a>d<span class="sc">$</span>age.sexe[d<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Femme&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">40</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Femme plus de 40 ans&quot;</span></span>
<span id="cb150-6"><a href="#cb150-6" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age.sexe)</span></code></pre></div>
<pre><code>
Femme moins de 40 ans  Femme plus de 40 ans 
                  376                   725 
Homme moins de 40 ans  Homme plus de 40 ans 
                  315                   584 </code></pre>
<p>Les combinaisons de variables un peu complexes nécessitent parfois un petit travail de réflexion. En particulier, l’ordre des commandes de recodage a parfois une influence dans le résultat final.</p>
<p>Pour combiner rapidement plusieurs variables entre elles, on peut aussi avoir recours à la fonction <code data-pkg="base">interaction</code> qui créra un facteur avec un niveau pour chaque combinaison de modalités des variables sources.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>d<span class="sc">$</span>age20.sexe <span class="ot">&lt;-</span> <span class="fu">interaction</span>(d<span class="sc">$</span>sexe, d<span class="sc">$</span>age20)</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>age20.sexe)</span></code></pre></div>
<pre><code>
   Homme.&lt;20ans    Femme.&lt;20ans Homme.21-40 ans 
             34              38             291 
Femme.21-40 ans  Homme.41-60ans  Femme.41-60ans 
            369             352             428 
 Homme.61-80ans  Femme.61-80ans    Homme.&gt;80ans 
            205             231              17 
   Femme.&gt;80ans 
             35 </code></pre>
</div>
<div id="variables-scores" class="section level2 hasAnchor">
<h2 class="hasAnchor">Variables scores<a href="#variables-scores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Une variable score est une variable calculée en additionnant des poids accordés aux modalités d’une série de variables qualitatives.</p>
<p>Pour prendre un exemple tout à fait arbitraire, imaginons que nous souhaitons calculer un score d’activités extérieures. Dans ce score on considère que le fait d’aller au cinéma « pèse » 10, celui de pêcher ou chasser vaut 30 et celui de faire du sport vaut 20. On pourrait alors calculer notre score de la manière suivante :</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>d<span class="sc">$</span>score.ext <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>d<span class="sc">$</span>score.ext[d<span class="sc">$</span>cinema <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="ot">&lt;-</span> d<span class="sc">$</span>score.ext[d<span class="sc">$</span>cinema <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="sc">+</span> <span class="dv">10</span></span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a>d<span class="sc">$</span>score.ext[d<span class="sc">$</span>peche.chasse <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="ot">&lt;-</span> d<span class="sc">$</span>score.ext[d<span class="sc">$</span>peche.chasse <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb154-4"><a href="#cb154-4" tabindex="-1"></a>d<span class="sc">$</span>score.ext[d<span class="sc">$</span>sport <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="ot">&lt;-</span> d<span class="sc">$</span>score.ext[d<span class="sc">$</span>sport <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="sc">+</span> <span class="dv">20</span></span>
<span id="cb154-5"><a href="#cb154-5" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>score.ext)</span></code></pre></div>
<pre><code>
  0  10  20  30  40  50  60 
800 342 229 509  31  41  48 </code></pre>
<p>Cette notation étant un peu lourde, on peut l’alléger un peu en utilisant la fonction <code data-pkg="base">ifelse</code>. Celle-ci prend en argument une condition et deux valeurs. Si la condition est vraie elle retourne la première valeur, sinon elle retourne la seconde.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>d<span class="sc">$</span>score.ext <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>d<span class="sc">$</span>score.ext <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>cinema <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, <span class="dv">10</span>, <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>peche.chasse <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, <span class="dv">30</span>, <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>sport <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, <span class="dv">20</span>, <span class="dv">0</span>)</span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>score.ext)</span></code></pre></div>
<pre><code>
  0  10  20  30  40  50  60 
800 342 229 509  31  41  48 </code></pre>
</div>
<div id="vérification-des-recodages" class="section level2 hasAnchor">
<h2 class="hasAnchor">Vérification des recodages<a href="#vérification-des-recodages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il est très important de vérifier, notamment après les recodages les plus complexes, qu’on a bien obtenu le résultat escompté. Les deux points les plus sensibles étant les valeurs manquantes et les erreurs dans les conditions.</p>
<p>Pour vérifier tout cela, le plus simple est sans doute de faire des tableaux croisés entre la variable recodée et celles ayant servi au recodage, à l’aide des fonctions <code data-pkg="base">table</code> ou <code data-pkg="stats">xtabs</code>, et de vérifier le nombre de valeurs manquantes dans la variable recodée avec <code data-pkg="base">summary</code>, <code data-pkg="questionr">freq</code> ou <code data-pkg="base">table</code>.</p>
<p>Par exemple :</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Cuisine et Bricolage&quot;</span></span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Cuisine seulement&quot;</span></span>
<span id="cb158-4"><a href="#cb158-4" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Bricolage seulement&quot;</span></span>
<span id="cb158-5"><a href="#cb158-5" tabindex="-1"></a>d<span class="sc">$</span>act.manuelles[d<span class="sc">$</span>cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Ni cuisine ni bricolage&quot;</span></span>
<span id="cb158-6"><a href="#cb158-6" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>act.manuelles, d<span class="sc">$</span>cuisine)</span></code></pre></div>
<pre><code>                         
                          Non Oui
  Bricolage seulement     437   0
  Cuisine et Bricolage      0 416
  Cuisine seulement         0 465
  Ni cuisine ni bricolage 682   0</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>act.manuelles, d<span class="sc">$</span>bricol)</span></code></pre></div>
<pre><code>                         
                          Non Oui
  Bricolage seulement       0 437
  Cuisine et Bricolage      0 416
  Cuisine seulement       465   0
  Ni cuisine ni bricolage 682   0</code></pre>
</div>
<div id="facteurs-et-forcats" class="section level2 hasAnchor">
<h2 class="hasAnchor">Facteurs et forcats<a href="#facteurs-et-forcats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code class="pkg">forcats</code> est une extension facilitant la manipulation des variables qualitatives, qu’elles soient sous forme de vecteurs <code>character</code> ou de facteurs. Elle fait partie du <strong>tidyverse</strong>, et est donc automatiquement chargée par :</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="modifier-les-modalités-dune-variable-qualitative" class="section level3 hasAnchor">
<h3 class="hasAnchor">Modifier les modalités d’une variable qualitative<a href="#modifier-les-modalités-dune-variable-qualitative" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une opération courante consiste à modifier les valeurs d’une variable qualitative, que ce soit pour avoir des intitulés plus courts ou plus clairs ou pour regrouper des modalités entre elles.</p>
<p>Il existe plusieurs possibilités pour effectuer ce type de recodage, mais ici on va utiliser la fonction <code data-pkg="forcats">fct_recode</code> de l’extension <code class="pkg">forcats</code>. Celle-ci prend en argument une liste de recodages sous la forme <code>"Nouvelle valeur" = "Ancienne valeur"</code>.</p>
<p>Un exemple :</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Poire&quot;</span>, <span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Cerise&quot;</span>)</span>
<span id="cb163-2"><a href="#cb163-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(f,</span>
<span id="cb163-3"><a href="#cb163-3" tabindex="-1"></a>  <span class="st">&quot;Fraise&quot;</span> <span class="ot">=</span> <span class="st">&quot;Pomme&quot;</span>,</span>
<span id="cb163-4"><a href="#cb163-4" tabindex="-1"></a>  <span class="st">&quot;Ananas&quot;</span> <span class="ot">=</span> <span class="st">&quot;Poire&quot;</span></span>
<span id="cb163-5"><a href="#cb163-5" tabindex="-1"></a>)</span>
<span id="cb163-6"><a href="#cb163-6" tabindex="-1"></a>f</span></code></pre></div>
<pre><code>[1] Fraise Ananas Fraise Cerise
Levels: Cerise Ananas Fraise</code></pre>
<p>Autre exemple sur une “vraie” variable :</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employe","2":"594","3":"0.35935","4":"594","5":"0.3593","_rn_":"1"},{"1":"Ouvrier qualifie","2":"292","3":"0.17665","4":"886","5":"0.5360","_rn_":"2"},{"1":"Cadre","2":"260","3":"0.15729","4":"1146","5":"0.6933","_rn_":"3"},{"1":"Ouvrier specialise","2":"203","3":"0.12281","4":"1349","5":"0.8161","_rn_":"4"},{"1":"Profession intermediaire","2":"160","3":"0.09679","4":"1509","5":"0.9129","_rn_":"5"},{"1":"Technicien","2":"86","3":"0.05203","4":"1595","5":"0.9649","_rn_":"6"},{"1":"Autre","2":"58","3":"0.03509","4":"1653","5":"1.0000","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif5 <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(hdv2003<span class="sc">$</span>qualif,</span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a>  <span class="st">&quot;Ouvrier&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ouvrier specialise&quot;</span>,</span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a>  <span class="st">&quot;Ouvrier&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ouvrier qualifie&quot;</span>,</span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a>  <span class="st">&quot;Interm&quot;</span> <span class="ot">=</span> <span class="st">&quot;Technicien&quot;</span>,</span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a>  <span class="st">&quot;Interm&quot;</span> <span class="ot">=</span> <span class="st">&quot;Profession intermediaire&quot;</span></span>
<span id="cb166-6"><a href="#cb166-6" tabindex="-1"></a>)</span>
<span id="cb166-7"><a href="#cb166-7" tabindex="-1"></a></span>
<span id="cb166-8"><a href="#cb166-8" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif5)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employe","2":"594","3":"0.35935","4":"594","5":"0.3593","_rn_":"1"},{"1":"Ouvrier","2":"495","3":"0.29946","4":"1089","5":"0.6588","_rn_":"2"},{"1":"Cadre","2":"260","3":"0.15729","4":"1349","5":"0.8161","_rn_":"3"},{"1":"Interm","2":"246","3":"0.14882","4":"1595","5":"0.9649","_rn_":"4"},{"1":"Autre","2":"58","3":"0.03509","4":"1653","5":"1.0000","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Attention, les anciennes valeurs saisies doivent être exactement égales aux valeurs des modalités de la variable recodée : toute différence d’accent ou d’espace fera que ce recodage ne sera pas pris en compte. Dans ce cas, <code>forcats</code> affiche un avertissement nous indiquant qu’une valeur saisie n’a pas été trouvée dans les modalités de la variable :</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif_test <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(hdv2003<span class="sc">$</span>qualif,</span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a>  <span class="st">&quot;Ouvrier&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ouvrier spécialisé&quot;</span>,</span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a>  <span class="st">&quot;Ouvrier&quot;</span> <span class="ot">=</span> <span class="st">&quot;Ouvrier qualifié&quot;</span></span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>Warning: Unknown levels in `f`: Ouvrier spécialisé, Ouvrier
qualifié</code></pre>
<p>Si on souhaite recoder une modalité de la variable en <code>NA</code>, il faut (contre intuitivement) lui assigner la valeur <code>NULL</code> :</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif_rec <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(hdv2003<span class="sc">$</span>qualif, <span class="at">NULL =</span> <span class="st">&quot;Autre&quot;</span>)</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif_rec)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employe","2":"594","3":"0.37241","4":"594","5":"0.3724","_rn_":"1"},{"1":"Ouvrier qualifie","2":"292","3":"0.18307","4":"886","5":"0.5555","_rn_":"2"},{"1":"Cadre","2":"260","3":"0.16301","4":"1146","5":"0.7185","_rn_":"3"},{"1":"Ouvrier specialise","2":"203","3":"0.12727","4":"1349","5":"0.8458","_rn_":"4"},{"1":"Profession intermediaire","2":"160","3":"0.10031","4":"1509","5":"0.9461","_rn_":"5"},{"1":"Technicien","2":"86","3":"0.05392","4":"1595","5":"1.0000","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>À l’inverse, si on souhaite recoder les <code>NA</code> d’une variable, on utilisera la fonction <code data-pkg="forcats">fct_explicit_na</code>, qui convertit toutes les valeurs manquantes (<code>NA</code>) d’un facteur en une modalité spécifique :</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif_rec <span class="ot">&lt;-</span> <span class="fu">fct_explicit_na</span>(hdv2003<span class="sc">$</span>qualif, <span class="at">na_level =</span> <span class="st">&quot;(Manquant)&quot;</span>)</span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif_rec)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employe","2":"594","3":"0.2970","4":"594","5":"0.2970","_rn_":"1"},{"1":"(Manquant)","2":"347","3":"0.1735","4":"941","5":"0.4705","_rn_":"2"},{"1":"Ouvrier qualifie","2":"292","3":"0.1460","4":"1233","5":"0.6165","_rn_":"3"},{"1":"Cadre","2":"260","3":"0.1300","4":"1493","5":"0.7465","_rn_":"4"},{"1":"Ouvrier specialise","2":"203","3":"0.1015","4":"1696","5":"0.8480","_rn_":"5"},{"1":"Profession intermediaire","2":"160","3":"0.0800","4":"1856","5":"0.9280","_rn_":"6"},{"1":"Technicien","2":"86","3":"0.0430","4":"1942","5":"0.9710","_rn_":"7"},{"1":"Autre","2":"58","3":"0.0290","4":"2000","5":"1.0000","_rn_":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>D’autres fonctions sont proposées par <code class="pkg">forcats</code> pour faciliter certains recodage, comme <code data-pkg="forcats">fct_collapse</code>, qui propose une autre syntaxe pratique quand on doit regrouper ensemble des modalités :</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif_rec <span class="ot">&lt;-</span> <span class="fu">fct_collapse</span>(hdv2003<span class="sc">$</span>qualif,</span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>  <span class="st">&quot;Ouvrier&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Ouvrier specialise&quot;</span>, <span class="st">&quot;Ouvrier qualifie&quot;</span>),</span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>  <span class="st">&quot;Interm&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Technicien&quot;</span>, <span class="st">&quot;Profession intermediaire&quot;</span>)</span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a>)</span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a></span>
<span id="cb171-6"><a href="#cb171-6" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif_rec)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employe","2":"594","3":"0.35935","4":"594","5":"0.3593","_rn_":"1"},{"1":"Ouvrier","2":"495","3":"0.29946","4":"1089","5":"0.6588","_rn_":"2"},{"1":"Cadre","2":"260","3":"0.15729","4":"1349","5":"0.8161","_rn_":"3"},{"1":"Interm","2":"246","3":"0.14882","4":"1595","5":"0.9649","_rn_":"4"},{"1":"Autre","2":"58","3":"0.03509","4":"1653","5":"1.0000","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code data-pkg="forcats">fct_other</code>, qui regroupe une liste de modalités en une seule modalité “Other” :</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif_rec <span class="ot">&lt;-</span> <span class="fu">fct_other</span>(hdv2003<span class="sc">$</span>qualif,</span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a>  <span class="at">drop =</span> <span class="fu">c</span>(</span>
<span id="cb172-3"><a href="#cb172-3" tabindex="-1"></a>    <span class="st">&quot;Ouvrier specialise&quot;</span>, <span class="st">&quot;Ouvrier qualifie&quot;</span>,</span>
<span id="cb172-4"><a href="#cb172-4" tabindex="-1"></a>    <span class="st">&quot;Cadre&quot;</span>, <span class="st">&quot;Autre&quot;</span></span>
<span id="cb172-5"><a href="#cb172-5" tabindex="-1"></a>  )</span>
<span id="cb172-6"><a href="#cb172-6" tabindex="-1"></a>)</span>
<span id="cb172-7"><a href="#cb172-7" tabindex="-1"></a></span>
<span id="cb172-8"><a href="#cb172-8" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif_rec)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Other","2":"813","3":"0.49183","4":"813","5":"0.4918","_rn_":"1"},{"1":"Employe","2":"594","3":"0.35935","4":"1407","5":"0.8512","_rn_":"2"},{"1":"Profession intermediaire","2":"160","3":"0.09679","4":"1567","5":"0.9480","_rn_":"3"},{"1":"Technicien","2":"86","3":"0.05203","4":"1653","5":"1.0000","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code data-pkg="forcats">fct_lump</code>, qui regroupe automatiquement les modalités les moins fréquentes en une seule modalité “Other” (avec possibilité d’indiquer des seuils de regroupement) :</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif_rec <span class="ot">&lt;-</span> <span class="fu">fct_lump</span>(hdv2003<span class="sc">$</span>qualif)</span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif_rec)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employe","2":"594","3":"0.35935","4":"594","5":"0.3593","_rn_":"1"},{"1":"Ouvrier qualifie","2":"292","3":"0.17665","4":"886","5":"0.5360","_rn_":"2"},{"1":"Cadre","2":"260","3":"0.15729","4":"1146","5":"0.6933","_rn_":"3"},{"1":"Ouvrier specialise","2":"203","3":"0.12281","4":"1349","5":"0.8161","_rn_":"4"},{"1":"Profession intermediaire","2":"160","3":"0.09679","4":"1509","5":"0.9129","_rn_":"5"},{"1":"Other","2":"144","3":"0.08711","4":"1653","5":"1.0000","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="ordonner-les-modalités-dune-variable-qualitative" class="section level3 hasAnchor">
<h3 class="hasAnchor">Ordonner les modalités d’une variable qualitative<a href="#ordonner-les-modalités-dune-variable-qualitative" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>L’avantage des facteurs (par rapport aux vecteurs de type <code>character</code>) est que leurs modalités peuvent être ordonnées, ce qui peut faciliter la lecture de tableaux ou graphiques.</p>
<p>On peut ordonner les modalités d’un facteur manuellement, par exemple avec la fonction <code>fct_relevel()</code> de l’extension <code>forcats</code> :</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>qualif_rec <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(</span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a>  hdv2003<span class="sc">$</span>qualif,</span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a>  <span class="st">&quot;Cadre&quot;</span>, <span class="st">&quot;Profession intermediaire&quot;</span>, <span class="st">&quot;Technicien&quot;</span>,</span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a>  <span class="st">&quot;Employe&quot;</span>, <span class="st">&quot;Ouvrier qualifie&quot;</span>, <span class="st">&quot;Ouvrier specialise&quot;</span>,</span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a>  <span class="st">&quot;Autre&quot;</span></span>
<span id="cb174-6"><a href="#cb174-6" tabindex="-1"></a>)</span>
<span id="cb174-7"><a href="#cb174-7" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>qualif_rec)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employe","2":"594","3":"0.35935","4":"594","5":"0.3593","_rn_":"1"},{"1":"Ouvrier qualifie","2":"292","3":"0.17665","4":"886","5":"0.5360","_rn_":"2"},{"1":"Cadre","2":"260","3":"0.15729","4":"1146","5":"0.6933","_rn_":"3"},{"1":"Ouvrier specialise","2":"203","3":"0.12281","4":"1349","5":"0.8161","_rn_":"4"},{"1":"Profession intermediaire","2":"160","3":"0.09679","4":"1509","5":"0.9129","_rn_":"5"},{"1":"Technicien","2":"86","3":"0.05203","4":"1595","5":"0.9649","_rn_":"6"},{"1":"Autre","2":"58","3":"0.03509","4":"1653","5":"1.0000","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Une autre possibilité est d’ordonner les modalités d’un facteur selon les valeurs d’une autre variable. Par exemple, si on représente le boxplot de la répartition de l’âge selon le statut d’occupation :</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a><span class="fu">ggplot</span>(hdv2003) <span class="sc">+</span></span>
<span id="cb175-3"><a href="#cb175-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> occup, <span class="at">y =</span> age))</span></code></pre></div>
<p><img src="graphs/recodage/unnamed-chunk-59-1.png" width="1050" /></p>
<p>Le graphique pourrait être plus lisible si les modalités étaient triées par âge median croissant. Ceci est possible en utilisant <code data-pkg="forcats">fct_reorder</code>. Celle-ci prend 3 arguments : le facteur à réordonner, la variable dont les valeurs doivent être utilisées pour ce réordonnancement, et enfin une fonction à appliquer à cette deuxième variable.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>occup_age <span class="ot">&lt;-</span> <span class="fu">fct_reorder</span>(hdv2003<span class="sc">$</span>occup, hdv2003<span class="sc">$</span>age, median)</span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" tabindex="-1"></a><span class="fu">ggplot</span>(hdv2003) <span class="sc">+</span></span>
<span id="cb176-4"><a href="#cb176-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> occup_age, <span class="at">y =</span> age))</span></code></pre></div>
<p><img src="graphs/recodage/unnamed-chunk-60-1.png" width="1050" /></p>
</div>
</div>
<div id="combiner-plusieurs-variables-1" class="section level2 hasAnchor">
<h2 class="hasAnchor">Combiner plusieurs variables<a href="#combiner-plusieurs-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Parfois, on veut créer une nouvelle variable en partant des valeurs d’une ou plusieurs autres variables. Dans ce cas on peut utiliser les fonctions <code data-pkg="dplyr">if_else</code> pour les cas les plus simples, ou <code data-pkg="dplyr">case_when</code> pour les cas plus complexes. Ces deux fonctions sont incluses dans l’extension <code class="pkg">dplyr</code>, qu’il faut donc avoir chargé précédemment (voir le <a href="manipuler-les-donnees-avec-dplyr.html">chapitre consacré à dplyr</a>).</p>
<div id="if_else" class="section level3 hasAnchor">
<h3 class="hasAnchor">if_else<a href="#if_else" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code data-pkg="dplyr">if_else</code> prend trois arguments : un test, une valeur à renvoyer si le test est vrai, et une valeur à renvoyer si le test est faux.</p>
<p>Voici un exemple simple :</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">8</span>, <span class="dv">16</span>)</span>
<span id="cb177-2"><a href="#cb177-2" tabindex="-1"></a><span class="fu">if_else</span>(v <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="st">&quot;Supérieur à 10&quot;</span>, <span class="st">&quot;Inférieur à 10&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Supérieur à 10&quot; &quot;Supérieur à 10&quot; &quot;Inférieur à 10&quot;
[4] &quot;Supérieur à 10&quot;</code></pre>
<p>La fonction devient plus intéressante avec des tests combinant plusieurs variables. Par exemple, imaginons qu’on souhaite créer une nouvelle variable indiquant les hommes de plus de 60 ans :</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>statut <span class="ot">&lt;-</span> <span class="fu">if_else</span>(hdv2003<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">&amp;</span> hdv2003<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">60</span>,</span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a>  <span class="st">&quot;Homme de plus de 60 ans&quot;</span>,</span>
<span id="cb179-3"><a href="#cb179-3" tabindex="-1"></a>  <span class="st">&quot;Autre&quot;</span></span>
<span id="cb179-4"><a href="#cb179-4" tabindex="-1"></a>)</span>
<span id="cb179-5"><a href="#cb179-5" tabindex="-1"></a></span>
<span id="cb179-6"><a href="#cb179-6" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>statut)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Autre","2":"1778","3":"0.889","4":"1778","5":"0.889","_rn_":"1"},{"1":"Homme de plus de 60 ans","2":"222","3":"0.111","4":"2000","5":"1.000","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="case_when" class="section level3 hasAnchor">
<h3 class="hasAnchor">case_when<a href="#case_when" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code data-pkg="dplyr">case_when</code> est une génération du <code data-pkg="dplyr">if_else</code> qui permet d’indiquer plusieurs tests et leurs valeurs associées.</p>
<p>Imaginons qu’on souhaite créer une nouvelle variable permettant d’identifier les hommes de plus de 60 ans, les femmes de plus de 60 ans, et les autres. On peut utiliser la syntaxe suivante :</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>statut <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb180-2"><a href="#cb180-2" tabindex="-1"></a>  hdv2003<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> hdv2003<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">~</span> <span class="st">&quot;Homme de plus de 60 ans&quot;</span>,</span>
<span id="cb180-3"><a href="#cb180-3" tabindex="-1"></a>  hdv2003<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> hdv2003<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Femme&quot;</span> <span class="sc">~</span> <span class="st">&quot;Femme de plus de 60 ans&quot;</span>,</span>
<span id="cb180-4"><a href="#cb180-4" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Autre&quot;</span></span>
<span id="cb180-5"><a href="#cb180-5" tabindex="-1"></a>)</span>
<span id="cb180-6"><a href="#cb180-6" tabindex="-1"></a></span>
<span id="cb180-7"><a href="#cb180-7" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>statut)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Autre","2":"1512","3":"0.756","4":"1512","5":"0.756","_rn_":"1"},{"1":"Femme de plus de 60 ans","2":"266","3":"0.133","4":"1778","5":"0.889","_rn_":"2"},{"1":"Homme de plus de 60 ans","2":"222","3":"0.111","4":"2000","5":"1.000","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code data-pkg="dplyr">case_when</code> prend en arguments une série d’instructions sous la forme <code>condition ~ valeur</code>. Il les exécute une par une, et dès qu’une <code>condition</code> est vraie, il renvoit la <code>valeur</code> associée.</p>
<p>La clause <code>TRUE ~ "Autre"</code> permet d’assigner une valeur à toutes les lignes pour lesquelles aucune des conditions précédentes n’est vraie.</p>
<div class="important">
<p><strong>Attention :</strong> comme les conditions sont testées l’une après l’autre et que la valeur renvoyée est celle correspondant à la première condition vraie, l’ordre de ces conditions est très important. Il faut absolument aller du plus spécifique au plus général.</p>
<p>Par exemple le recodage suivant ne fonctionne pas :</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>statut <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a>  hdv2003<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">~</span> <span class="st">&quot;Homme&quot;</span>,</span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a>  hdv2003<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">&amp;</span> hdv2003<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">&quot;Homme de plus de 60 ans&quot;</span>,</span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Autre&quot;</span></span>
<span id="cb181-5"><a href="#cb181-5" tabindex="-1"></a>)</span>
<span id="cb181-6"><a href="#cb181-6" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>statut)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Autre","2":"1101","3":"0.5505","4":"1101","5":"0.5505","_rn_":"1"},{"1":"Homme","2":"899","3":"0.4495","4":"2000","5":"1.0000","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Comme la condition <code>sexe == "Homme"</code> est plus générale que <code>sexe == "Homme" &amp; age &gt; 60</code>, cette deuxième condition n’est jamais testée ! On n’obtiendra jamais la valeur correspondante.</p>
<p>Pour que ce recodage fonctionne il faut donc changer l’ordre des conditions pour aller du plus spécifique au plus général :</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a>hdv2003<span class="sc">$</span>statut <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a>  hdv2003<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">&amp;</span> hdv2003<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">&quot;Homme de plus de 60 ans&quot;</span>,</span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a>  hdv2003<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">&quot;Homme&quot;</span> <span class="sc">~</span> <span class="st">&quot;Homme&quot;</span>,</span>
<span id="cb182-4"><a href="#cb182-4" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Autre&quot;</span></span>
<span id="cb182-5"><a href="#cb182-5" tabindex="-1"></a>)</span>
<span id="cb182-6"><a href="#cb182-6" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" tabindex="-1"></a><span class="fu">freq</span>(hdv2003<span class="sc">$</span>statut)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["item"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_count"],"name":[4],"type":["int"],"align":["right"]},{"label":["cum_percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Autre","2":"1101","3":"0.5505","4":"1101","5":"0.5505","_rn_":"1"},{"1":"Homme","2":"677","3":"0.3385","4":"1778","5":"0.8890","_rn_":"2"},{"1":"Homme de plus de 60 ans","2":"222","3":"0.1110","4":"2000","5":"1.0000","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Vous pouvez trouver des exercices avec leur solution dans l’<a href="https://juba.github.io/tidyverse/09-recodages.html#exercices-4">Introduction à R et au tidyverse</a> de Julien Barnier.</p>
<p>Pour aller plus loin, <a href="http://r4ds.had.co.nz/factors.html">R for Data Science</a> de Garrett Grolemund et Hadley Wickham.</p>
</div>
</div>
<div id="recodage-et-data.table" class="section level2 hasAnchor">
<h2 class="hasAnchor">Recodage et data.table<a href="#recodage-et-data.table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nous aborderons dans un <a href="manipulations-avancees-avec-data-table.html">prochain chapitre</a> l’extension <code class="pkg">data.table</code> qui étend les tableaux de données et modifie complètement la syntaxe utilisée entre les crochets. Elle nécessite un petit temps d’adaptation mais, une fois maîtrisée, elle facile le quotidien lorsqu’il s’agit de manipuler et recoder les données. Ci-dessous, un petit avant-goût, reprenons quelques exemples précédents.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(hdv2003)</span>
<span id="cb183-3"><a href="#cb183-3" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" tabindex="-1"></a>dt[, score.ext <span class="sc">:=</span> <span class="dv">0</span>]</span>
<span id="cb183-5"><a href="#cb183-5" tabindex="-1"></a>dt[cinema <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, score.ext <span class="sc">:=</span> score.ext <span class="sc">+</span> <span class="dv">10</span>]</span>
<span id="cb183-6"><a href="#cb183-6" tabindex="-1"></a>dt[peche.chasse <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, score.ext <span class="sc">:=</span> score.ext <span class="sc">+</span> <span class="dv">30</span>]</span>
<span id="cb183-7"><a href="#cb183-7" tabindex="-1"></a>dt[sport <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, score.ext <span class="sc">:=</span> score.ext <span class="sc">+</span> <span class="dv">20</span>]</span>
<span id="cb183-8"><a href="#cb183-8" tabindex="-1"></a><span class="fu">table</span>(dt<span class="sc">$</span>score.ext)</span>
<span id="cb183-9"><a href="#cb183-9" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Cuisine et Bricolage&quot;</span>]</span>
<span id="cb183-11"><a href="#cb183-11" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Cuisine seulement&quot;</span>]</span>
<span id="cb183-12"><a href="#cb183-12" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Bricolage seulement&quot;</span>]</span>
<span id="cb183-13"><a href="#cb183-13" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Ni cuisine ni bricolage&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a><span class="fu">table</span>(dt<span class="sc">$</span>act.manuelles)</span></code></pre></div>
<pre><code>
    Bricolage seulement    Cuisine et Bricolage 
                    437                     416 
      Cuisine seulement Ni cuisine ni bricolage 
                    465                     682 </code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Cuisine et Bricolage&quot;</span>]</span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Cuisine seulement&quot;</span>]</span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Oui&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Bricolage seulement&quot;</span>]</span>
<span id="cb186-4"><a href="#cb186-4" tabindex="-1"></a>dt[cuisine <span class="sc">==</span> <span class="st">&quot;Non&quot;</span> <span class="sc">&amp;</span> bricol <span class="sc">==</span> <span class="st">&quot;Non&quot;</span>, act.manuelles <span class="sc">:=</span> <span class="st">&quot;Ni cuisine ni bricolage&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a><span class="fu">table</span>(dt<span class="sc">$</span>act.manuelles)</span></code></pre></div>
<pre><code>
    Bricolage seulement    Cuisine et Bricolage 
                    437                     416 
      Cuisine seulement Ni cuisine ni bricolage 
                    465                     682 </code></pre>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>On priviligiera la fonction <code data-pkg="labelled">to_factor</code> à la fonction <code data-pkg="haven" data-rdoc="labelled">as_factor</code> de l’extension <code class="pkg">haven</code>, la première ayant plus de possibilités et un comportement plus consistent.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copié !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
-->

<!-- Giscus comments -->
<script src="https://giscus.app/client.js"
        data-repo="larmarange/analyse-R"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzNDk4NjY2Ng=="
        data-category-id="DIC_kwDOAhXaqs4B_iH_"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="light"
        data-lang="fr"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->



</body>
</html>
