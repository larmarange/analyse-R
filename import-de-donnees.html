<!DOCTYPE html>

<html lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Import de données</title>

<script src="libs/header-attrs-2.12/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnes.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <li><a href="scraping.html">Scraping</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe avec <strong>survey</strong></a></li>
                  <li><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="gtsummary.html">Tableaux statistiques avancés avec <strong>gtsummary</strong></a></li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="modeles.html">Quel type de modèles choisir ?</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Modèles à effets aléatoires (modèles mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de données longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
                  <li><a href="analyse-textuelle.html">Analyse textuelle</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">Étendre <strong>ggplot2</strong></a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="exemples-graphiques-avances.html">Exemples de graphiques avancés</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
                  <li><a href="autres-extensions-graphiques.html">Autres extensions graphiques</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation (dont <strong>purrr</strong>)</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres avec <strong>scales</strong></a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations mathématiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <li><a href="https://larmarange.github.io/webin-R/">webin-R</a></li>
        <li><a href="https://www.youtube.com/c/webinR"><i class="fa fa-youtube" aria-hidden="true"></i></a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div id="header">



<h1 class="title toc-ignore">Import de données</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#importer-des-fichiers-texte">Importer des fichiers texte<span></span></a>
<ul>
<li><a href="#structure-dun-fichier-texte">Structure d’un fichier texte<span></span></a></li>
<li><a href="#interface-graphique-avec-rstudio">Interface graphique avec RStudio<span></span></a></li>
<li><a href="#dans-un-script">Dans un script<span></span></a></li>
</ul></li>
<li><a href="#importer-depuis-des-logiciels-de-statistique">Importer depuis des logiciels de statistique<span></span></a>
<ul>
<li><a href="#spss">SPSS<span></span></a></li>
<li><a href="#sas">SAS<span></span></a></li>
<li><a href="#stata">Stata<span></span></a></li>
<li><a href="#excel">Excel<span></span></a></li>
<li><a href="#dbase">dBase<span></span></a></li>
<li><a href="#feuille-de-calcul-google-sheets">Feuille de calcul Google Sheets<span></span></a></li>
</ul></li>
<li><a href="#données-spatiales">Données spatiales<span></span></a>
<ul>
<li><a href="#shapefile">Shapefile<span></span></a></li>
<li><a href="#rasters">Rasters<span></span></a></li>
</ul></li>
<li><a href="#connexion-à-des-bases-de-données">Connexion à des bases de données<span></span></a>
<ul>
<li><a href="#interfaçage-via-lextension-dbi">Interfaçage via l’extension DBI<span></span></a></li>
<li><a href="#utilisation-de-dplyr-et-dbplyr">Utilisation de dplyr et dbplyr<span></span></a></li>
<li><a href="#ressources">Ressources<span></span></a></li>
</ul></li>
<li><a href="#autres-sources">Autres sources<span></span></a></li>
<li><a href="#sauver-ses-données">Sauver ses données<span></span></a></li>
</ul>
</div>

<p><dfn data-index="données, exporter"></dfn><dfn data-index="exporter des données"></dfn></p>
<div class="important">
<p>Importer des données est souvent l’une des première opérations que l’on effectue lorsque l’on débute sous <strong>R</strong>, et ce n’est pas la moins compliquée. En cas de problème il ne faut donc pas hésiter à demander de l’aide par les différents moyens disponibles (voir le chapitre <a href="ou-trouver-de-l-aide.html">Où trouver de l’aide ?</a>) avant de se décourager.</p>
<p>N’hésitez donc pas à relire régulièrement ce chapitre en fonction de vos besoins.</p>
<p>Avant toute chose, il est impératif de bien organiser ses différents fichiers (voir le <a href="organiser-ses-fichiers.html">chapitre dédié</a>). Concernant les données sources que l’on utilisera pour ses analyses, je vous recommande de les placer dans un sous-répertoire dédié de votre projet.</p>
<p>Lorsque l’on importe des données, il est également impératif de vérifier que l’import s’est correctement déroulé (voir la section <a href="premier-travail-avec-les-donnees.html#inspecter">Inspecter les données</a> du chapitre <em>Premier travail avec les données</em>).</p>
</div>
<div id="importer-des-fichiers-texte" class="section level2 hasAnchor">
<h2 class="hasAnchor">Importer des fichiers texte<a href="#importer-des-fichiers-texte" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Les <dfn data-index="fichier texte">fichiers texte</dfn><dfn data-index="texte, fichier"></dfn> constituent un des formats les plus largement supportés par la majorité des logiciels statistiques. Presque tous permettent d’exporter des données dans un format texte, y compris les tableurs comme <strong>Libre Office</strong>, <strong>Open Office</strong> ou <strong>Excel</strong>.</p>
<p>Cependant, il existe une grande variétés de format texte, qui peuvent prendre différents noms selon les outils, tels que <dfn data-index="texte tabulé, fichier">texte tabulé</dfn> ou <em>texte (séparateur : tabulation)</em>, <strong><dfn data-index="CSV, fichier">CSV</dfn></strong> <dfn data-index="fichier CSV"></dfn> (pour <em>comma-separated value</em>, sachant que suivant les logiciels le séparateur peut être une virgule ou un point-virgule).</p>
<div id="structure-dun-fichier-texte" class="section level3 hasAnchor">
<h3 class="hasAnchor">Structure d’un fichier texte<a href="#structure-dun-fichier-texte" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dès lors, avant d’importer un fichier texte dans <strong>R</strong>, il est indispensable de regarder comment ce dernier est structuré. Il importe de prendre note des éléments suivants :</p>
<ul>
<li>La première ligne contient-elle le nom des variables ? Ici c’est le cas.</li>
<li>Quel est le caractère séparateur entre les différentes variables (encore appelé <dfn>séparateur de champs</dfn>) ? Dans le cadre d’un fichier <strong>CSV</strong>, il aurait pu s’agir d’une virgule ou d’un point-virgule.</li>
<li>Quel est le caractère utilisé pour indiquer les décimales (le <dfn>séparateur décimal</dfn>) ? Il s’agit en général d’un point (à l’anglo-saxonne) ou d’une virgule (à la française).</li>
<li>Les valeurs textuelles sont-elles encadrées par des guillemets et, si oui, s’agit-il de guillements simple (<code>'</code>) ou de guillemets doubles (<code>"</code>) ?</li>
<li>Pour les variables textuelles, y a-t-il des <dfn data-index="valeur manquante">valeurs manquantes</dfn> <dfn data-index="manquante, valeur"></dfn> et si oui comment sont-elles indiquées ? Par exemple, le texte <code>NA</code> est parfois utilisé.</li>
</ul>
<p>Il ne faut pas hésitez à ouvrir le fichier avec un éditeur de texte pour le regarder de plus près.</p>
</div>
<div id="interface-graphique-avec-rstudio" class="section level3 hasAnchor">
<h3 class="hasAnchor">Interface graphique avec RStudio<a href="#interface-graphique-avec-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>RStudio</strong> fournit une interface graphique pour faciliter l’import d’un fichier texte. Pour cela, il suffit d’aller dans le menu <em>File &gt; Import Dataset</em> et de choisir l’option <em>From CSV</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Cette option est également disponible via l’onglet <em>Environment</em> dans le quadrant haut-droite.</p>
<p>Pour la suite de la démonstration, nous allons utiliser le fichier exemple <a href="http://larmarange.github.io/analyse-R/data/exemple_texte_tabule.txt" class="uri">http://larmarange.github.io/analyse-R/data/exemple_texte_tabule.txt</a>.</p>
<figure>
<div class="figure">
<img src="images/capture_RStudio_import_dataset.png" alt="" />
<p class="caption">Importer un fichier texte avec RStudio</p>
</div>
<figcaption>
Importer un fichier texte avec RStudio
</figcaption>
</figure>
<p>L’interface de <strong>RStudio</strong> vous présente sous <em>Import Options</em> les différentes options d’import disponible. La section <em>Data Preview</em> vous permet de voir en temps réel comment les données sont importées. La section <em>Code Preview</em> vous indique le code <strong>R</strong> correspondant à vos choix. Il n’y a plus qu’à le copier/coller dans un de vos scripts ou à cliquer sur <strong>Import</strong> pour l’exécuter.</p>
<p>Vous pourrez remarquer que <strong>RStudio</strong> fait appel à l’extension <code class="pkg">readr</code> du <dfn>tidyverse</dfn> pour l’import des données via la fonction <code data-pkg="readr" data-rdoc="read_delim">read_csv</code>.</p>
<p><code class="pkg">readr</code> essaie de deviner le type de chacune des colonnes, en se basant sur les premières observations. En cliquant sur le nom d’une colonne, il est possible de modifier le type de la variable importée. Il est également possible d’exclure une colonne de l’import (<em>skip</em>).</p>
</div>
<div id="dans-un-script" class="section level3 hasAnchor">
<h3 class="hasAnchor">Dans un script<a href="#dans-un-script" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>L’interface graphique de <strong>RStudio</strong> fournit le code d’import. On peut également l’adapter à ces besoins en consultant la page d’aide de <code data-pkg="readr" data-rdoc="read_delim">read_csv</code> pour plus de détails. Par exemple :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;http://larmarange.github.io/analyse-R/data/exemple_texte_tabule.txt&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">quote =</span> <span class="st">&quot;&#39;&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>Rows: 7 Columns: 4
-- Column specification ------------------------------------
Delimiter: &quot;\t&quot;
chr (2): Sexe, Etudes
dbl (1): Age

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Le premier élément peut être un lien internet ou bien le chemin local vers un fichier. Afin d’organiser au mieux vos fichiers, voir le chapitre <a href="organiser-ses-fichiers.html">Organiser ses fichiers</a>.</p>
<div class="note">
<p>Certains caractères sont parfois précédés d’une barre oblique inversée ou <em>antislash</em> (<code>\</code>). Cela correspond à des caractères spéciaux. En effet, <code>"</code> est utilisé pour délimiter dans le code le début et la fin d’une chaîne de caractères. Comment indiquer à <strong>R</strong> le caractère <code>"</code> proprement dit. Et bien avec <code>\"</code>. De même, <code>\t</code> sera interprété comme une tabulation et non comme la lettre <code>t</code>.</p>
<p>Pour une liste complète des caractères spéciaux, voir <code>?Quotes</code>.</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(d)</span></code></pre></div>
<pre><code>[1] &quot;spec_tbl_df&quot; &quot;tbl_df&quot;      &quot;tbl&quot;         &quot;data.frame&quot; </code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 7 x 4
  Sexe    Age Taille Etudes    
  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     
1 F        45    167 primaire  
2 H        32    183 &lt;NA&gt;      
3 H        24    172 supérieur 
4 F        36    164 secondaire
5 F        23    154 supérieur 
6 H        18    162 primaire  
7 F        34    168 secondaire</code></pre>
<p>L’objet renvoyé est un tableau de données ou <dfn lang="en">data.frame</dfn>. Plus précisément, il s’agit d’un <dfn lang="en">tibble</dfn>, c’est-à-dire un tableau de données légèrement amélioré facilement utilisable avec les différentes extensions du <dfn>tidyverse</dfn>. Pas de panique, c’est un tableau de données comme les autres. Disons qu’il est possible de faire un peu plus de choses avec. Pour cela, voir le <a href="manipuler-les-donnees-avec-dplyr.html">chapitre dédié à dplyr</a>.</p>
<p><code class="pkg">readr</code> propose plusieurs fonctions proches : <code data-pkg="readr" data-rdoc="read_delim">read_delim</code>, <code data-pkg="readr" data-rdoc="read_delim">read_csv</code>, <code data-pkg="readr" data-rdoc="read_delim">read_csv2</code> et <code data-pkg="readr" data-rdoc="read_delim">read_tsv</code>. Elles fonctionnent toutes de manière identique et ont les mêmes arguments. Seule différence, les valeurs par défaut de certainsparamètres.</p>
<div class="note">
<p>Dans des manuels ou des exemples en ligne, vous trouverez parfois mention des fonctions <code data-pkg="utils" data-rdoc="read.table">read.table</code>, <code data-pkg="utils" data-rdoc="read.table">read.csv</code>, <code data-pkg="utils" data-rdoc="read.table">read.csv2</code>, <code data-pkg="utils" data-rdoc="read.table">read.delim</code> ou encore <code data-pkg="utils" data-rdoc="read.table">read.delim2</code>. Il s’agit des fonctions natives et historiques de <strong>R</strong> (extension <code class="pkg">utils</code>) dédiées à l’import de fichiers textes. Elles sont similaires à celles de <code class="pkg">readr</code> dans l’idée générale mais diffèrent dans leurs détails et les traitements effectués sur les données (pas de détection des dates par exemple). Pour plus d’information, vous pouvez vous référer à la page d’aide de ces fonctions.</p>
</div>
</div>
</div>
<div id="importer-depuis-des-logiciels-de-statistique" class="section level2 hasAnchor">
<h2 class="hasAnchor">Importer depuis des logiciels de statistique<a href="#importer-depuis-des-logiciels-de-statistique" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plusieurs extensions existent pour importer des fichiers de données issus d’autres logiciels de statistiques. En premier lieu, il y a <code class="pkg">foreign</code>, installée par défaut avec <strong>R</strong> et décrite en détails dans le manuel <cite>R Data Import/Export</cite> disponible sur <a href="http://cran.r-project.org/manuals.html" class="uri">http://cran.r-project.org/manuals.html</a>. Un des soucis majeurs de cette extension réside dans la manière dont elle traite les <dfn data-index="métadonnée">métadonnées</dfn> utilisées en particulier dans les fichiers <strong>SAS</strong>, <strong>SPSS</strong> et <strong>Stata</strong>, à savoir les <dfn data-index="étiquette de variable">étiquettes de variable</dfn><dfn data-index="variable, étiquette"></dfn>, les <dfn data-index="étiquette de valeur">étiquettes de valeur</dfn><dfn data-index="valeur, étiquette"></dfn> et les <dfn data-index="valeur manquante déclarée">valeurs manquantes
déclarées</dfn><dfn data-index="manquante, valeur"></dfn>. En effet, chaque fonction va importer ces métadonnées sous la forme d’<dfn data-index="attribut">attributs</dfn> dont le nom diffère d’une fonction à l’autre. Par ailleurs, selon les options retenues, les <dfn data-index="variable labellisée">variables labellisées</dfn><dfn data-index="labellisée, variable"></dfn> seront parfois transformées ou non en <dfn data-index="facteur">facteurs</dfn>. Enfin, <code class="pkg">foreign</code> ne sait pas toujours importer les différents types de variables représentant des dates et des heures.</p>
<p>L’extension <code class="pkg">haven</code> (qui fait partie du <q lang="en">tidyverse</q>) tente de remédier à plusieurs des limitations rencontrées avec <code class="pkg">foreign</code> :</p>
<ul>
<li>le format des métadonnées importé est uniforme, quel que soit le type de fichier source (<strong>SAS</strong>, <strong>SPSS</strong> ou <strong>Stata</strong>) ;</li>
<li>les variables labellisées ne sont pas transformées en facteurs, mais héritent d’une nouvelle classe <code data-pkg="haven" data-rdoc="labelled">haven_labelled</code>, la valeur initiale restant inchangée ;</li>
<li>les différents formats de date sont convertis dans des classes <strong>R</strong> appropriées, utilisables en particulier avec <code class="pkg">lubridate</code> ;</li>
<li><code class="pkg">haven</code> peut lire les fichiers <strong>SAS natifs</strong> (extension <code>.sas7bdat</code>) ce que ne peut pas faire <code class="pkg">foreign</code> ;</li>
<li><code class="pkg">haven</code> peut lire les fichiers <strong>Stata</strong> 13 et 14, alors que <code class="pkg">foreign</code> ne sait lire ces fichiers que jusqu’à la version 12 ;</li>
<li>les tableaux de données produits ont directement la classe <code data-pkg="dplyr">tbl_df</code> ce qui permets d’utiliser directement les fonctionnalités de l’extension <code class="pkg">dplyr</code>.</li>
</ul>
<p>À noter, il est également possible d’utiliser l’interface graphique de <strong>RStudio</strong> pour l’import des fichiers <strong>SPSS</strong>, <strong>Stata</strong>, <strong>SAS</strong> et <strong>Excel</strong>.</p>
<div class="important">
<p><strong>Données labellisées</strong></p>
<p>À la différence de <code class="pkg">foreign</code>, <code class="pkg">haven</code> ne convertit pas les variables avec des étiquettes de valeurs en <dfn data-index="facteur">facteurs</dfn> mais en <dfn data-index="vecteur labellisé">vecteurs labellisés</dfn><dfn data-index="labellisé, vecteur"></dfn> du type <code data-pkg="haven" data-rdoc="labelled">haven_labelled</code> qui sont présentés en détail dans le chapitre <a href="facteurs-et-vecteurs-labellises.html#labelled">Facteurs et vecteurs labellisés</a> et dans le chapitre <a href="recodage.html#labelled">recodage de variables</a> où est discutée la question de savoir à quel moment convertir les données labellisées.</p>
</div>
<div id="spss" class="section level3 hasAnchor">
<h3 class="hasAnchor">SPSS<a href="#spss" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les fichiers générés par <strong>SPSS</strong><dfn data-index="SPSS, fichier"></dfn> sont de deux types : les fichiers <strong>SPSS natifs</strong> natifs (extension <code>.sav</code>) et les fichiers au format <strong>SPSS export</strong> (extension <code>.por</code>).</p>
<p>Dans les deux cas, on aura recours à la fonction <code data-pkg="haven">read_spss</code> :</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read_spss</span>(<span class="st">&quot;data/fichier.sav&quot;</span>, <span class="at">user_na =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="important">
<p><strong>Gestion des valeurs manquantes</strong></p>
<p>Dans <strong>SPSS</strong>, il est possible de définir des valeurs à considérées comme manquantes. Plus précisément jusqu’à 3 valeurs spécfiques et/ou les valeurs comprises entre un minimum et un maximum. Par défaut, <code data-pkg="haven">read_spss</code> convertir toutes ces valeurs en <code>NA</code> lors de l’import.</p>
<p>Or, il est parfois important de garder les différentes valeurs originelles, notamment dans le cadre de l’analyse de données d’enquête, un manquant du type <q>ne sait pas</q> n’étant pas équivalent à un manquant du type <q>refus</q> ou du type <q>variable non collectée</q>.</p>
<p>Dès lors, nous vous recommandons d’appeler <code data-pkg="haven">read_spss</code> avec l’option <code>user_na = TRUE</code>. Dans ce cas-là, les valeurs manquantes définies dans <strong>SPSS</strong> ne seront pas converties en <code>NA</code>, tout en conservant la définition des valeurs définies comme manquantes. Il sera alors toujours possible de convertir, dans un second temps et en fonction des besoins, ces valeurs à considérer comme manquantes en <code>NA</code> grace aux fonctions de l’extension <code>labelled</code>, en particulier <code data-pkg="labelled" data-rdoc="remove_labels">user_na_to_na</code>, <code data-pkg="labelled">na_values</code> et <code data-pkg="labelled" data-rdoc="na_values">na_range</code>.</p>
<p>À noter que les fonctions <code data-pkg="questionr">describe</code> et <code data-pkg="questionr">freq</code> de l’extension <code class="pkg">questionr</code> que nous arboderons dans d’autres chapitres savent exploiter ces valeurs à considérer comme manquantes.</p>
</div>
<div class="note">
<p>Si vous préférez utiliser l’extension <code class="pkg">foreign</code>, la fonction correspondante est <code data-kg="foreign">read.spss</code>. On indiquera à la fonction de renvoyer un tableau de données avec l’argument <code>to.data.frame = TRUE</code>.</p>
<p>Par défaut, les variables numériques pour lesquelles des <dfn data-inndex="étiquette de valeur">étiquettes de valeurs</dfn><dfn data-index="valeur, étiquette"></dfn> ont été définies sont transformées en variables de type <dfn>facteur</dfn>, les étiquettes définies dans <strong>SPSS</strong> étant utilisées comme <em>labels</em> du facteur. De même, si des <dfn data-index="valeur manquante">valeurs manquantes</dfn> ont été définies dans <strong>SPSS</strong>, ces dernières seront toutes transformées en <code>NA</code> (<strong>R</strong> ne permettant pas de gérer plusieurs types de valeurs manquantes). Ce comportement peut être modifié avec <code>use.value.labels</code> et <code>use.missings</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(<span class="st">&quot;data/fichier.sav&quot;</span>, <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>, <span class="at">use.value.labels =</span> <span class="cn">FALSE</span>, <span class="at">use.missings =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Il est important de noter que <code data-pkg="foreign">read.spss</code> de l’extension <code class="pkg">foreign</code> ne sait pas importer les dates. Ces dernières sont donc automatiquement transformées en valeurs numériques.</p>
<p><strong>SPSS</strong> stocke les dates sous la forme du nombre de secondes depuis le début du calendrier grégorien, à savoir le 14 octobre 1582. Dès lors, si l’on des dates dans un fichier <strong>SPSS</strong> et que ces dernières ont été converties en valeurs numériques, on pourra essayer la commande suivante :</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>donnees<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(donnees<span class="sc">$</span>date, <span class="at">origin =</span> <span class="st">&quot;1582-10-14&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="sas" class="section level3 hasAnchor">
<h3 class="hasAnchor">SAS<a href="#sas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les <dfn data-index="SAS, fichier">fichiers <strong>SAS</strong></dfn> se présentent en général sous deux format : format <strong>SAS export</strong> (extension <code>.xport</code> ou <code>.xpt</code>) ou format <strong>SAS natif</strong> (extension <code>.sas7bdat</code>).</p>
<p>Les fichiers <strong>SAS natifs</strong> peuvent être importées directement avec <code data-pkg="haven">read_sas</code> de l’extension <code class="pkg">haven</code> :</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="st">&quot;data/fichier.sas7bdat&quot;</span>)</span></code></pre></div>
<p>Au besoin, on pourra préciser en deuxième argument le nom d’un fichier <strong>SAS catalogue</strong> (extension <code>.sas7bcat</code>) contenant les métadonnées du fichier de données.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="st">&quot;data/fichier.sas7bdat&quot;</span>, <span class="st">&quot;data/fichier.sas7bcat&quot;</span>)</span></code></pre></div>
<p>Les fichiers au format <strong>SAS export</strong> peuvent être importés via la fonction <code data-pkg="foreign">read.xport</code> de l’extension <code class="pkg">foreign</code>. Celle-ci s’utilise très simplement, en lui passant le nom du fichier en argument :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read.xport</span>(<span class="st">&quot;data/fichier.xpt&quot;</span>)</span></code></pre></div>
</div>
<div id="stata" class="section level3 hasAnchor">
<h3 class="hasAnchor">Stata<a href="#stata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour les <dfn data-index="Stata, fichier">fichiers <strong>Stata</strong></dfn> (extension <code>.dta</code>), on aura recours aux fonctions <code data-pkg="haven">read_dta</code> et <code data-pkg="haven" data-rdoc="read_dta">read_stata</code> de l’extension <code class="pkg">haven</code>. Ces deux fonctions sont identiques.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;data/fichier.dta&quot;</span>)</span></code></pre></div>
<div class="important">
<p><strong>Gestion des valeurs manquantes</strong></p>
<p>Dans <strong>Stata</strong>, il est possible de définir plusieurs types de valeurs manquantes, qui sont notées sous la forme <code>.a</code> à <code>.z</code>. Pour conserver cette information lors de l’import, <code class="pkg">haven</code> a introduit dans <strong>R</strong> le concept de <dfn lang="en">tagged NA</dfn> ou <dfn lang="en">tagged missing value</dfn>. Plus de détails sur ces données manquantes <q>étiquettées</q>, on se référera à la page d’aide de la fonction <code data-pkg="haven">tagged_na</code>.</p>
</div>
<div class="note">
<p>Si l’on préfère utiliser l’extension <code class="pkg">foreign</code>, on aura recours à la fonction <code data-pkg="foreign">read.dta</code>.</p>
<p>L’option <code>convert.factors</code> indique si les variables labellisées doit être converties automatiquement en facteurs. Pour un résultat similaire à celui de <code class="pkg">haven</code>, on choisira donc :</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">&quot;data/fichier.dta&quot;</span>, <span class="at">convert.factors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>L’option <code>convert.dates</code> permet de convertir les dates du format <strong>Stata</strong> dans un format de dates géré par <strong>R</strong>. Cependant, cela ne marche pas toujours. Dans ces cas là, l’opération suivante peut fonctionner. Sans garantie néanmoins, il est toujours vivement conseillé de vérifier le résultat obtenu !</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>donnees<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(donnees<span class="sc">$</span>Date, <span class="at">origin =</span> <span class="st">&quot;1960-01-01&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="excel" class="section level3 hasAnchor">
<h3 class="hasAnchor">Excel<a href="#excel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une première approche pour importer des données <strong>Excel</strong> dans <strong>R</strong> consiste à les exporter depuis <strong>Excel</strong> dans un fichier texte (texte tabulé ou <strong>CSV</strong>) puis de suivre la procédure d’importation d’un fichier texte.</p>
<p>Une feuille <strong>Excel</strong> peut également être importée directement avec l’extension <code class="pkg">readxl</code> qui appartient à la même famille que <code class="pkg">haven</code> et <code class="pkg">readr</code>.</p>
<p>La fonction <code data-pkg="readxl">read_excel</code> permet d’importer à la fois des fichiers <code>.xls</code> (<strong>Excel</strong> 2003 et précédents) et <code>.xlsx</code> (<strong>Excel</strong> 2007 et suivants).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/fichier.xlsx&quot;</span>)</span></code></pre></div>
<p>Une seule feuille de calculs peut être importée à la fois. On pourra préciser la feuille désirée avec <code>sheet</code> en indiquant soit le nom de la feuille, soit sa position (première, seconde, …).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/fichier.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">3</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/fichier.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;mes_donnees&quot;</span>)</span></code></pre></div>
<p>On pourra préciser avec <code>col_names</code> si la première ligne contient le nom des variables.</p>
<p>Par défaut, <code data-pkg="readxl">read_excel</code> va essayer de deviner le type (numérique, textuelle, date) de chaque colonne. Au besoin, on pourra indiquer le type souhaité de chaque colonne avec <code>col_types</code>.</p>
<p><strong>RStudio</strong> propose également pour les fichiers <strong>Excel</strong> un assitant d’importation, similaire à celui pour les fichiers texte, permettant de faciliter l’import.</p>
<div class="note">
<p>Une première alternative est l’extenstion <code class="pkg">openxlsx</code> et sa fonction <code data-pkg="openxlsx">read.xlsx</code>.</p>
<p>Une seconde alternative est l’extension <code class="pkg">xlsx</code> qui propose deux fonctions différentes pour importer des fichiers <strong>Excel</strong> : <code data-pkg="xlsx">read.xlsx</code> et <code data-pkg="xlsx" data-rdoc="read.xlsx">read.xlsx2</code>. La finalité est la même mais leur fonctionnement interne est différent. En cas de difficultés d’import, on pourra tester l’autre. Il est impératif de spécifier la position de la feuille de calculs que l’on souhaite importer.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;data/fichier.xlsx&quot;</span>, <span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="dbase" class="section level3 hasAnchor">
<h3 class="hasAnchor">dBase<a href="#dbase" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>L’Insee et d’autres producteur de données diffusent leurs fichiers au format <strong>dBase</strong> (extension <code>.dbf</code>). Ceux-ci sont directement lisibles dans <strong>R</strong> avec la fonction <code data-pkg="foreign">read.dbf</code> de l’extension <code class="pkg">foreign</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">read.dbf</span>(<span class="st">&quot;data/fichier.dbf&quot;</span>)</span></code></pre></div>
<p>La principale limitation des <dfn data-index="dBase, fichier">fichiers <strong>dBase</strong></dfn> est de ne pas gérer plus de 256 colonnes. Les tables des enquêtes de l’Insee sont donc parfois découpées en plusieurs fichiers <code>.dbf</code> qu’il convient de fusionner avec la fonction <code data-pkg="base">merge</code>. L’utilisation de cette fonction est détaillée dans le chapitre sur la <a href="fusion-de-tables.html">fusion de tables</a>.</p>
</div>
<div id="feuille-de-calcul-google-sheets" class="section level3 hasAnchor">
<h3 class="hasAnchor">Feuille de calcul Google Sheets<a href="#feuille-de-calcul-google-sheets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour importer des données stockées sous formes de feuilles de calcul <strong>Google</strong>, on pourra se référer à l’extension <code class="pkg">googlesheets</code>.</p>
</div>
</div>
<div id="données-spatiales" class="section level2 hasAnchor">
<h2 class="hasAnchor">Données spatiales<a href="#données-spatiales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="shapefile" class="section level3 hasAnchor">
<h3 class="hasAnchor">Shapefile<a href="#shapefile" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les <dfn date-index="shapefile, fichier">fichiers <strong>Shapefile</strong></dfn> sont couramment utilisés pour échanger des données géoréférencées. La majorité des logiciels de <strong>SIG</strong> (systèmes d’informations géographiques) sont en capacité d’importer et d’exporter des données dans ce format.</p>
<p>Un <strong>shapefile</strong> contient toute l’information liée à la géométrie des objets décrits, qui peuvent être :</p>
<ul>
<li>des points</li>
<li>des lignes</li>
<li>des polygones</li>
</ul>
<p>Son extension est classiquement <code>.shp</code> et il est toujours accompagné de deux autres fichiers de même nom et d’extensions :</p>
<ul>
<li>un fichier <code>.dbf</code>, qui contient les données attributaires relatives aux objets contenus dans le <strong>shapefile</strong></li>
<li>un fichier <code>.shx</code>, qui stocke l’index de la géométrie</li>
</ul>
<p>D’autres fichiers peuvent être également fournis :</p>
<ul>
<li><code>.sbn</code> et <code>.sbx</code> - index spatial des formes.</li>
<li><code>.fbn</code> et <code>.fbx</code> - index spatial des formes pour les shapefile en lecture seule</li>
<li><code>.ain</code> et <code>.aih</code> - index des attributs des champs actifs dans une table ou dans une table d’attributs du thème</li>
<li><code>.prj</code> - information sur le système de coordonnées</li>
<li><code>.shp.xml</code> - métadonnées du shapefile.</li>
<li><code>.atx</code> - fichier d’index des attributs pour le fichier <code>.dbf</code></li>
<li><code>.qix</code></li>
</ul>
<p>En premier lieu, il importe que tous les fichiers qui compose un même <strong>shapefile</strong> soit situés dans le même répertoire et aient le même nom (seule l’extension étant différente).</p>
<p>L’extension <code class="pkg">maptools</code> fournit les fonctions permettant d’importer un <strong>shapefile</strong> dans <strong>R</strong>. Le résultat obtenu utilisera l’une des différentes classes spatiales fournies par l’extension <code class="pkg">sp</code>.</p>
<p>La fonction générique d’import est <code data-pkg="maptools">readShapeSpatial</code> :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>donnees_spatiales <span class="ot">&lt;-</span> <span class="fu">readShapeSpatial</span>(<span class="st">&quot;data/fichier.shp&quot;</span>)</span></code></pre></div>
<p>Si l’on connait déjà le type de données du <strong>shapefile</strong> (points, lignes ou polygones), on pourra utiliser directement <code data-pkg="maptools">readShapePoints</code>, <code data-pkg="maptools">readShapeLines</code> ou <code data-pkg="maptools">readShapePoly</code>.</p>
</div>
<div id="rasters" class="section level3 hasAnchor">
<h3 class="hasAnchor">Rasters<a href="#rasters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il existe de multiples formats pour stocker des données matricielles spatiales. L’un des plus communs est le format <strong>ASCII grid</strong> aussi connu sous le nom de <strong>Arc/Info ASCII grid</strong> ou <strong>ESRI grid</strong>. L’extension de ce format n’est pas toujours uniforme. On trouve parfois <code>.asc</code> ou encore <code>.ag</code> voir même <code>.txt</code>.</p>
<p>Pour importer ce type de fichier, on pourra avoir recours à la fonction <code data-pkg="maptools">readAsciiGrid</code> de l’extension <code class="pkg">maptools</code>. Le résultat sera, par défaut, au format <code data-pkg="sp" data-rdoc="SpatialGridDataFrame-class">SpatialGridDataFrame</code> de l’extension <code class="pkg">sp</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>donnees_spatiales <span class="ot">&lt;-</span> <span class="fu">readAsciiGrid</span>(<span class="st">&quot;data/fichier.asc&quot;</span>)</span></code></pre></div>
<p>L’extension <code class="pkg">raster</code> permet d’effectuer de multiples manipulations sur les données du type <dfn data-index="raster, fichier">raster</dfn>. Elle est en capacité d’importer des données depuis différents formats (plus précisément les formats pris en charge par la librairie <strong>GDAL</strong>, <a href="http://www.gdal.org/" class="uri">http://www.gdal.org/</a>).</p>
<p>De plus, les fichiers raster pouvant être particulièrement volumineux (jusqu’à plusieurs Go de données), l’extension <code class="pkg">raster</code> est capable de travailler sur un fichier raster sans avoir à le charger intégralement en mémoire.</p>
<p>Pour plus d’informations, voir les fonctions <code data-pkg="raster">raster</code> et <code data-pkg="raster">getValues</code>.</p>
</div>
</div>
<div id="connexion-à-des-bases-de-données" class="section level2 hasAnchor">
<h2 class="hasAnchor">Connexion à des bases de données<a href="#connexion-à-des-bases-de-données" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="interfaçage-via-lextension-dbi" class="section level3 hasAnchor">
<h3 class="hasAnchor">Interfaçage via l’extension DBI<a href="#interfaçage-via-lextension-dbi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>R</strong> est capable de s’interfacer avec différents systèmes de bases de données relationnelles, dont <strong>SQLite</strong>, <strong>MS SQL Server</strong>, <strong>PostgreSQL</strong>, <strong>MariaDB</strong>, etc.</p>
<p>Pour illustrer rapidement l’utilisation de bases de données, on va créer une base SQLite d’exemple à l’aide du code R suivant, qui copie la table du jeu de données <code>mtcars</code> dans une base de données <code>bdd.sqlite</code> :</p>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="at">dbname =</span> <span class="st">&quot;bdd.sqlite&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mtcars)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">&quot;mtcars&quot;</span>, mtcars)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span></code></pre></div>
<p>Si on souhaite se connecter à cette base de données par la suite, on peut utiliser l’extension <code class="pkg">DBI</code>, qui propose une interface générique entre **R// et différents systèmes de bases de données. On doit aussi avoir installé et chargé l’extension spécifique à notre base, ici <code class="pkg">RSQLite</code>. On commence par ouvrir une connexion à l’aide de la fonction <code data-pkg="DBI">dbConnect</code> de <code class="pkg">DBI</code> :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="at">dbname =</span> <span class="st">&quot;bdd.sqlite&quot;</span>)</span></code></pre></div>
<p>La connexion est stockée dans un objet <code>con</code>, qu’on va utiliser à chaque fois qu’on voudra interroger la base.</p>
<p>On peut vérifier la liste des tables présentes et les champs de ces tables avec <code data-pkg="DBI">dbListTables</code> et <code data-pkg="DBI">dbListFields</code> :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(con)</span></code></pre></div>
<pre><code>[1] &quot;mtcars&quot;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(con, <span class="st">&quot;mtcars&quot;</span>)</span></code></pre></div>
<pre><code> [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;  
 [9] &quot;am&quot;   &quot;gear&quot; &quot;carb&quot; &quot;name&quot;</code></pre>
<p>On peut également lire le contenu d’une table dans un objet de notre environnement avec <code data-pkg="DBI">dbReadTable</code> :</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> <span class="fu">dbReadTable</span>(con, <span class="st">&quot;mtcars&quot;</span>)</span></code></pre></div>
<p>On peut également envoyer une requête SQL directement à la base et récupérer le résultat avec <code data-pkg="DBI">dbGetQuery</code> :</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, <span class="st">&quot;SELECT * FROM mtcars WHERE cyl = 4&quot;</span>)</span></code></pre></div>
<pre><code>    mpg cyl  disp  hp drat    wt  qsec vs am gear carb
1  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
2  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
3  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
4  32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
5  30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
6  33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
7  21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
8  27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
9  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
10 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
11 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
             name
1      Datsun 710
2       Merc 240D
3        Merc 230
4        Fiat 128
5     Honda Civic
6  Toyota Corolla
7   Toyota Corona
8       Fiat X1-9
9   Porsche 914-2
10   Lotus Europa
11     Volvo 142E</code></pre>
<p>Enfin, quand on a terminé, on peut se déconnecter à l’aide de <code data-pkg="DBI">dbDisconnect</code> :</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span></code></pre></div>
<p>Ceci n’est évidemment qu’un tout petit aperçu des fonctionnalités de <code class="pkg">DBI</code>.</p>
</div>
<div id="utilisation-de-dplyr-et-dbplyr" class="section level3 hasAnchor">
<h3 class="hasAnchor">Utilisation de dplyr et dbplyr<a href="#utilisation-de-dplyr-et-dbplyr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>L’extension <code class="pkg">dplyr</code> est dédiée à la manipulation de données, elle est présentée dans un <a href="manipuler-les-donnees-avec-dplyr.html">chapitre dédié</a>. En installant l’extension complémentaire <code class="pkg">dbplyr</code>, on peut utiliser <code class="pkg">dplyr</code> directement sur une connection à une base de données générée par <code class="pkg">DBI</code> :</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="at">dbname =</span> <span class="st">&quot;bdd.sqlite&quot;</span>)</span></code></pre></div>
<p>La fonction <code data-pkg="dplyr">tbl</code> notamment permet de créer un nouvel objet qui représente une table de la base de données :</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cars_tbl <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">&quot;mtcars&quot;</span>)</span></code></pre></div>
<div class="important">
<p>Ici l’objet <code>cars_tbl</code> n’est <em>pas</em> un tableau de données, c’est juste un objet permettant d’interroger la table de notre base de données.</p>
</div>
<p>On peut utiliser cet objet avec les <a href="manipuler-les-donnees-avec-dplyr.html">verbes</a> de <code class="pkg">dplyr</code> :</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>cars_tbl <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, mpg, cyl)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Datsun 710","2":"22.8","3":"4"},{"1":"Merc 240D","2":"24.4","3":"4"},{"1":"Merc 230","2":"22.8","3":"4"},{"1":"Fiat 128","2":"32.4","3":"4"},{"1":"Honda Civic","2":"30.4","3":"4"},{"1":"Toyota Corolla","2":"33.9","3":"4"},{"1":"Toyota Corona","2":"21.5","3":"4"},{"1":"Fiat X1-9","2":"27.3","3":"4"},{"1":"Porsche 914-2","2":"26.0","3":"4"},{"1":"Lotus Europa","2":"30.4","3":"4"},{"1":"Volvo 142E","2":"21.4","3":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code class="pkg">dbplyr</code> s’occupe, de manière transparente, de transformer les instructions <code class="pkg">dplyr</code> en requête SQL, d’interroger la base de données et de renvoyer le résultat. De plus, tout est fait pour qu’un minimum d’opérations sur la base, parfois coûteuses en temps de calcul, ne soient effectuées.</p>
<div class="important">
<p>Il est possible de modifier des objets de type <code>tbl</code>, par exemple avec <code data-pkg="dplyr">mutate</code> :</p>
<p><code>cars_tbl &lt;- cars_tbl %&gt;% mutate(type = "voiture")</code></p>
<p>Dans ce cas la nouvelle colonne <code>type</code> est bien créée et on peut y accéder par la suite. Mais <strong>cette création se fait dans une table temporaire</strong> : elle n’existe que le temps de la connexion à la base de données. À la prochaine connexion, cette nouvelle colonne n’apparaîtra pas dans la table.</p>
</div>
<p>Bien souvent on utilisera une base de données quand les données sont trop volumineuses pour être gérées par un ordinateur de bureau. Mais si les données ne sont pas trop importantes, il sera toujours plus rapide de récupérer l’intégralité de la table dans notre session R pour pouvoir la manipuler comme les tableaux de données habituels. Ceci se fait grâce à la fonction <code data-pkg="dplyr" data-rdoc="compute">collect</code> de <code class="pkg">dplyr</code> :</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> cars_tbl <span class="sc">%&gt;%</span> <span class="fu">collect</span>()</span></code></pre></div>
<p>Ici, <code>cars</code> est bien un tableau de données classique, copie de la table de la base au moment du <code data-pkg="dplyr" data-rdoc="compute">collect</code>.</p>
<p>Et dans tous les cas, on n’oubliera pas de se déconnecter avec :</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span></code></pre></div>
</div>
<div id="ressources" class="section level3 hasAnchor">
<h3 class="hasAnchor">Ressources<a href="#ressources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour plus d’informations, voir la <a href="https://db.rstudio.com/">documentation très complète</a> (en anglais) proposée par RStudio.</p>
<p>Par ailleurs, depuis la version 1.1, RStudio facilite la connexion à certaines bases de données grâce à l’onglet <em>Connections</em>. Pour plus d’informations on pourra se référer à l’article (en anglais) <a href="https://support.rstudio.com/hc/en-us/articles/115010915687-Using-RStudio-Connections">Using RStudio Connections</a>.</p>
</div>
</div>
<div id="autres-sources" class="section level2 hasAnchor">
<h2 class="hasAnchor">Autres sources<a href="#autres-sources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>R</strong> offre de très nombreuses autres possibilités pour accéder aux données. Il est ainsi possible d’importer des données depuis d’autres applications qui n’ont pas été évoquées (<strong>Epi Info</strong>, <strong>S-Plus</strong>, etc.), de lire des données via <strong>ODBC</strong> ou des connexions réseau, etc.</p>
<p>Pour plus d’informations on consultera le manuel <em>R Data Import/Export</em> :<br /> <a href="http://cran.r-project.org/manuals.html" class="uri">http://cran.r-project.org/manuals.html</a>.</p>
<p>La section <a href="https://github.com/qinwf/awesome-R#awesome-r-database-management">Database Management</a> du site <em>Awesome R</em> fournit également une liste d’extensions permettant de s’interfacer avec différents gestionnaires de bases de données.</p>
</div>
<div id="sauver-ses-données" class="section level2 hasAnchor">
<h2 class="hasAnchor">Sauver ses données<a href="#sauver-ses-données" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>R</strong> dispose également de son propre format pour sauvegarder et échanger des données. On peut sauver n’importe quel objet créé avec <strong>R</strong> et il est possible de sauver plusieurs objets dans un même fichier. L’usage est d’utiliser l’extension <code>.RData</code> pour les fichiers de données <strong>R</strong>. La fonction à utiliser s’appelle tout simplement <code data-pkg="base">save</code>.</p>
<p>Par exemple, si l’on souhaite sauvegarder son tableau de données <code>d</code> ainsi que les objets <code>tailles</code> et <code>poids</code> dans un fichier <code>export.RData</code> :</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(d, tailles, poids, <span class="at">file =</span> <span class="st">&quot;export.RData&quot;</span>)</span></code></pre></div>
<p>À tout moment, il sera toujours possible de recharger ces données en mémoire à l’aide de la fonction <code data-pkg="base">load</code> :</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;export.RData&quot;</span>)</span></code></pre></div>
<div class="important">
<p>Si entre temps vous aviez modifié votre tableau <code>d</code>, vos modifications seront perdues. En effet, si lors du chargement de données, un objet du même nom existe en mémoire, ce dernier sera remplacé par l’objet importé.</p>
</div>
<p>La fonction <code data-pkg="base" data-rdoc="save">save.image</code> est un raccourci pour sauvergarder tous les objets de la session de travail dans le fichier <code>.RData</code> (un fichier un peu étrange car il n’a pas de nom mais juste une extension). Lors de la fermeture de <strong>RStudio</strong>, il vous sera demandé si vous souhaitez enregistrer votre session. Si vous répondez <em>Oui</em>, c’est cette fonction <code data-pkg="base" data-rdoc="save">save.image</code> qui sera appliquée.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>()</span></code></pre></div>
<pre><code>[1] FALSE</code></pre>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>L’option CSV fonctionne pour tous les fichiers de type texte, même si votre fichier a une autre extension, <code>.txt</code> par exemple<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copié !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
-->

<!-- Giscus comments -->
<script src="https://giscus.app/client.js"
        data-repo="larmarange/analyse-R"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzNDk4NjY2Ng=="
        data-category-id="DIC_kwDOAhXaqs4B_iH_"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="light"
        data-lang="fr"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->



</body>
</html>
