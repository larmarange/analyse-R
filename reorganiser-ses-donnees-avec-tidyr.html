<!DOCTYPE html>

<html lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Réorganiser ses données avec tidyr</title>

<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnees.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <li><a href="scraping.html">Scraping</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe avec <strong>survey</strong></a></li>
                  <li><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="gtsummary.html">Tableaux statistiques avancés avec <strong>gtsummary</strong></a></li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="modeles.html">Quel type de modèles choisir ?</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Modèles à effets aléatoires (modèles mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de données longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
                  <li><a href="analyse-textuelle.html">Analyse textuelle</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">Étendre <strong>ggplot2</strong></a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="exemples-graphiques-avances.html">Exemples de graphiques avancés</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
                  <li><a href="autres-extensions-graphiques.html">Autres extensions graphiques</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation (dont <strong>purrr</strong>)</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres avec <strong>scales</strong></a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations mathématiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <li><a href="https://larmarange.github.io/webin-R/">webin-R</a></li>
        <li><a href="https://www.youtube.com/c/webinR"><i class="fa fa-youtube" aria-hidden="true"></i></a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div id="header">



<h1 class="title toc-ignore">Réorganiser ses données avec tidyr</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#tidy-data">Tidy data<span></span></a></li>
<li><a href="#trois-règles-pour-des-données-bien-rangées">Trois règles pour des données bien rangées<span></span></a></li>
<li><a href="#les-verbes-de-tidyr">Les verbes de tidyr<span></span></a>
<ul>
<li><a href="#pivot_longer-rassembler-des-colonnes">pivot_longer : rassembler des colonnes<span></span></a></li>
<li><a href="#pivot_wider-disperser-des-lignes">pivot_wider : disperser des lignes<span></span></a></li>
<li><a href="#separate">separate : séparer une colonne en plusieurs<span></span></a></li>
<li><a href="#unite-regrouper-plusieurs-colonnes-en-une-seule">unite : regrouper plusieurs colonnes en une seule<span></span></a></li>
<li><a href="#extract">extract : créer de nouvelles colonnes à partir d’une colonne de texte<span></span></a></li>
<li><a href="#complete-compléter-des-combinaisons-de-variables-manquantes">complete : compléter des combinaisons de variables manquantes<span></span></a></li>
</ul></li>
<li><a href="#ressources">Ressources<span></span></a></li>
<li><a href="#fichiers-volumineux">Fichiers volumineux<span></span></a></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Julien Barnier dans le cadre de son <a href="https://juba.github.io/tidyverse/12-tidyr.html">Introduction à R et au <em>tidyverse</em></a>.</p>
</div>
<div class="webin-R">
<p>Ce chapitre est évoqué dans le webin-R #13 (exemples de graphiques avancés) sur <a href="https://youtu.be/5sD4Z8bTlMM">YouTube</a>.</p>
<p>Ce chapitre est évoqué dans le webin-R #17 (trajectoires de soins : un exemple de données longitudinales) sur <a href="https://youtu.be/JV1Srrg09oI">YouTube</a>.</p>
</div>
<div id="tidy-data" class="section level2 hasAnchor">
<h2 class="hasAnchor">Tidy data<a href="#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comme indiqué dans l’<a href="introduction-au-tidyverse.html#tidydata">introduction au tidyverse</a>, les extensions du <strong>tidyverse</strong> comme <code class="pkg">dplyr</code> ou <code class="pkg">ggplot2</code> partent du principe que les données sont “bien rangées” sous forme de <dfn lang="en">tidy data</dfn>.</p>
<p>Prenons un exemple avec les données suivantes, qui indique la population de trois pays pour quatre années différentes :</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">1992</th>
<th align="right">1997</th>
<th align="right">2002</th>
<th align="right">2007</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Belgium</td>
<td align="right">10045622</td>
<td align="right">10199787</td>
<td align="right">10311970</td>
<td align="right">10392226</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">57374179</td>
<td align="right">58623428</td>
<td align="right">59925035</td>
<td align="right">61083916</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">80597764</td>
<td align="right">82011073</td>
<td align="right">82350671</td>
<td align="right">82400996</td>
</tr>
</tbody>
</table>
<p>Imaginons qu’on souhaite représenter avec <code class="pkg">ggplot2</code> l’évolution de la population pour chaque pays sous forme de lignes : c’est impossible avec les données sous ce format. On a besoin d’arranger le tableau de la manière suivante :</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">annee</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Belgium</td>
<td align="right">1992</td>
<td align="right">10045622</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">1992</td>
<td align="right">57374179</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">1992</td>
<td align="right">80597764</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="right">1997</td>
<td align="right">10199787</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="right">1997</td>
<td align="right">58623428</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="right">1997</td>
<td align="right">82011073</td>
</tr>
<tr class="odd">
<td align="left">Belgium</td>
<td align="right">2002</td>
<td align="right">10311970</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">2002</td>
<td align="right">59925035</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">2002</td>
<td align="right">82350671</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="right">2007</td>
<td align="right">10392226</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="right">2007</td>
<td align="right">61083916</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="right">2007</td>
<td align="right">82400996</td>
</tr>
</tbody>
</table>
<p>C’est seulement avec les données dans ce format qu’on peut réaliser le graphique :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> annee, <span class="at">y =</span> population, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(d<span class="sc">$</span>annee))</span></code></pre></div>
<p><img src="graphs/reorganiser-ses-donnees-avec-tidyr/unnamed-chunk-4-1.png" width="1050" /></p>
<p>C’est la même chose pour <code class="pkg">dplyr</code>, par exemple si on voulait calculer la population minimale pour chaque pays avec <code data-pkg="dplyr">summarise</code> :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pop_min =</span> <span class="fu">min</span>(population))</span></code></pre></div>
<pre><code>   pop_min
1 10045622</code></pre>
</div>
<div id="trois-règles-pour-des-données-bien-rangées" class="section level2 hasAnchor">
<h2 class="hasAnchor">Trois règles pour des données bien rangées<a href="#trois-règles-pour-des-données-bien-rangées" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le concept de <em>tidy data</em> repose sur trois règles interdépendantes. Des données sont considérées comme <em>tidy</em> si :</p>
<ol style="list-style-type: decimal">
<li>chaque ligne correspond à une observation</li>
<li>chaque colonne correspond à une variable</li>
<li>chaque valeur est présente dans une unique case de la table ou, de manière équivalente, si des unités d’observations différentes sont présentes dans des tables différentes</li>
</ol>
<p>Ces règles ne sont pas forcément très intuitives. De plus, il y a une infinité de manières pour un tableau de données de ne pas être <em>tidy</em>.</p>
<p>Prenons par exemple les règles 1 et 2 et le tableau de notre premier exemple :</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">1992</th>
<th align="right">1997</th>
<th align="right">2002</th>
<th align="right">2007</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Belgium</td>
<td align="right">10045622</td>
<td align="right">10199787</td>
<td align="right">10311970</td>
<td align="right">10392226</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">57374179</td>
<td align="right">58623428</td>
<td align="right">59925035</td>
<td align="right">61083916</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">80597764</td>
<td align="right">82011073</td>
<td align="right">82350671</td>
<td align="right">82400996</td>
</tr>
</tbody>
</table>
<p>Pourquoi ce tableau n’est pas <em>tidy</em> ? Parce que si on essaie d’identifier les variables mesurées dans le tableau, il y en a trois : le pays, l’année et la population. Or elles ne correspondent pas aux colonnes de la table. C’est le cas par contre pour la table transformée :</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="left">annee</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Belgium</td>
<td align="left">1992</td>
<td align="right">10045622</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="left">1992</td>
<td align="right">57374179</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="left">1992</td>
<td align="right">80597764</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="left">1997</td>
<td align="right">10199787</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="left">1997</td>
<td align="right">58623428</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">1997</td>
<td align="right">82011073</td>
</tr>
<tr class="odd">
<td align="left">Belgium</td>
<td align="left">2002</td>
<td align="right">10311970</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="left">2002</td>
<td align="right">59925035</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="left">2002</td>
<td align="right">82350671</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="left">2007</td>
<td align="right">10392226</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="left">2007</td>
<td align="right">61083916</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">2007</td>
<td align="right">82400996</td>
</tr>
</tbody>
</table>
<p>On peut remarquer qu’en modifiant notre table pour satisfaire à la deuxième règle, on a aussi réglé la première : chaque ligne correspond désormais à une observation, en l’occurrence l’observation de trois pays à plusieurs moments dans le temps. Dans notre table d’origine, chaque ligne comportait en réalité quatre observations différentes.</p>
<p>Ce point permet d’illustrer le fait que les règles sont interdépendantes.</p>
<p>Autre exemple, généré depuis le jeu de données <code class="pkg">nycflights13</code>, permettant cette fois d’illustrer la troisième règle :</p>
<table>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
<th align="right">dep_time</th>
<th align="left">carrier</th>
<th align="left">name</th>
<th align="right">flights_per_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="left">UA</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">58665</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">533</td>
<td align="left">UA</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">58665</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">542</td>
<td align="left">AA</td>
<td align="left">American Airlines Inc.</td>
<td align="right">32729</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">554</td>
<td align="left">UA</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">58665</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">558</td>
<td align="left">AA</td>
<td align="left">American Airlines Inc.</td>
<td align="right">32729</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">558</td>
<td align="left">UA</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">58665</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">558</td>
<td align="left">UA</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">58665</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">559</td>
<td align="left">AA</td>
<td align="left">American Airlines Inc.</td>
<td align="right">32729</td>
</tr>
</tbody>
</table>
<p>Dans ce tableau on a bien une observation par ligne (un vol), et une variable par colonne. Mais on a une “infraction” à la troisième règle, qui est que chaque valeur doit être présente dans une unique case : si on regarde la colonne <code>name</code>, on a en effet une duplication de l’information concernant le nom des compagnies aériennes. Notre tableau mêle en fait deux types d’observations différents : des observations sur les vols, et des observations sur les compagnies aériennes.</p>
<p>Pour “arranger” ce tableau, il faut séparer les deux types d’observations en deux tables différentes :</p>
<table>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
<th align="right">dep_time</th>
<th align="left">carrier</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="left">UA</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">533</td>
<td align="left">UA</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">542</td>
<td align="left">AA</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">554</td>
<td align="left">UA</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">558</td>
<td align="left">AA</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">558</td>
<td align="left">UA</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">558</td>
<td align="left">UA</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">559</td>
<td align="left">AA</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left">carrier</th>
<th align="left">name</th>
<th align="right">flights_per_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UA</td>
<td align="left">United Air Lines Inc.</td>
<td align="right">58665</td>
</tr>
<tr class="even">
<td align="left">AA</td>
<td align="left">American Airlines Inc.</td>
<td align="right">32729</td>
</tr>
</tbody>
</table>
<p>On a désormais deux tables distinctes, l’information n’est pas dupliquée, et on peut facilement faire une jointure si on a besoin de récupérer l’information d’une table dans une autre.</p>
</div>
<div id="les-verbes-de-tidyr" class="section level2 hasAnchor">
<h2 class="hasAnchor">Les verbes de tidyr<a href="#les-verbes-de-tidyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’objectif de <code class="pkg">tidyr</code> est de fournir des fonctions pour arranger ses données et les convertir dans un format <em>tidy</em>. Ces fonctions prennent la forme de verbes qui viennent compléter ceux de <code class="pkg">dplyr</code> et s’intègrent parfaitement dans les séries de <em>pipes</em> (<code>%&gt;%</code>), les <em>pipelines</em>, permettant d’enchaîner les opérations.</p>
<div id="pivot_longer-rassembler-des-colonnes" class="section level3 hasAnchor">
<h3 class="hasAnchor">pivot_longer : rassembler des colonnes<a href="#pivot_longer-rassembler-des-colonnes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prenons le tableau <code>d</code> suivant, qui liste la population de 6 pays en 2002 et 2007 :</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">2002</th>
<th align="right">2007</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Belgium</td>
<td align="right">10311970</td>
<td align="right">10392226</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">59925035</td>
<td align="right">61083916</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">82350671</td>
<td align="right">82400996</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">57926999</td>
<td align="right">58147733</td>
</tr>
<tr class="odd">
<td align="left">Spain</td>
<td align="right">40152517</td>
<td align="right">40448191</td>
</tr>
<tr class="even">
<td align="left">Switzerland</td>
<td align="right">7361757</td>
<td align="right">7554661</td>
</tr>
</tbody>
</table>
<p>Dans ce tableau, une même variable (la population) est répartie sur plusieurs colonnes, chacune représentant une observation à un moment différent. On souhaite que la variable ne représente plus qu’une seule colonne, et que les observations soient réparties sur plusieurs lignes.</p>
<p>Pour cela on va utiliser la fonction <code data-pkg="tidyr">pivot_longer</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">2002</span><span class="st">`</span>, <span class="st">`</span><span class="at">2007</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;population&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 12 x 3
   country     annee population
   &lt;fct&gt;       &lt;chr&gt;      &lt;int&gt;
 1 Belgium     2002    10311970
 2 Belgium     2007    10392226
 3 France      2002    59925035
 4 France      2007    61083916
 5 Germany     2002    82350671
 6 Germany     2007    82400996
 7 Italy       2002    57926999
 8 Italy       2007    58147733
 9 Spain       2002    40152517
10 Spain       2007    40448191
11 Switzerland 2002     7361757
12 Switzerland 2007     7554661</code></pre>
<p>La fonction <code data-pkg="tidyr">pivot_longer</code> prend comme arguments la liste des colonnes à rassembler (on peut également y utiliser les différentes fonctions de sélection de variables utilisables avec <code data-pkg="dplyr">select</code>, voir <code data-pkg="tidyselect">select_helpers</code>), ainsi que deux arguments <code>names_to</code> et <code>values_to</code> :</p>
<ul>
<li><code>names_to</code> est le nom de la colonne qui va contenir les “noms” des colonnes originelles, c’est-à-dire les identifiants des différentes observations</li>
<li><code>values_to</code> est le nom de la colonne qui va contenir la valeur des observations</li>
</ul>
<p>Parfois il est plus rapide d’indiquer à <code data-pkg="tidyr">pivot_longer</code> les colonnes qu’on ne souhaite pas rassembler. On peut le faire avec la syntaxe suivante :</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;population&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 12 x 3
   country     annee population
   &lt;fct&gt;       &lt;chr&gt;      &lt;int&gt;
 1 Belgium     2002    10311970
 2 Belgium     2007    10392226
 3 France      2002    59925035
 4 France      2007    61083916
 5 Germany     2002    82350671
 6 Germany     2007    82400996
 7 Italy       2002    57926999
 8 Italy       2007    58147733
 9 Spain       2002    40152517
10 Spain       2007    40448191
11 Switzerland 2002     7361757
12 Switzerland 2007     7554661</code></pre>
</div>
<div id="pivot_wider-disperser-des-lignes" class="section level3 hasAnchor">
<h3 class="hasAnchor">pivot_wider : disperser des lignes<a href="#pivot_wider-disperser-des-lignes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code data-pkg="tidyr">pivot_wider</code><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> est l’inverse de <code data-pkg="tidyr">pivot_longer</code>.</p>
<p>Soit le tableau <code>d</code> suivant :</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="left">continent</th>
<th align="right">year</th>
<th align="left">variable</th>
<th align="right">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">lifeExp</td>
<td align="right">78.320</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">lifeExp</td>
<td align="right">79.441</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">lifeExp</td>
<td align="right">79.590</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">lifeExp</td>
<td align="right">80.657</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">lifeExp</td>
<td align="right">78.670</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">lifeExp</td>
<td align="right">79.406</td>
</tr>
<tr class="odd">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">pop</td>
<td align="right">10311970.000</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">pop</td>
<td align="right">10392226.000</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">pop</td>
<td align="right">59925035.000</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">pop</td>
<td align="right">61083916.000</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">pop</td>
<td align="right">82350671.000</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">pop</td>
<td align="right">82400996.000</td>
</tr>
</tbody>
</table>
<p>Ce tableau a le problème inverse du précédent : on a deux variables, <code>lifeExp</code> et <code>pop</code> qui, plutôt que d’être réparties en deux colonnes, sont réparties entre plusieurs lignes.</p>
<p>On va donc utiliser <code data-pkg="tidyr">pivot_wider</code> pour <q>disperser</q> ces lignes dans deux colonnes différentes :</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> value)</span></code></pre></div>
<pre><code># A tibble: 6 x 5
  country continent  year lifeExp      pop
  &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 Belgium Europe     2002    78.3 10311970
2 Belgium Europe     2007    79.4 10392226
3 France  Europe     2002    79.6 59925035
4 France  Europe     2007    80.7 61083916
5 Germany Europe     2002    78.7 82350671
6 Germany Europe     2007    79.4 82400996</code></pre>
<p><code data-pkg="tidyr">pivot_wider</code> prend deux arguments principaux :</p>
<ul>
<li><code>names_from</code> indique la colonne contenant les noms des nouvelles variables à créer</li>
<li><code>values_from</code> indique la colonne contenant les valeurs de ces variables</li>
</ul>
<p>Il peut arriver que certaines variables soient absentes pour certaines observations. Dans ce cas l’argument <code>values_fill</code> permet de spécifier la valeur à utiliser pour ces données manquantes (par défaut, les valauers manquantes sont indiquées avec <code>NA</code>).</p>
<p>Exemple avec le tableau <code>d</code> suivant :</p>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="left">continent</th>
<th align="right">year</th>
<th align="left">variable</th>
<th align="right">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">lifeExp</td>
<td align="right">78.320</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">lifeExp</td>
<td align="right">79.441</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">lifeExp</td>
<td align="right">79.590</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">lifeExp</td>
<td align="right">80.657</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">lifeExp</td>
<td align="right">78.670</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">lifeExp</td>
<td align="right">79.406</td>
</tr>
<tr class="odd">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">pop</td>
<td align="right">10311970.000</td>
</tr>
<tr class="even">
<td align="left">Belgium</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">pop</td>
<td align="right">10392226.000</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">pop</td>
<td align="right">59925035.000</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">pop</td>
<td align="right">61083916.000</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">pop</td>
<td align="right">82350671.000</td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">Europe</td>
<td align="right">2007</td>
<td align="left">pop</td>
<td align="right">82400996.000</td>
</tr>
<tr class="odd">
<td align="left">France</td>
<td align="left">Europe</td>
<td align="right">2002</td>
<td align="left">density</td>
<td align="right">94.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> value)</span></code></pre></div>
<pre><code># A tibble: 6 x 6
  country continent  year lifeExp      pop density
  &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Belgium Europe     2002    78.3 10311970      NA
2 Belgium Europe     2007    79.4 10392226      NA
3 France  Europe     2002    79.6 59925035      94
4 France  Europe     2007    80.7 61083916      NA
5 Germany Europe     2002    78.7 82350671      NA
6 Germany Europe     2007    79.4 82400996      NA</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> value, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">value =</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code># A tibble: 6 x 6
  country continent  year lifeExp      pop density
  &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Belgium Europe     2002    78.3 10311970       0
2 Belgium Europe     2007    79.4 10392226       0
3 France  Europe     2002    79.6 59925035      94
4 France  Europe     2007    80.7 61083916       0
5 Germany Europe     2002    78.7 82350671       0
6 Germany Europe     2007    79.4 82400996       0</code></pre>
</div>
<div id="separate" class="section level3 hasAnchor">
<h3 class="hasAnchor">separate : séparer une colonne en plusieurs<a href="#separate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Parfois on a plusieurs informations réunies en une seule colonne et on souhaite les séparer. Soit le tableau d’exemple caricatural suivant, nommé <code>df</code> :</p>
<table>
<thead>
<tr class="header">
<th align="left">eleve</th>
<th align="left">note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Félicien Machin</td>
<td align="left">5/20</td>
</tr>
<tr class="even">
<td align="left">Raymonde Bidule</td>
<td align="left">6/10</td>
</tr>
<tr class="odd">
<td align="left">Martial Truc</td>
<td align="left">87/100</td>
</tr>
</tbody>
</table>
<p><code data-pkg="tidyr">separate</code> permet de séparer la colonne <code>note</code> en deux nouvelles colonnes <code>note</code> et <code>note_sur</code> :</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">separate</span>(note, <span class="fu">c</span>(<span class="st">&quot;note&quot;</span>, <span class="st">&quot;note_sur&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  eleve           note  note_sur
  &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;   
1 Félicien Machin 5     20      
2 Raymonde Bidule 6     10      
3 Martial Truc    87    100     </code></pre>
<p><code data-pkg="tidyr">separate</code> prend deux arguments principaux, le nom de la colonne à séparer et un vecteur indiquant les noms des nouvelles variables à créer. Par défaut <code data-pkg="tidyr">separate</code> <q>sépare</q> au niveau des caractères non-alphanumérique (espace, symbole, etc.). On peut lui indiquer explicitement le caractère sur lequel séparer avec l’argument <code>sep</code> :</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(eleve, <span class="fu">c</span>(<span class="st">&quot;prenom&quot;</span>, <span class="st">&quot;nom&quot;</span>), <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  prenom   nom    note  
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; 
1 Félicien Machin 5/20  
2 Raymonde Bidule 6/10  
3 Martial  Truc   87/100</code></pre>
</div>
<div id="unite-regrouper-plusieurs-colonnes-en-une-seule" class="section level3 hasAnchor">
<h3 class="hasAnchor">unite : regrouper plusieurs colonnes en une seule<a href="#unite-regrouper-plusieurs-colonnes-en-une-seule" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code data-pkg="tidyr">unite</code> est l’opération inverse de <code data-pkg="tidyr">separate</code>. Elle permet de regrouper plusieurs colonnes en une seule. Imaginons qu’on obtient le tableau <code>d</code> suivant :</p>
<table>
<thead>
<tr class="header">
<th align="left">code_departement</th>
<th align="left">code_commune</th>
<th align="left">commune</th>
<th align="right">pop_tot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">01</td>
<td align="left">004</td>
<td align="left">Ambérieu-en-Bugey</td>
<td align="right">14233</td>
</tr>
<tr class="even">
<td align="left">01</td>
<td align="left">007</td>
<td align="left">Ambronay</td>
<td align="right">2437</td>
</tr>
<tr class="odd">
<td align="left">01</td>
<td align="left">014</td>
<td align="left">Arbent</td>
<td align="right">3440</td>
</tr>
<tr class="even">
<td align="left">01</td>
<td align="left">024</td>
<td align="left">Attignat</td>
<td align="right">3110</td>
</tr>
<tr class="odd">
<td align="left">01</td>
<td align="left">025</td>
<td align="left">Bâgé-la-Ville</td>
<td align="right">3130</td>
</tr>
<tr class="even">
<td align="left">01</td>
<td align="left">027</td>
<td align="left">Balan</td>
<td align="right">2785</td>
</tr>
</tbody>
</table>
<p>On souhaite reconstruire une colonne <code>code_insee</code> qui indique le code INSEE de la commune, et qui s’obtient en concaténant le code du département et celui de la commune. On peut utiliser <code data-pkg="tidyr">unite</code> pour cela :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">unite</span>(code_insee, code_departement, code_commune)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  code_insee commune           pop_tot
  &lt;chr&gt;      &lt;chr&gt;               &lt;int&gt;
1 01_004     Ambérieu-en-Bugey   14233
2 01_007     Ambronay             2437
3 01_014     Arbent               3440
4 01_024     Attignat             3110
5 01_025     Bâgé-la-Ville        3130
6 01_027     Balan                2785</code></pre>
<p>Le résultat n’est pas idéal : par défaut <code data-pkg="tidyr">unite</code> ajoute un caractère <code>_</code> entre les deux valeurs concaténées, alors qu’on ne veut aucun séparateur. De plus, on souhaite conserver nos deux colonnes d’origine, qui peuvent nous être utiles. On peut résoudre ces deux problèmes à l’aide des arguments <code>sep</code> et <code>remove</code> :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(code_insee, code_departement, code_commune,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>, <span class="at">remove =</span> <span class="cn">FALSE</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code># A tibble: 6 x 5
  code_insee code_departement code_commune commune   pop_tot
  &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;       &lt;int&gt;
1 01004      01               004          Ambérieu~   14233
2 01007      01               007          Ambronay     2437
3 01014      01               014          Arbent       3440
4 01024      01               024          Attignat     3110
5 01025      01               025          Bâgé-la-~    3130
6 01027      01               027          Balan        2785</code></pre>
</div>
<div id="extract" class="section level3 hasAnchor">
<h3 class="hasAnchor">extract : créer de nouvelles colonnes à partir d’une colonne de texte<a href="#extract" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code data-pkg="tidyr">extract</code> permet de créer de nouvelles colonnes à partir de sous-chaînes d’une colonne de texte existante, identifiées par des groupes dans une expression régulière.</p>
<p>Par exemple, à partir du tableau suivant :</p>
<table>
<thead>
<tr class="header">
<th align="left">eleve</th>
<th align="left">note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Félicien Machin</td>
<td align="left">5/20</td>
</tr>
<tr class="even">
<td align="left">Raymonde Bidule</td>
<td align="left">6/10</td>
</tr>
<tr class="odd">
<td align="left">Martial Truc</td>
<td align="left">87/100</td>
</tr>
</tbody>
</table>
<p>On peut extraire les noms et prénoms dans deux nouvelles colonnes avec :</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">extract</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  eleve,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;prenom&quot;</span>, <span class="st">&quot;nom&quot;</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;^(.*) (.*)$&quot;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prenom"],"name":[1],"type":["chr"],"align":["left"]},{"label":["nom"],"name":[2],"type":["chr"],"align":["left"]},{"label":["note"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Félicien","2":"Machin","3":"5/20"},{"1":"Raymonde","2":"Bidule","3":"6/10"},{"1":"Martial","2":"Truc","3":"87/100"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>On passe donc à <code data-pkg="tidyr">extract</code> trois arguments : la colonne d’où on doit extraire les valeurs, un vecteur avec les noms des nouvelles colonnes à créer, et une expression régulière comportant autant de groupes (identifiés par des parenthèses) que de nouvelles colonnes.</p>
<p>Par défaut la colonne d’origine n’est pas conservée dans la table résultat. On peut modifier ce comportement avec l’argument <code>remove = FALSE</code>. Ainsi, le code suivant extrait les initiales du prénom et du nom mais conserve la colonne d’origine :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">extract</span>(eleve,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;initiale_prenom&quot;</span>, <span class="st">&quot;initiale_nom&quot;</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;^(.).* (.).*$&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove =</span> <span class="cn">FALSE</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["eleve"],"name":[1],"type":["chr"],"align":["left"]},{"label":["initiale_prenom"],"name":[2],"type":["chr"],"align":["left"]},{"label":["initiale_nom"],"name":[3],"type":["chr"],"align":["left"]},{"label":["note"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Félicien Machin","2":"F","3":"M","4":"5/20"},{"1":"Raymonde Bidule","2":"R","3":"B","4":"6/10"},{"1":"Martial Truc","2":"M","3":"T","4":"87/100"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="complete-compléter-des-combinaisons-de-variables-manquantes" class="section level3 hasAnchor">
<h3 class="hasAnchor">complete : compléter des combinaisons de variables manquantes<a href="#complete-compléter-des-combinaisons-de-variables-manquantes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Imaginons qu’on ait le tableau de résultats suivants :</p>
<table>
<thead>
<tr class="header">
<th align="left">eleve</th>
<th align="left">matiere</th>
<th align="right">note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alain</td>
<td align="left">Maths</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">Alain</td>
<td align="left">Français</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">Barnabé</td>
<td align="left">Maths</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">Chantal</td>
<td align="left">Français</td>
<td align="right">11</td>
</tr>
</tbody>
</table>
<p>Les élèves Barnabé et Chantal n’ont pas de notes dans toutes les matières. Supposons que c’est parce qu’ils étaient absents et que leur note est en fait un 0. Si on veut calculer les moyennes des élèves, on doit compléter ces notes manquantes.</p>
<p>La fonction <code data-pkg="tidyr">complete</code> est prévue pour ce cas de figure : elle permet de compléter des combinaisons manquantes de valeurs de plusieurs colonnes.</p>
<p>On peut l’utiliser de cette manière :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">complete</span>(eleve, matiere)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["eleve"],"name":[1],"type":["chr"],"align":["left"]},{"label":["matiere"],"name":[2],"type":["chr"],"align":["left"]},{"label":["note"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Alain","2":"Français","3":"9"},{"1":"Alain","2":"Maths","3":"16"},{"1":"Barnabé","2":"Français","3":"NA"},{"1":"Barnabé","2":"Maths","3":"17"},{"1":"Chantal","2":"Français","3":"11"},{"1":"Chantal","2":"Maths","3":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>On voit que les combinaisons manquante “Barnabé - Français” et “Chantal - Maths” ont bien été ajoutées par <code data-pkg="tidyr">complete</code>.</p>
<p>Par défaut les lignes insérées récupèrent des valeurs manquantes <code>NA</code> pour les colonnes restantes. On peut néanmoins choisir une autre valeur avec l’argument <code>fill</code>, qui prend la forme d’une liste nommée :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">complete</span>(eleve, matiere, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">note =</span> <span class="dv">0</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["eleve"],"name":[1],"type":["chr"],"align":["left"]},{"label":["matiere"],"name":[2],"type":["chr"],"align":["left"]},{"label":["note"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Alain","2":"Français","3":"9"},{"1":"Alain","2":"Maths","3":"16"},{"1":"Barnabé","2":"Français","3":"0"},{"1":"Barnabé","2":"Maths","3":"17"},{"1":"Chantal","2":"Français","3":"11"},{"1":"Chantal","2":"Maths","3":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Parfois on ne souhaite pas inclure toutes les colonnes dans le calcul des combinaisons de valeurs. Par exemple, supposons qu’on rajoute dans notre tableau une colonne avec les identifiants de chaque élève :</p>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="left">eleve</th>
<th align="left">matiere</th>
<th align="right">note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1001001</td>
<td align="left">Alain</td>
<td align="left">Maths</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="right">1001001</td>
<td align="left">Alain</td>
<td align="left">Français</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">1001002</td>
<td align="left">Barnabé</td>
<td align="left">Maths</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="right">1001003</td>
<td align="left">Chantal</td>
<td align="left">Français</td>
<td align="right">11</td>
</tr>
</tbody>
</table>
<p>Si on applique <code data-pkg="tidyr">complete</code> comme précédemment, le résultat n’est pas bon car il contient toutes les combinaisons de <code>id</code>, <code>eleve</code> et <code>matiere</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">complete</span>(id, eleve, matiere)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["eleve"],"name":[2],"type":["chr"],"align":["left"]},{"label":["matiere"],"name":[3],"type":["chr"],"align":["left"]},{"label":["note"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1001001","2":"Alain","3":"Français","4":"9"},{"1":"1001001","2":"Alain","3":"Maths","4":"16"},{"1":"1001001","2":"Barnabé","3":"Français","4":"NA"},{"1":"1001001","2":"Barnabé","3":"Maths","4":"NA"},{"1":"1001001","2":"Chantal","3":"Français","4":"NA"},{"1":"1001001","2":"Chantal","3":"Maths","4":"NA"},{"1":"1001002","2":"Alain","3":"Français","4":"NA"},{"1":"1001002","2":"Alain","3":"Maths","4":"NA"},{"1":"1001002","2":"Barnabé","3":"Français","4":"NA"},{"1":"1001002","2":"Barnabé","3":"Maths","4":"17"},{"1":"1001002","2":"Chantal","3":"Français","4":"NA"},{"1":"1001002","2":"Chantal","3":"Maths","4":"NA"},{"1":"1001003","2":"Alain","3":"Français","4":"NA"},{"1":"1001003","2":"Alain","3":"Maths","4":"NA"},{"1":"1001003","2":"Barnabé","3":"Français","4":"NA"},{"1":"1001003","2":"Barnabé","3":"Maths","4":"NA"},{"1":"1001003","2":"Chantal","3":"Français","4":"11"},{"1":"1001003","2":"Chantal","3":"Maths","4":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Dans ce cas, pour signifier à <code data-pkg="tidyr">complete</code> que <code>id</code> et <code>eleve</code> sont deux attributs d’un même individu et ne doivent pas être combinés entre eux, on doit les placer dans une fonction <code data-pkg="tidyr" data-rdoc="expand">nesting</code> :</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">complete</span>(<span class="fu">nesting</span>(id, eleve), matiere)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["eleve"],"name":[2],"type":["chr"],"align":["left"]},{"label":["matiere"],"name":[3],"type":["chr"],"align":["left"]},{"label":["note"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1001001","2":"Alain","3":"Français","4":"9"},{"1":"1001001","2":"Alain","3":"Maths","4":"16"},{"1":"1001002","2":"Barnabé","3":"Français","4":"NA"},{"1":"1001002","2":"Barnabé","3":"Maths","4":"17"},{"1":"1001003","2":"Chantal","3":"Français","4":"11"},{"1":"1001003","2":"Chantal","3":"Maths","4":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="ressources" class="section level2 hasAnchor">
<h2 class="hasAnchor">Ressources<a href="#ressources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chaque jeu de données est différent, et le travail de remise en forme est souvent long et plus ou moins compliqué. On n’a donné ici que les exemples les plus simples, et c’est souvent en combinant différentes opérations qu’on finit par obtenir le résultat souhaité.</p>
<p>Le livre <em>R for data science</em>, librement accessible en ligne, contient <a href="http://r4ds.had.co.nz/tidy-data.html">un chapitre complet</a> sur la remise en forme des données.</p>
<p>L’article <a href="https://www.jstatsoft.org/article/view/v059i10">Tidy data</a>, publié en 2014 dans le <em>Journal of Statistical Software</em>, présente de manière détaillée le concept éponyme (mais il utilise des extensions désormais obsolètes qui ont depuis été remplacées par <code class="pkg">dplyr</code> et<code class="pkg">tidyr</code>).</p>
<p>Le site de l’extension est accessible à l’adresse : <a href="http://tidyr.tidyverse.org/" class="uri">http://tidyr.tidyverse.org/</a> et contient une liste des fonctions et les pages d’aide associées.</p>
<p>En particulier, on pourra se référer à la <a href="https://tidyr.tidyverse.org/articles/pivot.html">vignette dédiée</a> à <code data-pkg="tidyr">pivot_wider</code> et <code data-pkg="tidyr">pivot_longer</code> pour des exemples avancés de réorganisation des données.</p>
<p>Pour des usages avancés, il est possible avec <code class="pkg">tidyr</code> de gérer des données nichées (<em lang="en">nested data</em>), c’est-à-dire des tableaux de données dans des tableaux de données. Ces fonctionnalités, réservées aux utilisateurs avancés, sont décrites dans une <a href="https://tidyr.tidyverse.org/articles/nest.html">vignette spécifique</a>.</p>
</div>
<div id="fichiers-volumineux" class="section level2 hasAnchor">
<h2 class="hasAnchor">Fichiers volumineux<a href="#fichiers-volumineux" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Si l’on a des tableaux de données particulièrement volumineux (plusieurs Go), les fonctions de <code class="pkg">tidyr</code> ne sont pas forcéments les plus performantes.</p>
<p>On aura alors intérêt à regarder du côté des fonctions <code data-pkg="data.table" data-rdoc="melt.data.table">melt</code> et <code data-pkg="data.table" data-doc="dcast.data.table">dcast</code> de l’extension <code class="pkg">data.table</code> développées pour optimiser la performance sur les grands tableaux de données.</p>
<p>Pour plus de détails, voir la vignette dédiée : <a href="https://rdatatable.gitlab.io/data.table/articles/datatable-reshape.html" class="uri">https://rdatatable.gitlab.io/data.table/articles/datatable-reshape.html</a></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p><code data-pkg="tidyr">pivot_longer</code> est une version plus récente et plus robuste de la fonction <code data-pkg="tidyr">gather</code>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><code data-pkg="tidyr">pivot_wider</code> est une version plus récente et plus robuste de la fonction <code data-pkg="tidyr">spread</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copié !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
-->

<!-- Giscus comments -->
<script src="https://giscus.app/client.js"
        data-repo="larmarange/analyse-R"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzNDk4NjY2Ng=="
        data-category-id="DIC_kwDOAhXaqs4B_iH_"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="light"
        data-lang="fr"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->



</body>
</html>
